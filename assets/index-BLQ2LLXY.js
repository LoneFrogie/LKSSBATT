(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function IS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ry={exports:{}},Hf={},ny={exports:{}},Le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ru=Symbol.for("react.element"),CS=Symbol.for("react.portal"),RS=Symbol.for("react.fragment"),kS=Symbol.for("react.strict_mode"),PS=Symbol.for("react.profiler"),NS=Symbol.for("react.provider"),OS=Symbol.for("react.context"),DS=Symbol.for("react.forward_ref"),FS=Symbol.for("react.suspense"),LS=Symbol.for("react.memo"),MS=Symbol.for("react.lazy"),Gg=Symbol.iterator;function VS(t){return t===null||typeof t!="object"?null:(t=Gg&&t[Gg]||t["@@iterator"],typeof t=="function"?t:null)}var iy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sy=Object.assign,ay={};function uo(t,e,r){this.props=t,this.context=e,this.refs=ay,this.updater=r||iy}uo.prototype.isReactComponent={};uo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};uo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function oy(){}oy.prototype=uo.prototype;function op(t,e,r){this.props=t,this.context=e,this.refs=ay,this.updater=r||iy}var lp=op.prototype=new oy;lp.constructor=op;sy(lp,uo.prototype);lp.isPureReactComponent=!0;var Kg=Array.isArray,ly=Object.prototype.hasOwnProperty,up={current:null},uy={key:!0,ref:!0,__self:!0,__source:!0};function cy(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)ly.call(e,n)&&!uy.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:ru,type:t,key:s,ref:a,props:i,_owner:up.current}}function BS(t,e){return{$$typeof:ru,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function cp(t){return typeof t=="object"&&t!==null&&t.$$typeof===ru}function US(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var qg=/\/+/g;function Wh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?US(""+t.key):e.toString(36)}function Ec(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case ru:case CS:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+Wh(a,0):n,Kg(i)?(r="",t!=null&&(r=t.replace(qg,"$&/")+"/"),Ec(i,e,r,"",function(c){return c})):i!=null&&(cp(i)&&(i=BS(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(qg,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",Kg(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+Wh(s,o);a+=Ec(s,e,r,l,i)}else if(l=VS(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+Wh(s,o++),a+=Ec(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function $u(t,e,r){if(t==null)return t;var n=[],i=0;return Ec(t,n,"","",function(s){return e.call(r,s,i++)}),n}function bS(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var wr={current:null},Tc={transition:null},jS={ReactCurrentDispatcher:wr,ReactCurrentBatchConfig:Tc,ReactCurrentOwner:up};function fy(){throw Error("act(...) is not supported in production builds of React.")}Le.Children={map:$u,forEach:function(t,e,r){$u(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return $u(t,function(){e++}),e},toArray:function(t){return $u(t,function(e){return e})||[]},only:function(t){if(!cp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Le.Component=uo;Le.Fragment=RS;Le.Profiler=PS;Le.PureComponent=op;Le.StrictMode=kS;Le.Suspense=FS;Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jS;Le.act=fy;Le.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=sy({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=up.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)ly.call(e,l)&&!uy.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:ru,type:t.type,key:i,ref:s,props:n,_owner:a}};Le.createContext=function(t){return t={$$typeof:OS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:NS,_context:t},t.Consumer=t};Le.createElement=cy;Le.createFactory=function(t){var e=cy.bind(null,t);return e.type=t,e};Le.createRef=function(){return{current:null}};Le.forwardRef=function(t){return{$$typeof:DS,render:t}};Le.isValidElement=cp;Le.lazy=function(t){return{$$typeof:MS,_payload:{_status:-1,_result:t},_init:bS}};Le.memo=function(t,e){return{$$typeof:LS,type:t,compare:e===void 0?null:e}};Le.startTransition=function(t){var e=Tc.transition;Tc.transition={};try{t()}finally{Tc.transition=e}};Le.unstable_act=fy;Le.useCallback=function(t,e){return wr.current.useCallback(t,e)};Le.useContext=function(t){return wr.current.useContext(t)};Le.useDebugValue=function(){};Le.useDeferredValue=function(t){return wr.current.useDeferredValue(t)};Le.useEffect=function(t,e){return wr.current.useEffect(t,e)};Le.useId=function(){return wr.current.useId()};Le.useImperativeHandle=function(t,e,r){return wr.current.useImperativeHandle(t,e,r)};Le.useInsertionEffect=function(t,e){return wr.current.useInsertionEffect(t,e)};Le.useLayoutEffect=function(t,e){return wr.current.useLayoutEffect(t,e)};Le.useMemo=function(t,e){return wr.current.useMemo(t,e)};Le.useReducer=function(t,e,r){return wr.current.useReducer(t,e,r)};Le.useRef=function(t){return wr.current.useRef(t)};Le.useState=function(t){return wr.current.useState(t)};Le.useSyncExternalStore=function(t,e,r){return wr.current.useSyncExternalStore(t,e,r)};Le.useTransition=function(){return wr.current.useTransition()};Le.version="18.3.1";ny.exports=Le;var Bt=ny.exports;const zS=IS(Bt);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WS=Bt,HS=Symbol.for("react.element"),$S=Symbol.for("react.fragment"),GS=Object.prototype.hasOwnProperty,KS=WS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qS={key:!0,ref:!0,__self:!0,__source:!0};function hy(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)GS.call(e,n)&&!qS.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:HS,type:t,key:s,ref:a,props:i,_owner:KS.current}}Hf.Fragment=$S;Hf.jsx=hy;Hf.jsxs=hy;ry.exports=Hf;var se=ry.exports,L0={},dy={exports:{}},Xr={},py={exports:{}},my={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ue,ye){var we=ue.length;ue.push(ye);e:for(;0<we;){var De=we-1>>>1,B=ue[De];if(0<i(B,ye))ue[De]=ye,ue[we]=B,we=De;else break e}}function r(ue){return ue.length===0?null:ue[0]}function n(ue){if(ue.length===0)return null;var ye=ue[0],we=ue.pop();if(we!==ye){ue[0]=we;e:for(var De=0,B=ue.length,W=B>>>1;De<W;){var j=2*(De+1)-1,U=ue[j],Z=j+1,me=ue[Z];if(0>i(U,we))Z<B&&0>i(me,U)?(ue[De]=me,ue[Z]=we,De=Z):(ue[De]=U,ue[j]=we,De=j);else if(Z<B&&0>i(me,we))ue[De]=me,ue[Z]=we,De=Z;else break e}}return ye}function i(ue,ye){var we=ue.sortIndex-ye.sortIndex;return we!==0?we:ue.id-ye.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],f=1,h=null,d=3,m=!1,_=!1,g=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(ue){for(var ye=r(c);ye!==null;){if(ye.callback===null)n(c);else if(ye.startTime<=ue)n(c),ye.sortIndex=ye.expirationTime,e(l,ye);else break;ye=r(c)}}function V(ue){if(g=!1,I(ue),!_)if(r(l)!==null)_=!0,ht(b);else{var ye=r(c);ye!==null&&$e(V,ye.startTime-ue)}}function b(ue,ye){_=!1,g&&(g=!1,S(y),y=-1),m=!0;var we=d;try{for(I(ye),h=r(l);h!==null&&(!(h.expirationTime>ye)||ue&&!N());){var De=h.callback;if(typeof De=="function"){h.callback=null,d=h.priorityLevel;var B=De(h.expirationTime<=ye);ye=t.unstable_now(),typeof B=="function"?h.callback=B:h===r(l)&&n(l),I(ye)}else n(l);h=r(l)}if(h!==null)var W=!0;else{var j=r(c);j!==null&&$e(V,j.startTime-ye),W=!1}return W}finally{h=null,d=we,m=!1}}var H=!1,E=null,y=-1,T=5,C=-1;function N(){return!(t.unstable_now()-C<T)}function L(){if(E!==null){var ue=t.unstable_now();C=ue;var ye=!0;try{ye=E(!0,ue)}finally{ye?P():(H=!1,E=null)}}else H=!1}var P;if(typeof x=="function")P=function(){x(L)};else if(typeof MessageChannel<"u"){var Ie=new MessageChannel,Ae=Ie.port2;Ie.port1.onmessage=L,P=function(){Ae.postMessage(null)}}else P=function(){w(L,0)};function ht(ue){E=ue,H||(H=!0,P())}function $e(ue,ye){y=w(function(){ue(t.unstable_now())},ye)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ue){ue.callback=null},t.unstable_continueExecution=function(){_||m||(_=!0,ht(b))},t.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<ue?Math.floor(1e3/ue):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(ue){switch(d){case 1:case 2:case 3:var ye=3;break;default:ye=d}var we=d;d=ye;try{return ue()}finally{d=we}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ue,ye){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var we=d;d=ue;try{return ye()}finally{d=we}},t.unstable_scheduleCallback=function(ue,ye,we){var De=t.unstable_now();switch(typeof we=="object"&&we!==null?(we=we.delay,we=typeof we=="number"&&0<we?De+we:De):we=De,ue){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=we+B,ue={id:f++,callback:ye,priorityLevel:ue,startTime:we,expirationTime:B,sortIndex:-1},we>De?(ue.sortIndex=we,e(c,ue),r(l)===null&&ue===r(c)&&(g?(S(y),y=-1):g=!0,$e(V,we-De))):(ue.sortIndex=B,e(l,ue),_||m||(_=!0,ht(b))),ue},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(ue){var ye=d;return function(){var we=d;d=ye;try{return ue.apply(this,arguments)}finally{d=we}}}})(my);py.exports=my;var XS=py.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QS=Bt,Kr=XS;function ie(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var gy=new Set,wl={};function Xs(t,e){Ga(t,e),Ga(t+"Capture",e)}function Ga(t,e){for(wl[t]=e,t=0;t<e.length;t++)gy.add(e[t])}var li=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),M0=Object.prototype.hasOwnProperty,YS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Xg={},Qg={};function JS(t){return M0.call(Qg,t)?!0:M0.call(Xg,t)?!1:YS.test(t)?Qg[t]=!0:(Xg[t]=!0,!1)}function ZS(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function eA(t,e,r,n){if(e===null||typeof e>"u"||ZS(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Sr(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var tr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){tr[t]=new Sr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];tr[e]=new Sr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){tr[t]=new Sr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){tr[t]=new Sr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){tr[t]=new Sr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){tr[t]=new Sr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){tr[t]=new Sr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){tr[t]=new Sr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){tr[t]=new Sr(t,5,!1,t.toLowerCase(),null,!1,!1)});var fp=/[\-:]([a-z])/g;function hp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(fp,hp);tr[e]=new Sr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(fp,hp);tr[e]=new Sr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(fp,hp);tr[e]=new Sr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){tr[t]=new Sr(t,1,!1,t.toLowerCase(),null,!1,!1)});tr.xlinkHref=new Sr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){tr[t]=new Sr(t,1,!1,t.toLowerCase(),null,!0,!0)});function dp(t,e,r,n){var i=tr.hasOwnProperty(e)?tr[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(eA(e,r,i,n)&&(r=null),n||i===null?JS(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var yi=QS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Gu=Symbol.for("react.element"),ya=Symbol.for("react.portal"),xa=Symbol.for("react.fragment"),pp=Symbol.for("react.strict_mode"),V0=Symbol.for("react.profiler"),vy=Symbol.for("react.provider"),_y=Symbol.for("react.context"),mp=Symbol.for("react.forward_ref"),B0=Symbol.for("react.suspense"),U0=Symbol.for("react.suspense_list"),gp=Symbol.for("react.memo"),Pi=Symbol.for("react.lazy"),yy=Symbol.for("react.offscreen"),Yg=Symbol.iterator;function Mo(t){return t===null||typeof t!="object"?null:(t=Yg&&t[Yg]||t["@@iterator"],typeof t=="function"?t:null)}var mt=Object.assign,Hh;function Go(t){if(Hh===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Hh=e&&e[1]||""}return`
`+Hh+t}var $h=!1;function Gh(t,e){if(!t||$h)return"";$h=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{$h=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Go(t):""}function tA(t){switch(t.tag){case 5:return Go(t.type);case 16:return Go("Lazy");case 13:return Go("Suspense");case 19:return Go("SuspenseList");case 0:case 2:case 15:return t=Gh(t.type,!1),t;case 11:return t=Gh(t.type.render,!1),t;case 1:return t=Gh(t.type,!0),t;default:return""}}function b0(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case xa:return"Fragment";case ya:return"Portal";case V0:return"Profiler";case pp:return"StrictMode";case B0:return"Suspense";case U0:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case _y:return(t.displayName||"Context")+".Consumer";case vy:return(t._context.displayName||"Context")+".Provider";case mp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case gp:return e=t.displayName||null,e!==null?e:b0(t.type)||"Memo";case Pi:e=t._payload,t=t._init;try{return b0(t(e))}catch{}}return null}function rA(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return b0(e);case 8:return e===pp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function es(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function xy(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function nA(t){var e=xy(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ku(t){t._valueTracker||(t._valueTracker=nA(t))}function Ey(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=xy(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function zc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function j0(t,e){var r=e.checked;return mt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Jg(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=es(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Ty(t,e){e=e.checked,e!=null&&dp(t,"checked",e,!1)}function z0(t,e){Ty(t,e);var r=es(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?W0(t,e.type,r):e.hasOwnProperty("defaultValue")&&W0(t,e.type,es(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Zg(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function W0(t,e,r){(e!=="number"||zc(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Ko=Array.isArray;function Oa(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+es(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function H0(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ie(91));return mt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function e1(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(ie(92));if(Ko(r)){if(1<r.length)throw Error(ie(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:es(r)}}function wy(t,e){var r=es(e.value),n=es(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function t1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Sy(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $0(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Sy(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var qu,Ay=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(qu=qu||document.createElement("div"),qu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=qu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Sl(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var rl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},iA=["Webkit","ms","Moz","O"];Object.keys(rl).forEach(function(t){iA.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),rl[e]=rl[t]})});function Iy(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||rl.hasOwnProperty(t)&&rl[t]?(""+e).trim():e+"px"}function Cy(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Iy(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var sA=mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function G0(t,e){if(e){if(sA[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ie(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ie(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ie(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ie(62))}}function K0(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var q0=null;function vp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var X0=null,Da=null,Fa=null;function r1(t){if(t=su(t)){if(typeof X0!="function")throw Error(ie(280));var e=t.stateNode;e&&(e=Xf(e),X0(t.stateNode,t.type,e))}}function Ry(t){Da?Fa?Fa.push(t):Fa=[t]:Da=t}function ky(){if(Da){var t=Da,e=Fa;if(Fa=Da=null,r1(t),e)for(t=0;t<e.length;t++)r1(e[t])}}function Py(t,e){return t(e)}function Ny(){}var Kh=!1;function Oy(t,e,r){if(Kh)return t(e,r);Kh=!0;try{return Py(t,e,r)}finally{Kh=!1,(Da!==null||Fa!==null)&&(Ny(),ky())}}function Al(t,e){var r=t.stateNode;if(r===null)return null;var n=Xf(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(ie(231,e,typeof r));return r}var Q0=!1;if(li)try{var Vo={};Object.defineProperty(Vo,"passive",{get:function(){Q0=!0}}),window.addEventListener("test",Vo,Vo),window.removeEventListener("test",Vo,Vo)}catch{Q0=!1}function aA(t,e,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(f){this.onError(f)}}var nl=!1,Wc=null,Hc=!1,Y0=null,oA={onError:function(t){nl=!0,Wc=t}};function lA(t,e,r,n,i,s,a,o,l){nl=!1,Wc=null,aA.apply(oA,arguments)}function uA(t,e,r,n,i,s,a,o,l){if(lA.apply(this,arguments),nl){if(nl){var c=Wc;nl=!1,Wc=null}else throw Error(ie(198));Hc||(Hc=!0,Y0=c)}}function Qs(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Dy(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function n1(t){if(Qs(t)!==t)throw Error(ie(188))}function cA(t){var e=t.alternate;if(!e){if(e=Qs(t),e===null)throw Error(ie(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return n1(i),t;if(s===n)return n1(i),e;s=s.sibling}throw Error(ie(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(ie(189))}}if(r.alternate!==n)throw Error(ie(190))}if(r.tag!==3)throw Error(ie(188));return r.stateNode.current===r?t:e}function Fy(t){return t=cA(t),t!==null?Ly(t):null}function Ly(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Ly(t);if(e!==null)return e;t=t.sibling}return null}var My=Kr.unstable_scheduleCallback,i1=Kr.unstable_cancelCallback,fA=Kr.unstable_shouldYield,hA=Kr.unstable_requestPaint,Tt=Kr.unstable_now,dA=Kr.unstable_getCurrentPriorityLevel,_p=Kr.unstable_ImmediatePriority,Vy=Kr.unstable_UserBlockingPriority,$c=Kr.unstable_NormalPriority,pA=Kr.unstable_LowPriority,By=Kr.unstable_IdlePriority,$f=null,On=null;function mA(t){if(On&&typeof On.onCommitFiberRoot=="function")try{On.onCommitFiberRoot($f,t,void 0,(t.current.flags&128)===128)}catch{}}var yn=Math.clz32?Math.clz32:_A,gA=Math.log,vA=Math.LN2;function _A(t){return t>>>=0,t===0?32:31-(gA(t)/vA|0)|0}var Xu=64,Qu=4194304;function qo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Gc(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=qo(o):(s&=a,s!==0&&(n=qo(s)))}else a=r&~i,a!==0?n=qo(a):s!==0&&(n=qo(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-yn(e),i=1<<r,n|=t[r],e&=~i;return n}function yA(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xA(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-yn(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=yA(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function J0(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Uy(){var t=Xu;return Xu<<=1,!(Xu&4194240)&&(Xu=64),t}function qh(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function nu(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-yn(e),t[e]=r}function EA(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-yn(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function yp(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-yn(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Ye=0;function by(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var jy,xp,zy,Wy,Hy,Z0=!1,Yu=[],zi=null,Wi=null,Hi=null,Il=new Map,Cl=new Map,Oi=[],TA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function s1(t,e){switch(t){case"focusin":case"focusout":zi=null;break;case"dragenter":case"dragleave":Wi=null;break;case"mouseover":case"mouseout":Hi=null;break;case"pointerover":case"pointerout":Il.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cl.delete(e.pointerId)}}function Bo(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=su(e),e!==null&&xp(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function wA(t,e,r,n,i){switch(e){case"focusin":return zi=Bo(zi,t,e,r,n,i),!0;case"dragenter":return Wi=Bo(Wi,t,e,r,n,i),!0;case"mouseover":return Hi=Bo(Hi,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Il.set(s,Bo(Il.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Cl.set(s,Bo(Cl.get(s)||null,t,e,r,n,i)),!0}return!1}function $y(t){var e=As(t.target);if(e!==null){var r=Qs(e);if(r!==null){if(e=r.tag,e===13){if(e=Dy(r),e!==null){t.blockedOn=e,Hy(t.priority,function(){zy(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function wc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=ed(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);q0=n,r.target.dispatchEvent(n),q0=null}else return e=su(r),e!==null&&xp(e),t.blockedOn=r,!1;e.shift()}return!0}function a1(t,e,r){wc(t)&&r.delete(e)}function SA(){Z0=!1,zi!==null&&wc(zi)&&(zi=null),Wi!==null&&wc(Wi)&&(Wi=null),Hi!==null&&wc(Hi)&&(Hi=null),Il.forEach(a1),Cl.forEach(a1)}function Uo(t,e){t.blockedOn===e&&(t.blockedOn=null,Z0||(Z0=!0,Kr.unstable_scheduleCallback(Kr.unstable_NormalPriority,SA)))}function Rl(t){function e(i){return Uo(i,t)}if(0<Yu.length){Uo(Yu[0],t);for(var r=1;r<Yu.length;r++){var n=Yu[r];n.blockedOn===t&&(n.blockedOn=null)}}for(zi!==null&&Uo(zi,t),Wi!==null&&Uo(Wi,t),Hi!==null&&Uo(Hi,t),Il.forEach(e),Cl.forEach(e),r=0;r<Oi.length;r++)n=Oi[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Oi.length&&(r=Oi[0],r.blockedOn===null);)$y(r),r.blockedOn===null&&Oi.shift()}var La=yi.ReactCurrentBatchConfig,Kc=!0;function AA(t,e,r,n){var i=Ye,s=La.transition;La.transition=null;try{Ye=1,Ep(t,e,r,n)}finally{Ye=i,La.transition=s}}function IA(t,e,r,n){var i=Ye,s=La.transition;La.transition=null;try{Ye=4,Ep(t,e,r,n)}finally{Ye=i,La.transition=s}}function Ep(t,e,r,n){if(Kc){var i=ed(t,e,r,n);if(i===null)i0(t,e,n,qc,r),s1(t,n);else if(wA(i,t,e,r,n))n.stopPropagation();else if(s1(t,n),e&4&&-1<TA.indexOf(t)){for(;i!==null;){var s=su(i);if(s!==null&&jy(s),s=ed(t,e,r,n),s===null&&i0(t,e,n,qc,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else i0(t,e,n,null,r)}}var qc=null;function ed(t,e,r,n){if(qc=null,t=vp(n),t=As(t),t!==null)if(e=Qs(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Dy(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return qc=t,null}function Gy(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dA()){case _p:return 1;case Vy:return 4;case $c:case pA:return 16;case By:return 536870912;default:return 16}default:return 16}}var Vi=null,Tp=null,Sc=null;function Ky(){if(Sc)return Sc;var t,e=Tp,r=e.length,n,i="value"in Vi?Vi.value:Vi.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return Sc=i.slice(t,1<n?1-n:void 0)}function Ac(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ju(){return!0}function o1(){return!1}function Qr(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ju:o1,this.isPropagationStopped=o1,this}return mt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ju)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ju)},persist:function(){},isPersistent:Ju}),e}var co={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wp=Qr(co),iu=mt({},co,{view:0,detail:0}),CA=Qr(iu),Xh,Qh,bo,Gf=mt({},iu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==bo&&(bo&&t.type==="mousemove"?(Xh=t.screenX-bo.screenX,Qh=t.screenY-bo.screenY):Qh=Xh=0,bo=t),Xh)},movementY:function(t){return"movementY"in t?t.movementY:Qh}}),l1=Qr(Gf),RA=mt({},Gf,{dataTransfer:0}),kA=Qr(RA),PA=mt({},iu,{relatedTarget:0}),Yh=Qr(PA),NA=mt({},co,{animationName:0,elapsedTime:0,pseudoElement:0}),OA=Qr(NA),DA=mt({},co,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),FA=Qr(DA),LA=mt({},co,{data:0}),u1=Qr(LA),MA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},VA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},BA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function UA(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=BA[t])?!!e[t]:!1}function Sp(){return UA}var bA=mt({},iu,{key:function(t){if(t.key){var e=MA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ac(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?VA[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sp,charCode:function(t){return t.type==="keypress"?Ac(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ac(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),jA=Qr(bA),zA=mt({},Gf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),c1=Qr(zA),WA=mt({},iu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sp}),HA=Qr(WA),$A=mt({},co,{propertyName:0,elapsedTime:0,pseudoElement:0}),GA=Qr($A),KA=mt({},Gf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),qA=Qr(KA),XA=[9,13,27,32],Ap=li&&"CompositionEvent"in window,il=null;li&&"documentMode"in document&&(il=document.documentMode);var QA=li&&"TextEvent"in window&&!il,qy=li&&(!Ap||il&&8<il&&11>=il),f1=" ",h1=!1;function Xy(t,e){switch(t){case"keyup":return XA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qy(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ea=!1;function YA(t,e){switch(t){case"compositionend":return Qy(e);case"keypress":return e.which!==32?null:(h1=!0,f1);case"textInput":return t=e.data,t===f1&&h1?null:t;default:return null}}function JA(t,e){if(Ea)return t==="compositionend"||!Ap&&Xy(t,e)?(t=Ky(),Sc=Tp=Vi=null,Ea=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return qy&&e.locale!=="ko"?null:e.data;default:return null}}var ZA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function d1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!ZA[t.type]:e==="textarea"}function Yy(t,e,r,n){Ry(n),e=Xc(e,"onChange"),0<e.length&&(r=new wp("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var sl=null,kl=null;function eI(t){lx(t,0)}function Kf(t){var e=Sa(t);if(Ey(e))return t}function tI(t,e){if(t==="change")return e}var Jy=!1;if(li){var Jh;if(li){var Zh="oninput"in document;if(!Zh){var p1=document.createElement("div");p1.setAttribute("oninput","return;"),Zh=typeof p1.oninput=="function"}Jh=Zh}else Jh=!1;Jy=Jh&&(!document.documentMode||9<document.documentMode)}function m1(){sl&&(sl.detachEvent("onpropertychange",Zy),kl=sl=null)}function Zy(t){if(t.propertyName==="value"&&Kf(kl)){var e=[];Yy(e,kl,t,vp(t)),Oy(eI,e)}}function rI(t,e,r){t==="focusin"?(m1(),sl=e,kl=r,sl.attachEvent("onpropertychange",Zy)):t==="focusout"&&m1()}function nI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Kf(kl)}function iI(t,e){if(t==="click")return Kf(e)}function sI(t,e){if(t==="input"||t==="change")return Kf(e)}function aI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var wn=typeof Object.is=="function"?Object.is:aI;function Pl(t,e){if(wn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!M0.call(e,i)||!wn(t[i],e[i]))return!1}return!0}function g1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function v1(t,e){var r=g1(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=g1(r)}}function ex(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?ex(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function tx(){for(var t=window,e=zc();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=zc(t.document)}return e}function Ip(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function oI(t){var e=tx(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&ex(r.ownerDocument.documentElement,r)){if(n!==null&&Ip(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=v1(r,s);var a=v1(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var lI=li&&"documentMode"in document&&11>=document.documentMode,Ta=null,td=null,al=null,rd=!1;function _1(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;rd||Ta==null||Ta!==zc(n)||(n=Ta,"selectionStart"in n&&Ip(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),al&&Pl(al,n)||(al=n,n=Xc(td,"onSelect"),0<n.length&&(e=new wp("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Ta)))}function Zu(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var wa={animationend:Zu("Animation","AnimationEnd"),animationiteration:Zu("Animation","AnimationIteration"),animationstart:Zu("Animation","AnimationStart"),transitionend:Zu("Transition","TransitionEnd")},e0={},rx={};li&&(rx=document.createElement("div").style,"AnimationEvent"in window||(delete wa.animationend.animation,delete wa.animationiteration.animation,delete wa.animationstart.animation),"TransitionEvent"in window||delete wa.transitionend.transition);function qf(t){if(e0[t])return e0[t];if(!wa[t])return t;var e=wa[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in rx)return e0[t]=e[r];return t}var nx=qf("animationend"),ix=qf("animationiteration"),sx=qf("animationstart"),ax=qf("transitionend"),ox=new Map,y1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ls(t,e){ox.set(t,e),Xs(e,[t])}for(var t0=0;t0<y1.length;t0++){var r0=y1[t0],uI=r0.toLowerCase(),cI=r0[0].toUpperCase()+r0.slice(1);ls(uI,"on"+cI)}ls(nx,"onAnimationEnd");ls(ix,"onAnimationIteration");ls(sx,"onAnimationStart");ls("dblclick","onDoubleClick");ls("focusin","onFocus");ls("focusout","onBlur");ls(ax,"onTransitionEnd");Ga("onMouseEnter",["mouseout","mouseover"]);Ga("onMouseLeave",["mouseout","mouseover"]);Ga("onPointerEnter",["pointerout","pointerover"]);Ga("onPointerLeave",["pointerout","pointerover"]);Xs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Xs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Xs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Xs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Xs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Xs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fI=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xo));function x1(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,uA(n,e,void 0,t),t.currentTarget=null}function lx(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;x1(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;x1(i,o,c),s=l}}}if(Hc)throw t=Y0,Hc=!1,Y0=null,t}function at(t,e){var r=e[od];r===void 0&&(r=e[od]=new Set);var n=t+"__bubble";r.has(n)||(ux(e,t,2,!1),r.add(n))}function n0(t,e,r){var n=0;e&&(n|=4),ux(r,t,n,e)}var ec="_reactListening"+Math.random().toString(36).slice(2);function Nl(t){if(!t[ec]){t[ec]=!0,gy.forEach(function(r){r!=="selectionchange"&&(fI.has(r)||n0(r,!1,t),n0(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ec]||(e[ec]=!0,n0("selectionchange",!1,e))}}function ux(t,e,r,n){switch(Gy(e)){case 1:var i=AA;break;case 4:i=IA;break;default:i=Ep}r=i.bind(null,e,r,t),i=void 0,!Q0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function i0(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=As(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}Oy(function(){var c=s,f=vp(r),h=[];e:{var d=ox.get(t);if(d!==void 0){var m=wp,_=t;switch(t){case"keypress":if(Ac(r)===0)break e;case"keydown":case"keyup":m=jA;break;case"focusin":_="focus",m=Yh;break;case"focusout":_="blur",m=Yh;break;case"beforeblur":case"afterblur":m=Yh;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=l1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=kA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=HA;break;case nx:case ix:case sx:m=OA;break;case ax:m=GA;break;case"scroll":m=CA;break;case"wheel":m=qA;break;case"copy":case"cut":case"paste":m=FA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=c1}var g=(e&4)!==0,w=!g&&t==="scroll",S=g?d!==null?d+"Capture":null:d;g=[];for(var x=c,I;x!==null;){I=x;var V=I.stateNode;if(I.tag===5&&V!==null&&(I=V,S!==null&&(V=Al(x,S),V!=null&&g.push(Ol(x,V,I)))),w)break;x=x.return}0<g.length&&(d=new m(d,_,null,r,f),h.push({event:d,listeners:g}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",d&&r!==q0&&(_=r.relatedTarget||r.fromElement)&&(As(_)||_[ui]))break e;if((m||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,m?(_=r.relatedTarget||r.toElement,m=c,_=_?As(_):null,_!==null&&(w=Qs(_),_!==w||_.tag!==5&&_.tag!==6)&&(_=null)):(m=null,_=c),m!==_)){if(g=l1,V="onMouseLeave",S="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(g=c1,V="onPointerLeave",S="onPointerEnter",x="pointer"),w=m==null?d:Sa(m),I=_==null?d:Sa(_),d=new g(V,x+"leave",m,r,f),d.target=w,d.relatedTarget=I,V=null,As(f)===c&&(g=new g(S,x+"enter",_,r,f),g.target=I,g.relatedTarget=w,V=g),w=V,m&&_)t:{for(g=m,S=_,x=0,I=g;I;I=fa(I))x++;for(I=0,V=S;V;V=fa(V))I++;for(;0<x-I;)g=fa(g),x--;for(;0<I-x;)S=fa(S),I--;for(;x--;){if(g===S||S!==null&&g===S.alternate)break t;g=fa(g),S=fa(S)}g=null}else g=null;m!==null&&E1(h,d,m,g,!1),_!==null&&w!==null&&E1(h,w,_,g,!0)}}e:{if(d=c?Sa(c):window,m=d.nodeName&&d.nodeName.toLowerCase(),m==="select"||m==="input"&&d.type==="file")var b=tI;else if(d1(d))if(Jy)b=sI;else{b=nI;var H=rI}else(m=d.nodeName)&&m.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(b=iI);if(b&&(b=b(t,c))){Yy(h,b,r,f);break e}H&&H(t,d,c),t==="focusout"&&(H=d._wrapperState)&&H.controlled&&d.type==="number"&&W0(d,"number",d.value)}switch(H=c?Sa(c):window,t){case"focusin":(d1(H)||H.contentEditable==="true")&&(Ta=H,td=c,al=null);break;case"focusout":al=td=Ta=null;break;case"mousedown":rd=!0;break;case"contextmenu":case"mouseup":case"dragend":rd=!1,_1(h,r,f);break;case"selectionchange":if(lI)break;case"keydown":case"keyup":_1(h,r,f)}var E;if(Ap)e:{switch(t){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Ea?Xy(t,r)&&(y="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(y="onCompositionStart");y&&(qy&&r.locale!=="ko"&&(Ea||y!=="onCompositionStart"?y==="onCompositionEnd"&&Ea&&(E=Ky()):(Vi=f,Tp="value"in Vi?Vi.value:Vi.textContent,Ea=!0)),H=Xc(c,y),0<H.length&&(y=new u1(y,t,null,r,f),h.push({event:y,listeners:H}),E?y.data=E:(E=Qy(r),E!==null&&(y.data=E)))),(E=QA?YA(t,r):JA(t,r))&&(c=Xc(c,"onBeforeInput"),0<c.length&&(f=new u1("onBeforeInput","beforeinput",null,r,f),h.push({event:f,listeners:c}),f.data=E))}lx(h,e)})}function Ol(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Xc(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Al(t,r),s!=null&&n.unshift(Ol(t,s,i)),s=Al(t,e),s!=null&&n.push(Ol(t,s,i))),t=t.return}return n}function fa(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function E1(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=Al(r,s),l!=null&&a.unshift(Ol(r,l,o))):i||(l=Al(r,s),l!=null&&a.push(Ol(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var hI=/\r\n?/g,dI=/\u0000|\uFFFD/g;function T1(t){return(typeof t=="string"?t:""+t).replace(hI,`
`).replace(dI,"")}function tc(t,e,r){if(e=T1(e),T1(t)!==e&&r)throw Error(ie(425))}function Qc(){}var nd=null,id=null;function sd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ad=typeof setTimeout=="function"?setTimeout:void 0,pI=typeof clearTimeout=="function"?clearTimeout:void 0,w1=typeof Promise=="function"?Promise:void 0,mI=typeof queueMicrotask=="function"?queueMicrotask:typeof w1<"u"?function(t){return w1.resolve(null).then(t).catch(gI)}:ad;function gI(t){setTimeout(function(){throw t})}function s0(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Rl(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Rl(e)}function $i(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function S1(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var fo=Math.random().toString(36).slice(2),Nn="__reactFiber$"+fo,Dl="__reactProps$"+fo,ui="__reactContainer$"+fo,od="__reactEvents$"+fo,vI="__reactListeners$"+fo,_I="__reactHandles$"+fo;function As(t){var e=t[Nn];if(e)return e;for(var r=t.parentNode;r;){if(e=r[ui]||r[Nn]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=S1(t);t!==null;){if(r=t[Nn])return r;t=S1(t)}return e}t=r,r=t.parentNode}return null}function su(t){return t=t[Nn]||t[ui],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Sa(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ie(33))}function Xf(t){return t[Dl]||null}var ld=[],Aa=-1;function us(t){return{current:t}}function lt(t){0>Aa||(t.current=ld[Aa],ld[Aa]=null,Aa--)}function nt(t,e){Aa++,ld[Aa]=t.current,t.current=e}var ts={},mr=us(ts),Pr=us(!1),Ms=ts;function Ka(t,e){var r=t.type.contextTypes;if(!r)return ts;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Nr(t){return t=t.childContextTypes,t!=null}function Yc(){lt(Pr),lt(mr)}function A1(t,e,r){if(mr.current!==ts)throw Error(ie(168));nt(mr,e),nt(Pr,r)}function cx(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(ie(108,rA(t)||"Unknown",i));return mt({},r,n)}function Jc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ts,Ms=mr.current,nt(mr,t),nt(Pr,Pr.current),!0}function I1(t,e,r){var n=t.stateNode;if(!n)throw Error(ie(169));r?(t=cx(t,e,Ms),n.__reactInternalMemoizedMergedChildContext=t,lt(Pr),lt(mr),nt(mr,t)):lt(Pr),nt(Pr,r)}var qn=null,Qf=!1,a0=!1;function fx(t){qn===null?qn=[t]:qn.push(t)}function yI(t){Qf=!0,fx(t)}function cs(){if(!a0&&qn!==null){a0=!0;var t=0,e=Ye;try{var r=qn;for(Ye=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}qn=null,Qf=!1}catch(i){throw qn!==null&&(qn=qn.slice(t+1)),My(_p,cs),i}finally{Ye=e,a0=!1}}return null}var Ia=[],Ca=0,Zc=null,ef=0,tn=[],rn=0,Vs=null,Yn=1,Jn="";function Es(t,e){Ia[Ca++]=ef,Ia[Ca++]=Zc,Zc=t,ef=e}function hx(t,e,r){tn[rn++]=Yn,tn[rn++]=Jn,tn[rn++]=Vs,Vs=t;var n=Yn;t=Jn;var i=32-yn(n)-1;n&=~(1<<i),r+=1;var s=32-yn(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Yn=1<<32-yn(e)+i|r<<i|n,Jn=s+t}else Yn=1<<s|r<<i|n,Jn=t}function Cp(t){t.return!==null&&(Es(t,1),hx(t,1,0))}function Rp(t){for(;t===Zc;)Zc=Ia[--Ca],Ia[Ca]=null,ef=Ia[--Ca],Ia[Ca]=null;for(;t===Vs;)Vs=tn[--rn],tn[rn]=null,Jn=tn[--rn],tn[rn]=null,Yn=tn[--rn],tn[rn]=null}var Gr=null,Hr=null,ft=!1,gn=null;function dx(t,e){var r=nn(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function C1(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Gr=t,Hr=$i(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Gr=t,Hr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Vs!==null?{id:Yn,overflow:Jn}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=nn(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Gr=t,Hr=null,!0):!1;default:return!1}}function ud(t){return(t.mode&1)!==0&&(t.flags&128)===0}function cd(t){if(ft){var e=Hr;if(e){var r=e;if(!C1(t,e)){if(ud(t))throw Error(ie(418));e=$i(r.nextSibling);var n=Gr;e&&C1(t,e)?dx(n,r):(t.flags=t.flags&-4097|2,ft=!1,Gr=t)}}else{if(ud(t))throw Error(ie(418));t.flags=t.flags&-4097|2,ft=!1,Gr=t}}}function R1(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Gr=t}function rc(t){if(t!==Gr)return!1;if(!ft)return R1(t),ft=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!sd(t.type,t.memoizedProps)),e&&(e=Hr)){if(ud(t))throw px(),Error(ie(418));for(;e;)dx(t,e),e=$i(e.nextSibling)}if(R1(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ie(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Hr=$i(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Hr=null}}else Hr=Gr?$i(t.stateNode.nextSibling):null;return!0}function px(){for(var t=Hr;t;)t=$i(t.nextSibling)}function qa(){Hr=Gr=null,ft=!1}function kp(t){gn===null?gn=[t]:gn.push(t)}var xI=yi.ReactCurrentBatchConfig;function jo(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ie(309));var n=r.stateNode}if(!n)throw Error(ie(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(ie(284));if(!r._owner)throw Error(ie(290,t))}return t}function nc(t,e){throw t=Object.prototype.toString.call(e),Error(ie(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function k1(t){var e=t._init;return e(t._payload)}function mx(t){function e(S,x){if(t){var I=S.deletions;I===null?(S.deletions=[x],S.flags|=16):I.push(x)}}function r(S,x){if(!t)return null;for(;x!==null;)e(S,x),x=x.sibling;return null}function n(S,x){for(S=new Map;x!==null;)x.key!==null?S.set(x.key,x):S.set(x.index,x),x=x.sibling;return S}function i(S,x){return S=Xi(S,x),S.index=0,S.sibling=null,S}function s(S,x,I){return S.index=I,t?(I=S.alternate,I!==null?(I=I.index,I<x?(S.flags|=2,x):I):(S.flags|=2,x)):(S.flags|=1048576,x)}function a(S){return t&&S.alternate===null&&(S.flags|=2),S}function o(S,x,I,V){return x===null||x.tag!==6?(x=d0(I,S.mode,V),x.return=S,x):(x=i(x,I),x.return=S,x)}function l(S,x,I,V){var b=I.type;return b===xa?f(S,x,I.props.children,V,I.key):x!==null&&(x.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Pi&&k1(b)===x.type)?(V=i(x,I.props),V.ref=jo(S,x,I),V.return=S,V):(V=Oc(I.type,I.key,I.props,null,S.mode,V),V.ref=jo(S,x,I),V.return=S,V)}function c(S,x,I,V){return x===null||x.tag!==4||x.stateNode.containerInfo!==I.containerInfo||x.stateNode.implementation!==I.implementation?(x=p0(I,S.mode,V),x.return=S,x):(x=i(x,I.children||[]),x.return=S,x)}function f(S,x,I,V,b){return x===null||x.tag!==7?(x=Os(I,S.mode,V,b),x.return=S,x):(x=i(x,I),x.return=S,x)}function h(S,x,I){if(typeof x=="string"&&x!==""||typeof x=="number")return x=d0(""+x,S.mode,I),x.return=S,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Gu:return I=Oc(x.type,x.key,x.props,null,S.mode,I),I.ref=jo(S,null,x),I.return=S,I;case ya:return x=p0(x,S.mode,I),x.return=S,x;case Pi:var V=x._init;return h(S,V(x._payload),I)}if(Ko(x)||Mo(x))return x=Os(x,S.mode,I,null),x.return=S,x;nc(S,x)}return null}function d(S,x,I,V){var b=x!==null?x.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return b!==null?null:o(S,x,""+I,V);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Gu:return I.key===b?l(S,x,I,V):null;case ya:return I.key===b?c(S,x,I,V):null;case Pi:return b=I._init,d(S,x,b(I._payload),V)}if(Ko(I)||Mo(I))return b!==null?null:f(S,x,I,V,null);nc(S,I)}return null}function m(S,x,I,V,b){if(typeof V=="string"&&V!==""||typeof V=="number")return S=S.get(I)||null,o(x,S,""+V,b);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Gu:return S=S.get(V.key===null?I:V.key)||null,l(x,S,V,b);case ya:return S=S.get(V.key===null?I:V.key)||null,c(x,S,V,b);case Pi:var H=V._init;return m(S,x,I,H(V._payload),b)}if(Ko(V)||Mo(V))return S=S.get(I)||null,f(x,S,V,b,null);nc(x,V)}return null}function _(S,x,I,V){for(var b=null,H=null,E=x,y=x=0,T=null;E!==null&&y<I.length;y++){E.index>y?(T=E,E=null):T=E.sibling;var C=d(S,E,I[y],V);if(C===null){E===null&&(E=T);break}t&&E&&C.alternate===null&&e(S,E),x=s(C,x,y),H===null?b=C:H.sibling=C,H=C,E=T}if(y===I.length)return r(S,E),ft&&Es(S,y),b;if(E===null){for(;y<I.length;y++)E=h(S,I[y],V),E!==null&&(x=s(E,x,y),H===null?b=E:H.sibling=E,H=E);return ft&&Es(S,y),b}for(E=n(S,E);y<I.length;y++)T=m(E,S,y,I[y],V),T!==null&&(t&&T.alternate!==null&&E.delete(T.key===null?y:T.key),x=s(T,x,y),H===null?b=T:H.sibling=T,H=T);return t&&E.forEach(function(N){return e(S,N)}),ft&&Es(S,y),b}function g(S,x,I,V){var b=Mo(I);if(typeof b!="function")throw Error(ie(150));if(I=b.call(I),I==null)throw Error(ie(151));for(var H=b=null,E=x,y=x=0,T=null,C=I.next();E!==null&&!C.done;y++,C=I.next()){E.index>y?(T=E,E=null):T=E.sibling;var N=d(S,E,C.value,V);if(N===null){E===null&&(E=T);break}t&&E&&N.alternate===null&&e(S,E),x=s(N,x,y),H===null?b=N:H.sibling=N,H=N,E=T}if(C.done)return r(S,E),ft&&Es(S,y),b;if(E===null){for(;!C.done;y++,C=I.next())C=h(S,C.value,V),C!==null&&(x=s(C,x,y),H===null?b=C:H.sibling=C,H=C);return ft&&Es(S,y),b}for(E=n(S,E);!C.done;y++,C=I.next())C=m(E,S,y,C.value,V),C!==null&&(t&&C.alternate!==null&&E.delete(C.key===null?y:C.key),x=s(C,x,y),H===null?b=C:H.sibling=C,H=C);return t&&E.forEach(function(L){return e(S,L)}),ft&&Es(S,y),b}function w(S,x,I,V){if(typeof I=="object"&&I!==null&&I.type===xa&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case Gu:e:{for(var b=I.key,H=x;H!==null;){if(H.key===b){if(b=I.type,b===xa){if(H.tag===7){r(S,H.sibling),x=i(H,I.props.children),x.return=S,S=x;break e}}else if(H.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Pi&&k1(b)===H.type){r(S,H.sibling),x=i(H,I.props),x.ref=jo(S,H,I),x.return=S,S=x;break e}r(S,H);break}else e(S,H);H=H.sibling}I.type===xa?(x=Os(I.props.children,S.mode,V,I.key),x.return=S,S=x):(V=Oc(I.type,I.key,I.props,null,S.mode,V),V.ref=jo(S,x,I),V.return=S,S=V)}return a(S);case ya:e:{for(H=I.key;x!==null;){if(x.key===H)if(x.tag===4&&x.stateNode.containerInfo===I.containerInfo&&x.stateNode.implementation===I.implementation){r(S,x.sibling),x=i(x,I.children||[]),x.return=S,S=x;break e}else{r(S,x);break}else e(S,x);x=x.sibling}x=p0(I,S.mode,V),x.return=S,S=x}return a(S);case Pi:return H=I._init,w(S,x,H(I._payload),V)}if(Ko(I))return _(S,x,I,V);if(Mo(I))return g(S,x,I,V);nc(S,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,x!==null&&x.tag===6?(r(S,x.sibling),x=i(x,I),x.return=S,S=x):(r(S,x),x=d0(I,S.mode,V),x.return=S,S=x),a(S)):r(S,x)}return w}var Xa=mx(!0),gx=mx(!1),tf=us(null),rf=null,Ra=null,Pp=null;function Np(){Pp=Ra=rf=null}function Op(t){var e=tf.current;lt(tf),t._currentValue=e}function fd(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Ma(t,e){rf=t,Pp=Ra=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(kr=!0),t.firstContext=null)}function an(t){var e=t._currentValue;if(Pp!==t)if(t={context:t,memoizedValue:e,next:null},Ra===null){if(rf===null)throw Error(ie(308));Ra=t,rf.dependencies={lanes:0,firstContext:t}}else Ra=Ra.next=t;return e}var Is=null;function Dp(t){Is===null?Is=[t]:Is.push(t)}function vx(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,Dp(e)):(r.next=i.next,i.next=r),e.interleaved=r,ci(t,n)}function ci(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Ni=!1;function Fp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _x(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ni(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Gi(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,be&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,ci(t,r)}return i=n.interleaved,i===null?(e.next=e,Dp(n)):(e.next=i.next,i.next=e),n.interleaved=e,ci(t,r)}function Ic(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,yp(t,r)}}function P1(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function nf(t,e,r,n){var i=t.updateQueue;Ni=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var f=t.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,f=c=l=null,o=s;do{var d=o.lane,m=o.eventTime;if((n&d)===d){f!==null&&(f=f.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var _=t,g=o;switch(d=e,m=r,g.tag){case 1:if(_=g.payload,typeof _=="function"){h=_.call(m,h,d);break e}h=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=g.payload,d=typeof _=="function"?_.call(m,h,d):_,d==null)break e;h=mt({},h,d);break e;case 2:Ni=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[o]:d.push(o))}else m={eventTime:m,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(c=f=m,l=h):f=f.next=m,a|=d;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;d=o,o=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(f===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Us|=a,t.lanes=a,t.memoizedState=h}}function N1(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(ie(191,i));i.call(n)}}}var au={},Dn=us(au),Fl=us(au),Ll=us(au);function Cs(t){if(t===au)throw Error(ie(174));return t}function Lp(t,e){switch(nt(Ll,e),nt(Fl,t),nt(Dn,au),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:$0(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=$0(e,t)}lt(Dn),nt(Dn,e)}function Qa(){lt(Dn),lt(Fl),lt(Ll)}function yx(t){Cs(Ll.current);var e=Cs(Dn.current),r=$0(e,t.type);e!==r&&(nt(Fl,t),nt(Dn,r))}function Mp(t){Fl.current===t&&(lt(Dn),lt(Fl))}var dt=us(0);function sf(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var o0=[];function Vp(){for(var t=0;t<o0.length;t++)o0[t]._workInProgressVersionPrimary=null;o0.length=0}var Cc=yi.ReactCurrentDispatcher,l0=yi.ReactCurrentBatchConfig,Bs=0,pt=null,Dt=null,Vt=null,af=!1,ol=!1,Ml=0,EI=0;function or(){throw Error(ie(321))}function Bp(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!wn(t[r],e[r]))return!1;return!0}function Up(t,e,r,n,i,s){if(Bs=s,pt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Cc.current=t===null||t.memoizedState===null?AI:II,t=r(n,i),ol){s=0;do{if(ol=!1,Ml=0,25<=s)throw Error(ie(301));s+=1,Vt=Dt=null,e.updateQueue=null,Cc.current=CI,t=r(n,i)}while(ol)}if(Cc.current=of,e=Dt!==null&&Dt.next!==null,Bs=0,Vt=Dt=pt=null,af=!1,e)throw Error(ie(300));return t}function bp(){var t=Ml!==0;return Ml=0,t}function kn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vt===null?pt.memoizedState=Vt=t:Vt=Vt.next=t,Vt}function on(){if(Dt===null){var t=pt.alternate;t=t!==null?t.memoizedState:null}else t=Dt.next;var e=Vt===null?pt.memoizedState:Vt.next;if(e!==null)Vt=e,Dt=t;else{if(t===null)throw Error(ie(310));Dt=t,t={memoizedState:Dt.memoizedState,baseState:Dt.baseState,baseQueue:Dt.baseQueue,queue:Dt.queue,next:null},Vt===null?pt.memoizedState=Vt=t:Vt=Vt.next=t}return Vt}function Vl(t,e){return typeof e=="function"?e(t):e}function u0(t){var e=on(),r=e.queue;if(r===null)throw Error(ie(311));r.lastRenderedReducer=t;var n=Dt,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var f=c.lane;if((Bs&f)===f)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,pt.lanes|=f,Us|=f}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,wn(n,e.memoizedState)||(kr=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,pt.lanes|=s,Us|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function c0(t){var e=on(),r=e.queue;if(r===null)throw Error(ie(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);wn(s,e.memoizedState)||(kr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function xx(){}function Ex(t,e){var r=pt,n=on(),i=e(),s=!wn(n.memoizedState,i);if(s&&(n.memoizedState=i,kr=!0),n=n.queue,jp(Sx.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||Vt!==null&&Vt.memoizedState.tag&1){if(r.flags|=2048,Bl(9,wx.bind(null,r,n,i,e),void 0,null),zt===null)throw Error(ie(349));Bs&30||Tx(r,e,i)}return i}function Tx(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=pt.updateQueue,e===null?(e={lastEffect:null,stores:null},pt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function wx(t,e,r,n){e.value=r,e.getSnapshot=n,Ax(e)&&Ix(t)}function Sx(t,e,r){return r(function(){Ax(e)&&Ix(t)})}function Ax(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!wn(t,r)}catch{return!0}}function Ix(t){var e=ci(t,1);e!==null&&xn(e,t,1,-1)}function O1(t){var e=kn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vl,lastRenderedState:t},e.queue=t,t=t.dispatch=SI.bind(null,pt,t),[e.memoizedState,t]}function Bl(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=pt.updateQueue,e===null?(e={lastEffect:null,stores:null},pt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function Cx(){return on().memoizedState}function Rc(t,e,r,n){var i=kn();pt.flags|=t,i.memoizedState=Bl(1|e,r,void 0,n===void 0?null:n)}function Yf(t,e,r,n){var i=on();n=n===void 0?null:n;var s=void 0;if(Dt!==null){var a=Dt.memoizedState;if(s=a.destroy,n!==null&&Bp(n,a.deps)){i.memoizedState=Bl(e,r,s,n);return}}pt.flags|=t,i.memoizedState=Bl(1|e,r,s,n)}function D1(t,e){return Rc(8390656,8,t,e)}function jp(t,e){return Yf(2048,8,t,e)}function Rx(t,e){return Yf(4,2,t,e)}function kx(t,e){return Yf(4,4,t,e)}function Px(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Nx(t,e,r){return r=r!=null?r.concat([t]):null,Yf(4,4,Px.bind(null,e,t),r)}function zp(){}function Ox(t,e){var r=on();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Bp(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function Dx(t,e){var r=on();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Bp(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Fx(t,e,r){return Bs&21?(wn(r,e)||(r=Uy(),pt.lanes|=r,Us|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,kr=!0),t.memoizedState=r)}function TI(t,e){var r=Ye;Ye=r!==0&&4>r?r:4,t(!0);var n=l0.transition;l0.transition={};try{t(!1),e()}finally{Ye=r,l0.transition=n}}function Lx(){return on().memoizedState}function wI(t,e,r){var n=qi(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Mx(t))Vx(e,r);else if(r=vx(t,e,r,n),r!==null){var i=xr();xn(r,t,n,i),Bx(r,e,n)}}function SI(t,e,r){var n=qi(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Mx(t))Vx(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,wn(o,a)){var l=e.interleaved;l===null?(i.next=i,Dp(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=vx(t,e,i,n),r!==null&&(i=xr(),xn(r,t,n,i),Bx(r,e,n))}}function Mx(t){var e=t.alternate;return t===pt||e!==null&&e===pt}function Vx(t,e){ol=af=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Bx(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,yp(t,r)}}var of={readContext:an,useCallback:or,useContext:or,useEffect:or,useImperativeHandle:or,useInsertionEffect:or,useLayoutEffect:or,useMemo:or,useReducer:or,useRef:or,useState:or,useDebugValue:or,useDeferredValue:or,useTransition:or,useMutableSource:or,useSyncExternalStore:or,useId:or,unstable_isNewReconciler:!1},AI={readContext:an,useCallback:function(t,e){return kn().memoizedState=[t,e===void 0?null:e],t},useContext:an,useEffect:D1,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Rc(4194308,4,Px.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Rc(4194308,4,t,e)},useInsertionEffect:function(t,e){return Rc(4,2,t,e)},useMemo:function(t,e){var r=kn();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=kn();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=wI.bind(null,pt,t),[n.memoizedState,t]},useRef:function(t){var e=kn();return t={current:t},e.memoizedState=t},useState:O1,useDebugValue:zp,useDeferredValue:function(t){return kn().memoizedState=t},useTransition:function(){var t=O1(!1),e=t[0];return t=TI.bind(null,t[1]),kn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=pt,i=kn();if(ft){if(r===void 0)throw Error(ie(407));r=r()}else{if(r=e(),zt===null)throw Error(ie(349));Bs&30||Tx(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,D1(Sx.bind(null,n,s,t),[t]),n.flags|=2048,Bl(9,wx.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=kn(),e=zt.identifierPrefix;if(ft){var r=Jn,n=Yn;r=(n&~(1<<32-yn(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Ml++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=EI++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},II={readContext:an,useCallback:Ox,useContext:an,useEffect:jp,useImperativeHandle:Nx,useInsertionEffect:Rx,useLayoutEffect:kx,useMemo:Dx,useReducer:u0,useRef:Cx,useState:function(){return u0(Vl)},useDebugValue:zp,useDeferredValue:function(t){var e=on();return Fx(e,Dt.memoizedState,t)},useTransition:function(){var t=u0(Vl)[0],e=on().memoizedState;return[t,e]},useMutableSource:xx,useSyncExternalStore:Ex,useId:Lx,unstable_isNewReconciler:!1},CI={readContext:an,useCallback:Ox,useContext:an,useEffect:jp,useImperativeHandle:Nx,useInsertionEffect:Rx,useLayoutEffect:kx,useMemo:Dx,useReducer:c0,useRef:Cx,useState:function(){return c0(Vl)},useDebugValue:zp,useDeferredValue:function(t){var e=on();return Dt===null?e.memoizedState=t:Fx(e,Dt.memoizedState,t)},useTransition:function(){var t=c0(Vl)[0],e=on().memoizedState;return[t,e]},useMutableSource:xx,useSyncExternalStore:Ex,useId:Lx,unstable_isNewReconciler:!1};function pn(t,e){if(t&&t.defaultProps){e=mt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function hd(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:mt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Jf={isMounted:function(t){return(t=t._reactInternals)?Qs(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=xr(),i=qi(t),s=ni(n,i);s.payload=e,r!=null&&(s.callback=r),e=Gi(t,s,i),e!==null&&(xn(e,t,i,n),Ic(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=xr(),i=qi(t),s=ni(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=Gi(t,s,i),e!==null&&(xn(e,t,i,n),Ic(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=xr(),n=qi(t),i=ni(r,n);i.tag=2,e!=null&&(i.callback=e),e=Gi(t,i,n),e!==null&&(xn(e,t,n,r),Ic(e,t,n))}};function F1(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!Pl(r,n)||!Pl(i,s):!0}function Ux(t,e,r){var n=!1,i=ts,s=e.contextType;return typeof s=="object"&&s!==null?s=an(s):(i=Nr(e)?Ms:mr.current,n=e.contextTypes,s=(n=n!=null)?Ka(t,i):ts),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Jf,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function L1(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Jf.enqueueReplaceState(e,e.state,null)}function dd(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},Fp(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=an(s):(s=Nr(e)?Ms:mr.current,i.context=Ka(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(hd(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Jf.enqueueReplaceState(i,i.state,null),nf(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Ya(t,e){try{var r="",n=e;do r+=tA(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function f0(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function pd(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var RI=typeof WeakMap=="function"?WeakMap:Map;function bx(t,e,r){r=ni(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){uf||(uf=!0,Sd=n),pd(t,e)},r}function jx(t,e,r){r=ni(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){pd(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){pd(t,e),typeof n!="function"&&(Ki===null?Ki=new Set([this]):Ki.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function M1(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new RI;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=zI.bind(null,t,e,r),e.then(t,t))}function V1(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function B1(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=ni(-1,1),e.tag=2,Gi(r,e,1))),r.lanes|=1),t)}var kI=yi.ReactCurrentOwner,kr=!1;function vr(t,e,r,n){e.child=t===null?gx(e,null,r,n):Xa(e,t.child,r,n)}function U1(t,e,r,n,i){r=r.render;var s=e.ref;return Ma(e,i),n=Up(t,e,r,n,s,i),r=bp(),t!==null&&!kr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,fi(t,e,i)):(ft&&r&&Cp(e),e.flags|=1,vr(t,e,n,i),e.child)}function b1(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!Qp(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,zx(t,e,s,n,i)):(t=Oc(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Pl,r(a,n)&&t.ref===e.ref)return fi(t,e,i)}return e.flags|=1,t=Xi(s,n),t.ref=e.ref,t.return=e,e.child=t}function zx(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Pl(s,n)&&t.ref===e.ref)if(kr=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(kr=!0);else return e.lanes=t.lanes,fi(t,e,i)}return md(t,e,r,n,i)}function Wx(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},nt(Pa,br),br|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,nt(Pa,br),br|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,nt(Pa,br),br|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,nt(Pa,br),br|=n;return vr(t,e,i,r),e.child}function Hx(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function md(t,e,r,n,i){var s=Nr(r)?Ms:mr.current;return s=Ka(e,s),Ma(e,i),r=Up(t,e,r,n,s,i),n=bp(),t!==null&&!kr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,fi(t,e,i)):(ft&&n&&Cp(e),e.flags|=1,vr(t,e,r,i),e.child)}function j1(t,e,r,n,i){if(Nr(r)){var s=!0;Jc(e)}else s=!1;if(Ma(e,i),e.stateNode===null)kc(t,e),Ux(e,r,n),dd(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=an(c):(c=Nr(r)?Ms:mr.current,c=Ka(e,c));var f=r.getDerivedStateFromProps,h=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&L1(e,a,n,c),Ni=!1;var d=e.memoizedState;a.state=d,nf(e,n,a,i),l=e.memoizedState,o!==n||d!==l||Pr.current||Ni?(typeof f=="function"&&(hd(e,r,f,n),l=e.memoizedState),(o=Ni||F1(e,r,o,n,d,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,_x(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:pn(e.type,o),a.props=c,h=e.pendingProps,d=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=an(l):(l=Nr(r)?Ms:mr.current,l=Ka(e,l));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&L1(e,a,n,l),Ni=!1,d=e.memoizedState,a.state=d,nf(e,n,a,i);var _=e.memoizedState;o!==h||d!==_||Pr.current||Ni?(typeof m=="function"&&(hd(e,r,m,n),_=e.memoizedState),(c=Ni||F1(e,r,c,n,d,_,l)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,_,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,_,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=_),a.props=n,a.state=_,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return gd(t,e,r,n,s,i)}function gd(t,e,r,n,i,s){Hx(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&I1(e,r,!1),fi(t,e,s);n=e.stateNode,kI.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=Xa(e,t.child,null,s),e.child=Xa(e,null,o,s)):vr(t,e,o,s),e.memoizedState=n.state,i&&I1(e,r,!0),e.child}function $x(t){var e=t.stateNode;e.pendingContext?A1(t,e.pendingContext,e.pendingContext!==e.context):e.context&&A1(t,e.context,!1),Lp(t,e.containerInfo)}function z1(t,e,r,n,i){return qa(),kp(i),e.flags|=256,vr(t,e,r,n),e.child}var vd={dehydrated:null,treeContext:null,retryLane:0};function _d(t){return{baseLanes:t,cachePool:null,transitions:null}}function Gx(t,e,r){var n=e.pendingProps,i=dt.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),nt(dt,i&1),t===null)return cd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=th(a,n,0,null),t=Os(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=_d(r),e.memoizedState=vd,t):Wp(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return PI(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Xi(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Xi(o,s):(s=Os(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?_d(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=vd,n}return s=t.child,t=s.sibling,n=Xi(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Wp(t,e){return e=th({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ic(t,e,r,n){return n!==null&&kp(n),Xa(e,t.child,null,r),t=Wp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function PI(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=f0(Error(ie(422))),ic(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=th({mode:"visible",children:n.children},i,0,null),s=Os(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Xa(e,t.child,null,a),e.child.memoizedState=_d(a),e.memoizedState=vd,s);if(!(e.mode&1))return ic(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(ie(419)),n=f0(s,n,void 0),ic(t,e,a,n)}if(o=(a&t.childLanes)!==0,kr||o){if(n=zt,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ci(t,i),xn(n,t,i,-1))}return Xp(),n=f0(Error(ie(421))),ic(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=WI.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Hr=$i(i.nextSibling),Gr=e,ft=!0,gn=null,t!==null&&(tn[rn++]=Yn,tn[rn++]=Jn,tn[rn++]=Vs,Yn=t.id,Jn=t.overflow,Vs=e),e=Wp(e,n.children),e.flags|=4096,e)}function W1(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),fd(t.return,e,r)}function h0(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function Kx(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(vr(t,e,n.children,r),n=dt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&W1(t,r,e);else if(t.tag===19)W1(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(nt(dt,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&sf(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),h0(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&sf(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}h0(e,!0,r,null,s);break;case"together":h0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function kc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function fi(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Us|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ie(153));if(e.child!==null){for(t=e.child,r=Xi(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Xi(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function NI(t,e,r){switch(e.tag){case 3:$x(e),qa();break;case 5:yx(e);break;case 1:Nr(e.type)&&Jc(e);break;case 4:Lp(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;nt(tf,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(nt(dt,dt.current&1),e.flags|=128,null):r&e.child.childLanes?Gx(t,e,r):(nt(dt,dt.current&1),t=fi(t,e,r),t!==null?t.sibling:null);nt(dt,dt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return Kx(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),nt(dt,dt.current),n)break;return null;case 22:case 23:return e.lanes=0,Wx(t,e,r)}return fi(t,e,r)}var qx,yd,Xx,Qx;qx=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};yd=function(){};Xx=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Cs(Dn.current);var s=null;switch(r){case"input":i=j0(t,i),n=j0(t,n),s=[];break;case"select":i=mt({},i,{value:void 0}),n=mt({},n,{value:void 0}),s=[];break;case"textarea":i=H0(t,i),n=H0(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Qc)}G0(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(wl.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(wl.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&at("scroll",t),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};Qx=function(t,e,r,n){r!==n&&(e.flags|=4)};function zo(t,e){if(!ft)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function lr(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function OI(t,e,r){var n=e.pendingProps;switch(Rp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lr(e),null;case 1:return Nr(e.type)&&Yc(),lr(e),null;case 3:return n=e.stateNode,Qa(),lt(Pr),lt(mr),Vp(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(rc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,gn!==null&&(Cd(gn),gn=null))),yd(t,e),lr(e),null;case 5:Mp(e);var i=Cs(Ll.current);if(r=e.type,t!==null&&e.stateNode!=null)Xx(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(ie(166));return lr(e),null}if(t=Cs(Dn.current),rc(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Nn]=e,n[Dl]=s,t=(e.mode&1)!==0,r){case"dialog":at("cancel",n),at("close",n);break;case"iframe":case"object":case"embed":at("load",n);break;case"video":case"audio":for(i=0;i<Xo.length;i++)at(Xo[i],n);break;case"source":at("error",n);break;case"img":case"image":case"link":at("error",n),at("load",n);break;case"details":at("toggle",n);break;case"input":Jg(n,s),at("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},at("invalid",n);break;case"textarea":e1(n,s),at("invalid",n)}G0(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&tc(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&tc(n.textContent,o,t),i=["children",""+o]):wl.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&at("scroll",n)}switch(r){case"input":Ku(n),Zg(n,s,!0);break;case"textarea":Ku(n),t1(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Qc)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Sy(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[Nn]=e,t[Dl]=n,qx(t,e,!1,!1),e.stateNode=t;e:{switch(a=K0(r,n),r){case"dialog":at("cancel",t),at("close",t),i=n;break;case"iframe":case"object":case"embed":at("load",t),i=n;break;case"video":case"audio":for(i=0;i<Xo.length;i++)at(Xo[i],t);i=n;break;case"source":at("error",t),i=n;break;case"img":case"image":case"link":at("error",t),at("load",t),i=n;break;case"details":at("toggle",t),i=n;break;case"input":Jg(t,n),i=j0(t,n),at("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=mt({},n,{value:void 0}),at("invalid",t);break;case"textarea":e1(t,n),i=H0(t,n),at("invalid",t);break;default:i=n}G0(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Cy(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Ay(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Sl(t,l):typeof l=="number"&&Sl(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(wl.hasOwnProperty(s)?l!=null&&s==="onScroll"&&at("scroll",t):l!=null&&dp(t,s,l,a))}switch(r){case"input":Ku(t),Zg(t,n,!1);break;case"textarea":Ku(t),t1(t);break;case"option":n.value!=null&&t.setAttribute("value",""+es(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Oa(t,!!n.multiple,s,!1):n.defaultValue!=null&&Oa(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Qc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return lr(e),null;case 6:if(t&&e.stateNode!=null)Qx(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(ie(166));if(r=Cs(Ll.current),Cs(Dn.current),rc(e)){if(n=e.stateNode,r=e.memoizedProps,n[Nn]=e,(s=n.nodeValue!==r)&&(t=Gr,t!==null))switch(t.tag){case 3:tc(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&tc(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Nn]=e,e.stateNode=n}return lr(e),null;case 13:if(lt(dt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ft&&Hr!==null&&e.mode&1&&!(e.flags&128))px(),qa(),e.flags|=98560,s=!1;else if(s=rc(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(ie(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ie(317));s[Nn]=e}else qa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;lr(e),s=!1}else gn!==null&&(Cd(gn),gn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||dt.current&1?Ft===0&&(Ft=3):Xp())),e.updateQueue!==null&&(e.flags|=4),lr(e),null);case 4:return Qa(),yd(t,e),t===null&&Nl(e.stateNode.containerInfo),lr(e),null;case 10:return Op(e.type._context),lr(e),null;case 17:return Nr(e.type)&&Yc(),lr(e),null;case 19:if(lt(dt),s=e.memoizedState,s===null)return lr(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)zo(s,!1);else{if(Ft!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=sf(t),a!==null){for(e.flags|=128,zo(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return nt(dt,dt.current&1|2),e.child}t=t.sibling}s.tail!==null&&Tt()>Ja&&(e.flags|=128,n=!0,zo(s,!1),e.lanes=4194304)}else{if(!n)if(t=sf(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),zo(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!ft)return lr(e),null}else 2*Tt()-s.renderingStartTime>Ja&&r!==1073741824&&(e.flags|=128,n=!0,zo(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Tt(),e.sibling=null,r=dt.current,nt(dt,n?r&1|2:r&1),e):(lr(e),null);case 22:case 23:return qp(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?br&1073741824&&(lr(e),e.subtreeFlags&6&&(e.flags|=8192)):lr(e),null;case 24:return null;case 25:return null}throw Error(ie(156,e.tag))}function DI(t,e){switch(Rp(e),e.tag){case 1:return Nr(e.type)&&Yc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Qa(),lt(Pr),lt(mr),Vp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Mp(e),null;case 13:if(lt(dt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ie(340));qa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return lt(dt),null;case 4:return Qa(),null;case 10:return Op(e.type._context),null;case 22:case 23:return qp(),null;case 24:return null;default:return null}}var sc=!1,fr=!1,FI=typeof WeakSet=="function"?WeakSet:Set,ge=null;function ka(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){_t(t,e,n)}else r.current=null}function xd(t,e,r){try{r()}catch(n){_t(t,e,n)}}var H1=!1;function LI(t,e){if(nd=Kc,t=tx(),Ip(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,f=0,h=t,d=null;t:for(;;){for(var m;h!==r||i!==0&&h.nodeType!==3||(o=a+i),h!==s||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(m=h.firstChild)!==null;)d=h,h=m;for(;;){if(h===t)break t;if(d===r&&++c===i&&(o=a),d===s&&++f===n&&(l=a),(m=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(id={focusedElem:t,selectionRange:r},Kc=!1,ge=e;ge!==null;)if(e=ge,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ge=t;else for(;ge!==null;){e=ge;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var g=_.memoizedProps,w=_.memoizedState,S=e.stateNode,x=S.getSnapshotBeforeUpdate(e.elementType===e.type?g:pn(e.type,g),w);S.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ie(163))}}catch(V){_t(e,e.return,V)}if(t=e.sibling,t!==null){t.return=e.return,ge=t;break}ge=e.return}return _=H1,H1=!1,_}function ll(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&xd(e,r,s)}i=i.next}while(i!==n)}}function Zf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Ed(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function Yx(t){var e=t.alternate;e!==null&&(t.alternate=null,Yx(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Nn],delete e[Dl],delete e[od],delete e[vI],delete e[_I])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Jx(t){return t.tag===5||t.tag===3||t.tag===4}function $1(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Jx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Td(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Qc));else if(n!==4&&(t=t.child,t!==null))for(Td(t,e,r),t=t.sibling;t!==null;)Td(t,e,r),t=t.sibling}function wd(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(wd(t,e,r),t=t.sibling;t!==null;)wd(t,e,r),t=t.sibling}var Gt=null,mn=!1;function Ci(t,e,r){for(r=r.child;r!==null;)Zx(t,e,r),r=r.sibling}function Zx(t,e,r){if(On&&typeof On.onCommitFiberUnmount=="function")try{On.onCommitFiberUnmount($f,r)}catch{}switch(r.tag){case 5:fr||ka(r,e);case 6:var n=Gt,i=mn;Gt=null,Ci(t,e,r),Gt=n,mn=i,Gt!==null&&(mn?(t=Gt,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Gt.removeChild(r.stateNode));break;case 18:Gt!==null&&(mn?(t=Gt,r=r.stateNode,t.nodeType===8?s0(t.parentNode,r):t.nodeType===1&&s0(t,r),Rl(t)):s0(Gt,r.stateNode));break;case 4:n=Gt,i=mn,Gt=r.stateNode.containerInfo,mn=!0,Ci(t,e,r),Gt=n,mn=i;break;case 0:case 11:case 14:case 15:if(!fr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&xd(r,e,a),i=i.next}while(i!==n)}Ci(t,e,r);break;case 1:if(!fr&&(ka(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){_t(r,e,o)}Ci(t,e,r);break;case 21:Ci(t,e,r);break;case 22:r.mode&1?(fr=(n=fr)||r.memoizedState!==null,Ci(t,e,r),fr=n):Ci(t,e,r);break;default:Ci(t,e,r)}}function G1(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new FI),e.forEach(function(n){var i=HI.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function fn(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Gt=o.stateNode,mn=!1;break e;case 3:Gt=o.stateNode.containerInfo,mn=!0;break e;case 4:Gt=o.stateNode.containerInfo,mn=!0;break e}o=o.return}if(Gt===null)throw Error(ie(160));Zx(s,a,i),Gt=null,mn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){_t(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)eE(e,t),e=e.sibling}function eE(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(fn(e,t),In(t),n&4){try{ll(3,t,t.return),Zf(3,t)}catch(g){_t(t,t.return,g)}try{ll(5,t,t.return)}catch(g){_t(t,t.return,g)}}break;case 1:fn(e,t),In(t),n&512&&r!==null&&ka(r,r.return);break;case 5:if(fn(e,t),In(t),n&512&&r!==null&&ka(r,r.return),t.flags&32){var i=t.stateNode;try{Sl(i,"")}catch(g){_t(t,t.return,g)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Ty(i,s),K0(o,a);var c=K0(o,s);for(a=0;a<l.length;a+=2){var f=l[a],h=l[a+1];f==="style"?Cy(i,h):f==="dangerouslySetInnerHTML"?Ay(i,h):f==="children"?Sl(i,h):dp(i,f,h,c)}switch(o){case"input":z0(i,s);break;case"textarea":wy(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?Oa(i,!!s.multiple,m,!1):d!==!!s.multiple&&(s.defaultValue!=null?Oa(i,!!s.multiple,s.defaultValue,!0):Oa(i,!!s.multiple,s.multiple?[]:"",!1))}i[Dl]=s}catch(g){_t(t,t.return,g)}}break;case 6:if(fn(e,t),In(t),n&4){if(t.stateNode===null)throw Error(ie(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(g){_t(t,t.return,g)}}break;case 3:if(fn(e,t),In(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Rl(e.containerInfo)}catch(g){_t(t,t.return,g)}break;case 4:fn(e,t),In(t);break;case 13:fn(e,t),In(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Gp=Tt())),n&4&&G1(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(fr=(c=fr)||f,fn(e,t),fr=c):fn(e,t),In(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!f&&t.mode&1)for(ge=t,f=t.child;f!==null;){for(h=ge=f;ge!==null;){switch(d=ge,m=d.child,d.tag){case 0:case 11:case 14:case 15:ll(4,d,d.return);break;case 1:ka(d,d.return);var _=d.stateNode;if(typeof _.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(g){_t(n,r,g)}}break;case 5:ka(d,d.return);break;case 22:if(d.memoizedState!==null){q1(h);continue}}m!==null?(m.return=d,ge=m):q1(h)}f=f.sibling}e:for(f=null,h=t;;){if(h.tag===5){if(f===null){f=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Iy("display",a))}catch(g){_t(t,t.return,g)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){_t(t,t.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:fn(e,t),In(t),n&4&&G1(t);break;case 21:break;default:fn(e,t),In(t)}}function In(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(Jx(r)){var n=r;break e}r=r.return}throw Error(ie(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Sl(i,""),n.flags&=-33);var s=$1(t);wd(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=$1(t);Td(t,o,a);break;default:throw Error(ie(161))}}catch(l){_t(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function MI(t,e,r){ge=t,tE(t)}function tE(t,e,r){for(var n=(t.mode&1)!==0;ge!==null;){var i=ge,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||sc;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||fr;o=sc;var c=fr;if(sc=a,(fr=l)&&!c)for(ge=i;ge!==null;)a=ge,l=a.child,a.tag===22&&a.memoizedState!==null?X1(i):l!==null?(l.return=a,ge=l):X1(i);for(;s!==null;)ge=s,tE(s),s=s.sibling;ge=i,sc=o,fr=c}K1(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ge=s):K1(t)}}function K1(t){for(;ge!==null;){var e=ge;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:fr||Zf(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!fr)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:pn(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&N1(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}N1(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&Rl(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ie(163))}fr||e.flags&512&&Ed(e)}catch(d){_t(e,e.return,d)}}if(e===t){ge=null;break}if(r=e.sibling,r!==null){r.return=e.return,ge=r;break}ge=e.return}}function q1(t){for(;ge!==null;){var e=ge;if(e===t){ge=null;break}var r=e.sibling;if(r!==null){r.return=e.return,ge=r;break}ge=e.return}}function X1(t){for(;ge!==null;){var e=ge;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Zf(4,e)}catch(l){_t(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){_t(e,i,l)}}var s=e.return;try{Ed(e)}catch(l){_t(e,s,l)}break;case 5:var a=e.return;try{Ed(e)}catch(l){_t(e,a,l)}}}catch(l){_t(e,e.return,l)}if(e===t){ge=null;break}var o=e.sibling;if(o!==null){o.return=e.return,ge=o;break}ge=e.return}}var VI=Math.ceil,lf=yi.ReactCurrentDispatcher,Hp=yi.ReactCurrentOwner,sn=yi.ReactCurrentBatchConfig,be=0,zt=null,It=null,Jt=0,br=0,Pa=us(0),Ft=0,Ul=null,Us=0,eh=0,$p=0,ul=null,Cr=null,Gp=0,Ja=1/0,Kn=null,uf=!1,Sd=null,Ki=null,ac=!1,Bi=null,cf=0,cl=0,Ad=null,Pc=-1,Nc=0;function xr(){return be&6?Tt():Pc!==-1?Pc:Pc=Tt()}function qi(t){return t.mode&1?be&2&&Jt!==0?Jt&-Jt:xI.transition!==null?(Nc===0&&(Nc=Uy()),Nc):(t=Ye,t!==0||(t=window.event,t=t===void 0?16:Gy(t.type)),t):1}function xn(t,e,r,n){if(50<cl)throw cl=0,Ad=null,Error(ie(185));nu(t,r,n),(!(be&2)||t!==zt)&&(t===zt&&(!(be&2)&&(eh|=r),Ft===4&&Di(t,Jt)),Or(t,n),r===1&&be===0&&!(e.mode&1)&&(Ja=Tt()+500,Qf&&cs()))}function Or(t,e){var r=t.callbackNode;xA(t,e);var n=Gc(t,t===zt?Jt:0);if(n===0)r!==null&&i1(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&i1(r),e===1)t.tag===0?yI(Q1.bind(null,t)):fx(Q1.bind(null,t)),mI(function(){!(be&6)&&cs()}),r=null;else{switch(by(n)){case 1:r=_p;break;case 4:r=Vy;break;case 16:r=$c;break;case 536870912:r=By;break;default:r=$c}r=uE(r,rE.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function rE(t,e){if(Pc=-1,Nc=0,be&6)throw Error(ie(327));var r=t.callbackNode;if(Va()&&t.callbackNode!==r)return null;var n=Gc(t,t===zt?Jt:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=ff(t,n);else{e=n;var i=be;be|=2;var s=iE();(zt!==t||Jt!==e)&&(Kn=null,Ja=Tt()+500,Ns(t,e));do try{bI();break}catch(o){nE(t,o)}while(!0);Np(),lf.current=s,be=i,It!==null?e=0:(zt=null,Jt=0,e=Ft)}if(e!==0){if(e===2&&(i=J0(t),i!==0&&(n=i,e=Id(t,i))),e===1)throw r=Ul,Ns(t,0),Di(t,n),Or(t,Tt()),r;if(e===6)Di(t,n);else{if(i=t.current.alternate,!(n&30)&&!BI(i)&&(e=ff(t,n),e===2&&(s=J0(t),s!==0&&(n=s,e=Id(t,s))),e===1))throw r=Ul,Ns(t,0),Di(t,n),Or(t,Tt()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(ie(345));case 2:Ts(t,Cr,Kn);break;case 3:if(Di(t,n),(n&130023424)===n&&(e=Gp+500-Tt(),10<e)){if(Gc(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){xr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=ad(Ts.bind(null,t,Cr,Kn),e);break}Ts(t,Cr,Kn);break;case 4:if(Di(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-yn(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=Tt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*VI(n/1960))-n,10<n){t.timeoutHandle=ad(Ts.bind(null,t,Cr,Kn),n);break}Ts(t,Cr,Kn);break;case 5:Ts(t,Cr,Kn);break;default:throw Error(ie(329))}}}return Or(t,Tt()),t.callbackNode===r?rE.bind(null,t):null}function Id(t,e){var r=ul;return t.current.memoizedState.isDehydrated&&(Ns(t,e).flags|=256),t=ff(t,e),t!==2&&(e=Cr,Cr=r,e!==null&&Cd(e)),t}function Cd(t){Cr===null?Cr=t:Cr.push.apply(Cr,t)}function BI(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!wn(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Di(t,e){for(e&=~$p,e&=~eh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-yn(e),n=1<<r;t[r]=-1,e&=~n}}function Q1(t){if(be&6)throw Error(ie(327));Va();var e=Gc(t,0);if(!(e&1))return Or(t,Tt()),null;var r=ff(t,e);if(t.tag!==0&&r===2){var n=J0(t);n!==0&&(e=n,r=Id(t,n))}if(r===1)throw r=Ul,Ns(t,0),Di(t,e),Or(t,Tt()),r;if(r===6)throw Error(ie(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ts(t,Cr,Kn),Or(t,Tt()),null}function Kp(t,e){var r=be;be|=1;try{return t(e)}finally{be=r,be===0&&(Ja=Tt()+500,Qf&&cs())}}function bs(t){Bi!==null&&Bi.tag===0&&!(be&6)&&Va();var e=be;be|=1;var r=sn.transition,n=Ye;try{if(sn.transition=null,Ye=1,t)return t()}finally{Ye=n,sn.transition=r,be=e,!(be&6)&&cs()}}function qp(){br=Pa.current,lt(Pa)}function Ns(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,pI(r)),It!==null)for(r=It.return;r!==null;){var n=r;switch(Rp(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Yc();break;case 3:Qa(),lt(Pr),lt(mr),Vp();break;case 5:Mp(n);break;case 4:Qa();break;case 13:lt(dt);break;case 19:lt(dt);break;case 10:Op(n.type._context);break;case 22:case 23:qp()}r=r.return}if(zt=t,It=t=Xi(t.current,null),Jt=br=e,Ft=0,Ul=null,$p=eh=Us=0,Cr=ul=null,Is!==null){for(e=0;e<Is.length;e++)if(r=Is[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}Is=null}return t}function nE(t,e){do{var r=It;try{if(Np(),Cc.current=of,af){for(var n=pt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}af=!1}if(Bs=0,Vt=Dt=pt=null,ol=!1,Ml=0,Hp.current=null,r===null||r.return===null){Ft=1,Ul=e,It=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=Jt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,f=o,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=V1(a);if(m!==null){m.flags&=-257,B1(m,a,o,s,e),m.mode&1&&M1(s,c,e),e=m,l=c;var _=e.updateQueue;if(_===null){var g=new Set;g.add(l),e.updateQueue=g}else _.add(l);break e}else{if(!(e&1)){M1(s,c,e),Xp();break e}l=Error(ie(426))}}else if(ft&&o.mode&1){var w=V1(a);if(w!==null){!(w.flags&65536)&&(w.flags|=256),B1(w,a,o,s,e),kp(Ya(l,o));break e}}s=l=Ya(l,o),Ft!==4&&(Ft=2),ul===null?ul=[s]:ul.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var S=bx(s,l,e);P1(s,S);break e;case 1:o=l;var x=s.type,I=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(Ki===null||!Ki.has(I)))){s.flags|=65536,e&=-e,s.lanes|=e;var V=jx(s,o,e);P1(s,V);break e}}s=s.return}while(s!==null)}aE(r)}catch(b){e=b,It===r&&r!==null&&(It=r=r.return);continue}break}while(!0)}function iE(){var t=lf.current;return lf.current=of,t===null?of:t}function Xp(){(Ft===0||Ft===3||Ft===2)&&(Ft=4),zt===null||!(Us&268435455)&&!(eh&268435455)||Di(zt,Jt)}function ff(t,e){var r=be;be|=2;var n=iE();(zt!==t||Jt!==e)&&(Kn=null,Ns(t,e));do try{UI();break}catch(i){nE(t,i)}while(!0);if(Np(),be=r,lf.current=n,It!==null)throw Error(ie(261));return zt=null,Jt=0,Ft}function UI(){for(;It!==null;)sE(It)}function bI(){for(;It!==null&&!fA();)sE(It)}function sE(t){var e=lE(t.alternate,t,br);t.memoizedProps=t.pendingProps,e===null?aE(t):It=e,Hp.current=null}function aE(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=DI(r,e),r!==null){r.flags&=32767,It=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ft=6,It=null;return}}else if(r=OI(r,e,br),r!==null){It=r;return}if(e=e.sibling,e!==null){It=e;return}It=e=t}while(e!==null);Ft===0&&(Ft=5)}function Ts(t,e,r){var n=Ye,i=sn.transition;try{sn.transition=null,Ye=1,jI(t,e,r,n)}finally{sn.transition=i,Ye=n}return null}function jI(t,e,r,n){do Va();while(Bi!==null);if(be&6)throw Error(ie(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(ie(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(EA(t,s),t===zt&&(It=zt=null,Jt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||ac||(ac=!0,uE($c,function(){return Va(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=sn.transition,sn.transition=null;var a=Ye;Ye=1;var o=be;be|=4,Hp.current=null,LI(t,r),eE(r,t),oI(id),Kc=!!nd,id=nd=null,t.current=r,MI(r),hA(),be=o,Ye=a,sn.transition=s}else t.current=r;if(ac&&(ac=!1,Bi=t,cf=i),s=t.pendingLanes,s===0&&(Ki=null),mA(r.stateNode),Or(t,Tt()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(uf)throw uf=!1,t=Sd,Sd=null,t;return cf&1&&t.tag!==0&&Va(),s=t.pendingLanes,s&1?t===Ad?cl++:(cl=0,Ad=t):cl=0,cs(),null}function Va(){if(Bi!==null){var t=by(cf),e=sn.transition,r=Ye;try{if(sn.transition=null,Ye=16>t?16:t,Bi===null)var n=!1;else{if(t=Bi,Bi=null,cf=0,be&6)throw Error(ie(331));var i=be;for(be|=4,ge=t.current;ge!==null;){var s=ge,a=s.child;if(ge.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(ge=c;ge!==null;){var f=ge;switch(f.tag){case 0:case 11:case 15:ll(8,f,s)}var h=f.child;if(h!==null)h.return=f,ge=h;else for(;ge!==null;){f=ge;var d=f.sibling,m=f.return;if(Yx(f),f===c){ge=null;break}if(d!==null){d.return=m,ge=d;break}ge=m}}}var _=s.alternate;if(_!==null){var g=_.child;if(g!==null){_.child=null;do{var w=g.sibling;g.sibling=null,g=w}while(g!==null)}}ge=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,ge=a;else e:for(;ge!==null;){if(s=ge,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ll(9,s,s.return)}var S=s.sibling;if(S!==null){S.return=s.return,ge=S;break e}ge=s.return}}var x=t.current;for(ge=x;ge!==null;){a=ge;var I=a.child;if(a.subtreeFlags&2064&&I!==null)I.return=a,ge=I;else e:for(a=x;ge!==null;){if(o=ge,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Zf(9,o)}}catch(b){_t(o,o.return,b)}if(o===a){ge=null;break e}var V=o.sibling;if(V!==null){V.return=o.return,ge=V;break e}ge=o.return}}if(be=i,cs(),On&&typeof On.onPostCommitFiberRoot=="function")try{On.onPostCommitFiberRoot($f,t)}catch{}n=!0}return n}finally{Ye=r,sn.transition=e}}return!1}function Y1(t,e,r){e=Ya(r,e),e=bx(t,e,1),t=Gi(t,e,1),e=xr(),t!==null&&(nu(t,1,e),Or(t,e))}function _t(t,e,r){if(t.tag===3)Y1(t,t,r);else for(;e!==null;){if(e.tag===3){Y1(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ki===null||!Ki.has(n))){t=Ya(r,t),t=jx(e,t,1),e=Gi(e,t,1),t=xr(),e!==null&&(nu(e,1,t),Or(e,t));break}}e=e.return}}function zI(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=xr(),t.pingedLanes|=t.suspendedLanes&r,zt===t&&(Jt&r)===r&&(Ft===4||Ft===3&&(Jt&130023424)===Jt&&500>Tt()-Gp?Ns(t,0):$p|=r),Or(t,e)}function oE(t,e){e===0&&(t.mode&1?(e=Qu,Qu<<=1,!(Qu&130023424)&&(Qu=4194304)):e=1);var r=xr();t=ci(t,e),t!==null&&(nu(t,e,r),Or(t,r))}function WI(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),oE(t,r)}function HI(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(ie(314))}n!==null&&n.delete(e),oE(t,r)}var lE;lE=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Pr.current)kr=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return kr=!1,NI(t,e,r);kr=!!(t.flags&131072)}else kr=!1,ft&&e.flags&1048576&&hx(e,ef,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;kc(t,e),t=e.pendingProps;var i=Ka(e,mr.current);Ma(e,r),i=Up(null,e,n,t,i,r);var s=bp();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Nr(n)?(s=!0,Jc(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Fp(e),i.updater=Jf,e.stateNode=i,i._reactInternals=e,dd(e,n,t,r),e=gd(null,e,n,!0,s,r)):(e.tag=0,ft&&s&&Cp(e),vr(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(kc(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=GI(n),t=pn(n,t),i){case 0:e=md(null,e,n,t,r);break e;case 1:e=j1(null,e,n,t,r);break e;case 11:e=U1(null,e,n,t,r);break e;case 14:e=b1(null,e,n,pn(n.type,t),r);break e}throw Error(ie(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:pn(n,i),md(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:pn(n,i),j1(t,e,n,i,r);case 3:e:{if($x(e),t===null)throw Error(ie(387));n=e.pendingProps,s=e.memoizedState,i=s.element,_x(t,e),nf(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Ya(Error(ie(423)),e),e=z1(t,e,n,r,i);break e}else if(n!==i){i=Ya(Error(ie(424)),e),e=z1(t,e,n,r,i);break e}else for(Hr=$i(e.stateNode.containerInfo.firstChild),Gr=e,ft=!0,gn=null,r=gx(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(qa(),n===i){e=fi(t,e,r);break e}vr(t,e,n,r)}e=e.child}return e;case 5:return yx(e),t===null&&cd(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,sd(n,i)?a=null:s!==null&&sd(n,s)&&(e.flags|=32),Hx(t,e),vr(t,e,a,r),e.child;case 6:return t===null&&cd(e),null;case 13:return Gx(t,e,r);case 4:return Lp(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Xa(e,null,n,r):vr(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:pn(n,i),U1(t,e,n,i,r);case 7:return vr(t,e,e.pendingProps,r),e.child;case 8:return vr(t,e,e.pendingProps.children,r),e.child;case 12:return vr(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,nt(tf,n._currentValue),n._currentValue=a,s!==null)if(wn(s.value,a)){if(s.children===i.children&&!Pr.current){e=fi(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=ni(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?l.next=l:(l.next=f.next,f.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),fd(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(ie(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),fd(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}vr(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Ma(e,r),i=an(i),n=n(i),e.flags|=1,vr(t,e,n,r),e.child;case 14:return n=e.type,i=pn(n,e.pendingProps),i=pn(n.type,i),b1(t,e,n,i,r);case 15:return zx(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:pn(n,i),kc(t,e),e.tag=1,Nr(n)?(t=!0,Jc(e)):t=!1,Ma(e,r),Ux(e,n,i),dd(e,n,i,r),gd(null,e,n,!0,t,r);case 19:return Kx(t,e,r);case 22:return Wx(t,e,r)}throw Error(ie(156,e.tag))};function uE(t,e){return My(t,e)}function $I(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nn(t,e,r,n){return new $I(t,e,r,n)}function Qp(t){return t=t.prototype,!(!t||!t.isReactComponent)}function GI(t){if(typeof t=="function")return Qp(t)?1:0;if(t!=null){if(t=t.$$typeof,t===mp)return 11;if(t===gp)return 14}return 2}function Xi(t,e){var r=t.alternate;return r===null?(r=nn(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Oc(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")Qp(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case xa:return Os(r.children,i,s,e);case pp:a=8,i|=8;break;case V0:return t=nn(12,r,e,i|2),t.elementType=V0,t.lanes=s,t;case B0:return t=nn(13,r,e,i),t.elementType=B0,t.lanes=s,t;case U0:return t=nn(19,r,e,i),t.elementType=U0,t.lanes=s,t;case yy:return th(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case vy:a=10;break e;case _y:a=9;break e;case mp:a=11;break e;case gp:a=14;break e;case Pi:a=16,n=null;break e}throw Error(ie(130,t==null?t:typeof t,""))}return e=nn(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function Os(t,e,r,n){return t=nn(7,t,n,e),t.lanes=r,t}function th(t,e,r,n){return t=nn(22,t,n,e),t.elementType=yy,t.lanes=r,t.stateNode={isHidden:!1},t}function d0(t,e,r){return t=nn(6,t,null,e),t.lanes=r,t}function p0(t,e,r){return e=nn(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function KI(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qh(0),this.expirationTimes=qh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qh(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Yp(t,e,r,n,i,s,a,o,l){return t=new KI(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=nn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fp(s),t}function qI(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ya,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function cE(t){if(!t)return ts;t=t._reactInternals;e:{if(Qs(t)!==t||t.tag!==1)throw Error(ie(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Nr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ie(171))}if(t.tag===1){var r=t.type;if(Nr(r))return cx(t,r,e)}return e}function fE(t,e,r,n,i,s,a,o,l){return t=Yp(r,n,!0,t,i,s,a,o,l),t.context=cE(null),r=t.current,n=xr(),i=qi(r),s=ni(n,i),s.callback=e??null,Gi(r,s,i),t.current.lanes=i,nu(t,i,n),Or(t,n),t}function rh(t,e,r,n){var i=e.current,s=xr(),a=qi(i);return r=cE(r),e.context===null?e.context=r:e.pendingContext=r,e=ni(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Gi(i,e,a),t!==null&&(xn(t,i,a,s),Ic(t,i,a)),a}function hf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function J1(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Jp(t,e){J1(t,e),(t=t.alternate)&&J1(t,e)}function XI(){return null}var hE=typeof reportError=="function"?reportError:function(t){console.error(t)};function Zp(t){this._internalRoot=t}nh.prototype.render=Zp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ie(409));rh(t,e,null,null)};nh.prototype.unmount=Zp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;bs(function(){rh(null,t,null,null)}),e[ui]=null}};function nh(t){this._internalRoot=t}nh.prototype.unstable_scheduleHydration=function(t){if(t){var e=Wy();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Oi.length&&e!==0&&e<Oi[r].priority;r++);Oi.splice(r,0,t),r===0&&$y(t)}};function em(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ih(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Z1(){}function QI(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=hf(a);s.call(c)}}var a=fE(e,n,t,0,null,!1,!1,"",Z1);return t._reactRootContainer=a,t[ui]=a.current,Nl(t.nodeType===8?t.parentNode:t),bs(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=hf(l);o.call(c)}}var l=Yp(t,0,!1,null,null,!1,!1,"",Z1);return t._reactRootContainer=l,t[ui]=l.current,Nl(t.nodeType===8?t.parentNode:t),bs(function(){rh(e,l,r,n)}),l}function sh(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=hf(a);o.call(l)}}rh(e,a,t,i)}else a=QI(r,e,t,i,n);return hf(a)}jy=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=qo(e.pendingLanes);r!==0&&(yp(e,r|1),Or(e,Tt()),!(be&6)&&(Ja=Tt()+500,cs()))}break;case 13:bs(function(){var n=ci(t,1);if(n!==null){var i=xr();xn(n,t,1,i)}}),Jp(t,1)}};xp=function(t){if(t.tag===13){var e=ci(t,134217728);if(e!==null){var r=xr();xn(e,t,134217728,r)}Jp(t,134217728)}};zy=function(t){if(t.tag===13){var e=qi(t),r=ci(t,e);if(r!==null){var n=xr();xn(r,t,e,n)}Jp(t,e)}};Wy=function(){return Ye};Hy=function(t,e){var r=Ye;try{return Ye=t,e()}finally{Ye=r}};X0=function(t,e,r){switch(e){case"input":if(z0(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Xf(n);if(!i)throw Error(ie(90));Ey(n),z0(n,i)}}}break;case"textarea":wy(t,r);break;case"select":e=r.value,e!=null&&Oa(t,!!r.multiple,e,!1)}};Py=Kp;Ny=bs;var YI={usingClientEntryPoint:!1,Events:[su,Sa,Xf,Ry,ky,Kp]},Wo={findFiberByHostInstance:As,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},JI={bundleType:Wo.bundleType,version:Wo.version,rendererPackageName:Wo.rendererPackageName,rendererConfig:Wo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Fy(t),t===null?null:t.stateNode},findFiberByHostInstance:Wo.findFiberByHostInstance||XI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var oc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oc.isDisabled&&oc.supportsFiber)try{$f=oc.inject(JI),On=oc}catch{}}Xr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YI;Xr.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!em(e))throw Error(ie(200));return qI(t,e,null,r)};Xr.createRoot=function(t,e){if(!em(t))throw Error(ie(299));var r=!1,n="",i=hE;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Yp(t,1,!1,null,null,r,!1,n,i),t[ui]=e.current,Nl(t.nodeType===8?t.parentNode:t),new Zp(e)};Xr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ie(188)):(t=Object.keys(t).join(","),Error(ie(268,t)));return t=Fy(e),t=t===null?null:t.stateNode,t};Xr.flushSync=function(t){return bs(t)};Xr.hydrate=function(t,e,r){if(!ih(e))throw Error(ie(200));return sh(null,t,e,!0,r)};Xr.hydrateRoot=function(t,e,r){if(!em(t))throw Error(ie(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=hE;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=fE(e,null,t,1,r??null,i,!1,s,a),t[ui]=e.current,Nl(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new nh(e)};Xr.render=function(t,e,r){if(!ih(e))throw Error(ie(200));return sh(null,t,e,!1,r)};Xr.unmountComponentAtNode=function(t){if(!ih(t))throw Error(ie(40));return t._reactRootContainer?(bs(function(){sh(null,null,t,!1,function(){t._reactRootContainer=null,t[ui]=null})}),!0):!1};Xr.unstable_batchedUpdates=Kp;Xr.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!ih(r))throw Error(ie(200));if(t==null||t._reactInternals===void 0)throw Error(ie(38));return sh(t,e,r,!1,n)};Xr.version="18.3.1-next-f1338f8080-20240426";function dE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(dE)}catch(t){console.error(t)}}dE(),dy.exports=Xr;var ZI=dy.exports,ev=ZI;L0.createRoot=ev.createRoot,L0.hydrateRoot=ev.hydrateRoot;var tv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pE=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},eC=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},mE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,f=s>>2,h=(s&3)<<4|o>>4;let d=(o&15)<<2|c>>6,m=c&63;l||(m=64,a||(d=64)),n.push(r[f],r[h],r[d],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(pE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):eC(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const c=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||c==null||h==null)throw new tC;const d=s<<2|o>>4;if(n.push(d),c!==64){const m=o<<4&240|c>>2;if(n.push(m),h!==64){const _=c<<6&192|h;n.push(_)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class tC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const rC=function(t){const e=pE(t);return mE.encodeByteArray(e,!0)},df=function(t){return rC(t).replace(/\./g,"")},gE=function(t){try{return mE.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iC=()=>nC().__FIREBASE_DEFAULTS__,sC=()=>{if(typeof process>"u"||typeof tv>"u")return;const t=tv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},aC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&gE(t[1]);return e&&JSON.parse(e)},ah=()=>{try{return iC()||sC()||aC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},vE=t=>{var e,r;return(r=(e=ah())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},oC=t=>{const e=vE(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},_E=()=>{var t;return(t=ah())===null||t===void 0?void 0:t.config},yE=t=>{var e;return(e=ah())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[df(JSON.stringify(r)),df(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function cC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gr())}function fC(){var t;const e=(t=ah())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function hC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function dC(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function pC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function mC(){const t=gr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function gC(){return!fC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function vC(){try{return typeof indexedDB=="object"}catch{return!1}}function _C(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yC="FirebaseError";class xi extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=yC,Object.setPrototypeOf(this,xi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ou.prototype.create)}}class ou{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?xC(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new xi(i,o,n)}}function xC(t,e){return t.replace(EC,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const EC=/\{\$([^}]+)}/g;function TC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function pf(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(rv(s)&&rv(a)){if(!pf(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function rv(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function wC(t,e){const r=new SC(t,e);return r.subscribe.bind(r)}class SC{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");AC(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=m0),i.error===void 0&&(i.error=m0),i.complete===void 0&&(i.complete=m0);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function AC(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function m0(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rr(t){return t&&t._delegate?t._delegate:t}class js{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ws="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new lC;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(RC(e))try{this.getOrInitializeService({instanceIdentifier:ws})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=ws){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ws){return this.instances.has(e)}getOptions(e=ws){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:CC(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ws){return this.component?this.component.multipleInstances?e:ws:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function CC(t){return t===ws?void 0:t}function RC(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new IC(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ve;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ve||(Ve={}));const PC={debug:Ve.DEBUG,verbose:Ve.VERBOSE,info:Ve.INFO,warn:Ve.WARN,error:Ve.ERROR,silent:Ve.SILENT},NC=Ve.INFO,OC={[Ve.DEBUG]:"log",[Ve.VERBOSE]:"log",[Ve.INFO]:"info",[Ve.WARN]:"warn",[Ve.ERROR]:"error"},DC=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=OC[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class tm{constructor(e){this.name=e,this._logLevel=NC,this._logHandler=DC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ve))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?PC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ve.DEBUG,...e),this._logHandler(this,Ve.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ve.VERBOSE,...e),this._logHandler(this,Ve.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ve.INFO,...e),this._logHandler(this,Ve.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ve.WARN,...e),this._logHandler(this,Ve.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ve.ERROR,...e),this._logHandler(this,Ve.ERROR,...e)}}const FC=(t,e)=>e.some(r=>t instanceof r);let nv,iv;function LC(){return nv||(nv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function MC(){return iv||(iv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const xE=new WeakMap,Rd=new WeakMap,EE=new WeakMap,g0=new WeakMap,rm=new WeakMap;function VC(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(Qi(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&xE.set(r,t)}).catch(()=>{}),rm.set(e,t),e}function BC(t){if(Rd.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});Rd.set(t,e)}let kd={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Rd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||EE.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Qi(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function UC(t){kd=t(kd)}function bC(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(v0(this),e,...r);return EE.set(n,e.sort?e.sort():[e]),Qi(n)}:MC().includes(t)?function(...e){return t.apply(v0(this),e),Qi(xE.get(this))}:function(...e){return Qi(t.apply(v0(this),e))}}function jC(t){return typeof t=="function"?bC(t):(t instanceof IDBTransaction&&BC(t),FC(t,LC())?new Proxy(t,kd):t)}function Qi(t){if(t instanceof IDBRequest)return VC(t);if(g0.has(t))return g0.get(t);const e=jC(t);return e!==t&&(g0.set(t,e),rm.set(e,t)),e}const v0=t=>rm.get(t);function zC(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=Qi(a);return n&&a.addEventListener("upgradeneeded",l=>{n(Qi(a.result),l.oldVersion,l.newVersion,Qi(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const WC=["get","getKey","getAll","getAllKeys","count"],HC=["put","add","delete","clear"],_0=new Map;function sv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(_0.get(e))return _0.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=HC.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||WC.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return _0.set(e,s),s}UC(t=>({...t,get:(e,r,n)=>sv(e,r)||t.get(e,r,n),has:(e,r)=>!!sv(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $C{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(GC(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function GC(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Pd="@firebase/app",av="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hi=new tm("@firebase/app"),KC="@firebase/app-compat",qC="@firebase/analytics-compat",XC="@firebase/analytics",QC="@firebase/app-check-compat",YC="@firebase/app-check",JC="@firebase/auth",ZC="@firebase/auth-compat",e4="@firebase/database",t4="@firebase/data-connect",r4="@firebase/database-compat",n4="@firebase/functions",i4="@firebase/functions-compat",s4="@firebase/installations",a4="@firebase/installations-compat",o4="@firebase/messaging",l4="@firebase/messaging-compat",u4="@firebase/performance",c4="@firebase/performance-compat",f4="@firebase/remote-config",h4="@firebase/remote-config-compat",d4="@firebase/storage",p4="@firebase/storage-compat",m4="@firebase/firestore",g4="@firebase/vertexai-preview",v4="@firebase/firestore-compat",_4="firebase",y4="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nd="[DEFAULT]",x4={[Pd]:"fire-core",[KC]:"fire-core-compat",[XC]:"fire-analytics",[qC]:"fire-analytics-compat",[YC]:"fire-app-check",[QC]:"fire-app-check-compat",[JC]:"fire-auth",[ZC]:"fire-auth-compat",[e4]:"fire-rtdb",[t4]:"fire-data-connect",[r4]:"fire-rtdb-compat",[n4]:"fire-fn",[i4]:"fire-fn-compat",[s4]:"fire-iid",[a4]:"fire-iid-compat",[o4]:"fire-fcm",[l4]:"fire-fcm-compat",[u4]:"fire-perf",[c4]:"fire-perf-compat",[f4]:"fire-rc",[h4]:"fire-rc-compat",[d4]:"fire-gcs",[p4]:"fire-gcs-compat",[m4]:"fire-fst",[v4]:"fire-fst-compat",[g4]:"fire-vertex","fire-js":"fire-js",[_4]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mf=new Map,E4=new Map,Od=new Map;function ov(t,e){try{t.container.addComponent(e)}catch(r){hi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Za(t){const e=t.name;if(Od.has(e))return hi.debug(`There were multiple attempts to register component ${e}.`),!1;Od.set(e,t);for(const r of mf.values())ov(r,t);for(const r of E4.values())ov(r,t);return!0}function nm(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Zn(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T4={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Yi=new ou("app","Firebase",T4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w4{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new js("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Yi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ho=y4;function TE(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:Nd,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw Yi.create("bad-app-name",{appName:String(i)});if(r||(r=_E()),!r)throw Yi.create("no-options");const s=mf.get(i);if(s){if(pf(r,s.options)&&pf(n,s.config))return s;throw Yi.create("duplicate-app",{appName:i})}const a=new kC(i);for(const l of Od.values())a.addComponent(l);const o=new w4(r,n,a);return mf.set(i,o),o}function wE(t=Nd){const e=mf.get(t);if(!e&&t===Nd&&_E())return TE();if(!e)throw Yi.create("no-app",{appName:t});return e}function Ji(t,e,r){var n;let i=(n=x4[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),hi.warn(o.join(" "));return}Za(new js(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S4="firebase-heartbeat-database",A4=1,bl="firebase-heartbeat-store";let y0=null;function SE(){return y0||(y0=zC(S4,A4,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(bl)}catch(r){console.warn(r)}}}}).catch(t=>{throw Yi.create("idb-open",{originalErrorMessage:t.message})})),y0}async function I4(t){try{const r=(await SE()).transaction(bl),n=await r.objectStore(bl).get(AE(t));return await r.done,n}catch(e){if(e instanceof xi)hi.warn(e.message);else{const r=Yi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});hi.warn(r.message)}}}async function lv(t,e){try{const n=(await SE()).transaction(bl,"readwrite");await n.objectStore(bl).put(e,AE(t)),await n.done}catch(r){if(r instanceof xi)hi.warn(r.message);else{const n=Yi.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});hi.warn(n.message)}}}function AE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C4=1024,R4=30*24*60*60*1e3;class k4{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new N4(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=uv();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=R4}),this._storage.overwrite(this._heartbeatsCache))}catch(n){hi.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=uv(),{heartbeatsToSend:n,unsentEntries:i}=P4(this._heartbeatsCache.heartbeats),s=df(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return hi.warn(r),""}}}function uv(){return new Date().toISOString().substring(0,10)}function P4(t,e=C4){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),cv(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),cv(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class N4{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return vC()?_C().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await I4(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return lv(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return lv(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function cv(t){return df(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O4(t){Za(new js("platform-logger",e=>new $C(e),"PRIVATE")),Za(new js("heartbeat",e=>new k4(e),"PRIVATE")),Ji(Pd,av,t),Ji(Pd,av,"esm2017"),Ji("fire-js","")}O4("");var D4="firebase",F4="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ji(D4,F4,"app");function im(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function IE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const L4=IE,CE=new ou("auth","Firebase",IE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gf=new tm("@firebase/auth");function M4(t,...e){gf.logLevel<=Ve.WARN&&gf.warn(`Auth (${ho}): ${t}`,...e)}function Dc(t,...e){gf.logLevel<=Ve.ERROR&&gf.error(`Auth (${ho}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(t,...e){throw am(t,...e)}function En(t,...e){return am(t,...e)}function sm(t,e,r){const n=Object.assign(Object.assign({},L4()),{[e]:r});return new ou("auth","Firebase",n).create(e,{appName:t.name})}function Ds(t){return sm(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function V4(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&Bn(t,"argument-error"),sm(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function am(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return CE.create(t,...e)}function Re(t,e,...r){if(!t)throw am(e,...r)}function ei(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Dc(e),new Error(e)}function di(t,e){t||ei(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dd(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function B4(){return fv()==="http:"||fv()==="https:"}function fv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U4(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(B4()||dC()||"connection"in navigator)?navigator.onLine:!0}function b4(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(e,r){this.shortDelay=e,this.longDelay=r,di(r>e,"Short delay should be less than long delay!"),this.isMobile=cC()||pC()}get(){return U4()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function om(t,e){di(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ei("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ei("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ei("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j4={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z4=new uu(3e4,6e4);function lm(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function po(t,e,r,n,i={}){return kE(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=lu(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},s);return hC()||(c.referrerPolicy="no-referrer"),RE.fetch()(PE(t,t.config.apiHost,r,o),c)})}async function kE(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},j4),e);try{const i=new H4(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw lc(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw lc(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw lc(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw lc(t,"user-disabled",a);const f=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw sm(t,f,c);Bn(t,f)}}catch(i){if(i instanceof xi)throw i;Bn(t,"network-request-failed",{message:String(i)})}}async function W4(t,e,r,n,i={}){const s=await po(t,e,r,n,i);return"mfaPendingCredential"in s&&Bn(t,"multi-factor-auth-required",{_serverResponse:s}),s}function PE(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?om(t.config,i):`${t.config.apiScheme}://${i}`}class H4{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(En(this.auth,"network-request-failed")),z4.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function lc(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=En(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $4(t,e){return po(t,"POST","/v1/accounts:delete",e)}async function NE(t,e){return po(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function G4(t,e=!1){const r=rr(t),n=await r.getIdToken(e),i=um(n);Re(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:fl(x0(i.auth_time)),issuedAtTime:fl(x0(i.iat)),expirationTime:fl(x0(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function x0(t){return Number(t)*1e3}function um(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Dc("JWT malformed, contained fewer than 3 sections"),null;try{const i=gE(r);return i?JSON.parse(i):(Dc("Failed to decode base64 JWT payload"),null)}catch(i){return Dc("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function hv(t){const e=um(t);return Re(e,"internal-error"),Re(typeof e.exp<"u","internal-error"),Re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jl(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof xi&&K4(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function K4({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=fl(this.lastLoginAt),this.creationTime=fl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vf(t){var e;const r=t.auth,n=await t.getIdToken(),i=await jl(t,NE(r,{idToken:n}));Re(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?OE(s.providerUserInfo):[],o=Q4(t.providerData,a),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),f=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Fd(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(t,h)}async function X4(t){const e=rr(t);await vf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Q4(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function OE(t){return t.map(e=>{var{providerId:r}=e,n=im(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y4(t,e){const r=await kE(t,{},async()=>{const n=lu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=PE(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",RE.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function J4(t,e){return po(t,"POST","/v2/accounts:revokeToken",lm(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Re(e.idToken,"internal-error"),Re(typeof e.idToken<"u","internal-error"),Re(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):hv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Re(e.length!==0,"internal-error");const r=hv(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await Y4(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new Ba;return n&&(Re(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(Re(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Re(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ba,this.toJSON())}_performRefresh(){return ei("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ri(t,e){Re(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ti{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=im(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new q4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Fd(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await jl(this,this.stsTokenManager.getToken(this.auth,e));return Re(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return G4(this,e)}reload(){return X4(this)}_assign(e){this!==e&&(Re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new ti(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await vf(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Zn(this.auth.app))return Promise.reject(Ds(this.auth));const e=await this.getIdToken();return await jl(this,$4(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,l,c,f;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,d=(i=r.email)!==null&&i!==void 0?i:void 0,m=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,_=(a=r.photoURL)!==null&&a!==void 0?a:void 0,g=(o=r.tenantId)!==null&&o!==void 0?o:void 0,w=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,S=(c=r.createdAt)!==null&&c!==void 0?c:void 0,x=(f=r.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:I,emailVerified:V,isAnonymous:b,providerData:H,stsTokenManager:E}=r;Re(I&&E,e,"internal-error");const y=Ba.fromJSON(this.name,E);Re(typeof I=="string",e,"internal-error"),Ri(h,e.name),Ri(d,e.name),Re(typeof V=="boolean",e,"internal-error"),Re(typeof b=="boolean",e,"internal-error"),Ri(m,e.name),Ri(_,e.name),Ri(g,e.name),Ri(w,e.name),Ri(S,e.name),Ri(x,e.name);const T=new ti({uid:I,auth:e,email:d,emailVerified:V,displayName:h,isAnonymous:b,photoURL:_,phoneNumber:m,tenantId:g,stsTokenManager:y,createdAt:S,lastLoginAt:x});return H&&Array.isArray(H)&&(T.providerData=H.map(C=>Object.assign({},C))),w&&(T._redirectEventId=w),T}static async _fromIdTokenResponse(e,r,n=!1){const i=new Ba;i.updateFromServerResponse(r);const s=new ti({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await vf(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];Re(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?OE(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new Ba;o.updateFromIdToken(n);const l=new ti({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Fd(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dv=new Map;function ri(t){di(t instanceof Function,"Expected a class definition");let e=dv.get(t);return e?(di(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,dv.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}DE.type="NONE";const pv=DE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fc(t,e,r){return`firebase:${t}:${e}:${r}`}class Ua{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Fc(this.userKey,i.apiKey,s),this.fullPersistenceKey=Fc("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ti._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Ua(ri(pv),e,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||ri(pv);const a=Fc(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const f=await c._get(a);if(f){const h=ti._fromJSON(e,f);c!==s&&(o=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Ua(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new Ua(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mv(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(VE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(FE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(UE(e))return"Blackberry";if(bE(e))return"Webos";if(LE(e))return"Safari";if((e.includes("chrome/")||ME(e))&&!e.includes("edge/"))return"Chrome";if(BE(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function FE(t=gr()){return/firefox\//i.test(t)}function LE(t=gr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ME(t=gr()){return/crios\//i.test(t)}function VE(t=gr()){return/iemobile/i.test(t)}function BE(t=gr()){return/android/i.test(t)}function UE(t=gr()){return/blackberry/i.test(t)}function bE(t=gr()){return/webos/i.test(t)}function cm(t=gr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Z4(t=gr()){var e;return cm(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function eR(){return mC()&&document.documentMode===10}function jE(t=gr()){return cm(t)||BE(t)||bE(t)||UE(t)||/windows phone/i.test(t)||VE(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zE(t,e=[]){let r;switch(t){case"Browser":r=mv(gr());break;case"Worker":r=`${mv(gr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${ho}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tR{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rR(t,e={}){return po(t,"GET","/v2/passwordPolicy",lm(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nR=6;class iR{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:nR,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sR{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gv(this),this.idTokenSubscription=new gv(this),this.beforeStateQueue=new tR(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=CE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=ri(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Ua.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await NE(this,{idToken:e}),n=await ti._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Zn(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await vf(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=b4()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Zn(this.app))return Promise.reject(Ds(this));const r=e?rr(e):null;return r&&Re(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Zn(this.app)?Promise.reject(Ds(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Zn(this.app)?Promise.reject(Ds(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ri(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await rR(this),r=new iR(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ou("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await J4(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&ri(e)||this._popupRedirectResolver;Re(r,this,"argument-error"),this.redirectPersistenceManager=await Ua.create(this,[ri(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Re(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=zE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&M4(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function oh(t){return rr(t)}class gv{constructor(e){this.auth=e,this.observer=null,this.addObserver=wC(r=>this.observer=r)}get next(){return Re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function aR(t){fm=t}function oR(t){return fm.loadJS(t)}function lR(){return fm.gapiScript}function uR(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cR(t,e){const r=nm(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(pf(s,e??{}))return i;Bn(i,"already-initialized")}return r.initialize({options:e})}function fR(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(ri);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function hR(t,e,r){const n=oh(t);Re(n._canInitEmulator,n,"emulator-config-failed"),Re(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=WE(e),{host:a,port:o}=dR(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),pR()}function WE(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function dR(t){const e=WE(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:vv(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:vv(a)}}}function vv(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function pR(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return ei("not implemented")}_getIdTokenResponse(e){return ei("not implemented")}_linkToIdToken(e,r){return ei("not implemented")}_getReauthenticationResolver(e){return ei("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ba(t,e){return W4(t,"POST","/v1/accounts:signInWithIdp",lm(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mR="http://localhost";class zs extends HE{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new zs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Bn("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=im(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new zs(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return ba(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,ba(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,ba(e,r)}buildRequest(){const e={requestUri:mR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=lu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu extends hm{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi extends cu{constructor(){super("facebook.com")}static credential(e){return zs._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fi.credential(e.oauthAccessToken)}catch{return null}}}Fi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Fi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn extends cu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return zs._fromParams({providerId:Xn.PROVIDER_ID,signInMethod:Xn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Xn.credentialFromTaggedObject(e)}static credentialFromError(e){return Xn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Xn.credential(r,n)}catch{return null}}}Xn.GOOGLE_SIGN_IN_METHOD="google.com";Xn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li extends cu{constructor(){super("github.com")}static credential(e){return zs._fromParams({providerId:Li.PROVIDER_ID,signInMethod:Li.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Li.credentialFromTaggedObject(e)}static credentialFromError(e){return Li.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Li.credential(e.oauthAccessToken)}catch{return null}}}Li.GITHUB_SIGN_IN_METHOD="github.com";Li.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi extends cu{constructor(){super("twitter.com")}static credential(e,r){return zs._fromParams({providerId:Mi.PROVIDER_ID,signInMethod:Mi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Mi.credentialFromTaggedObject(e)}static credentialFromError(e){return Mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Mi.credential(r,n)}catch{return null}}}Mi.TWITTER_SIGN_IN_METHOD="twitter.com";Mi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await ti._fromIdTokenResponse(e,n,i),a=_v(n);return new eo({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=_v(n);return new eo({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function _v(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f extends xi{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,_f.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new _f(e,r,n,i)}}function $E(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?_f._fromErrorAndOperation(t,s,e,n):s})}async function gR(t,e,r=!1){const n=await jl(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return eo._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vR(t,e,r=!1){const{auth:n}=t;if(Zn(n.app))return Promise.reject(Ds(n));const i="reauthenticate";try{const s=await jl(t,$E(n,i,e,t),r);Re(s.idToken,n,"internal-error");const a=um(s.idToken);Re(a,n,"internal-error");const{sub:o}=a;return Re(t.uid===o,n,"user-mismatch"),eo._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Bn(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _R(t,e,r=!1){if(Zn(t.app))return Promise.reject(Ds(t));const n="signIn",i=await $E(t,n,e),s=await eo._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}function yR(t,e,r,n){return rr(t).onIdTokenChanged(e,r,n)}function xR(t,e,r){return rr(t).beforeAuthStateChanged(e,r)}function ER(t,e,r,n){return rr(t).onAuthStateChanged(e,r,n)}function TR(t){return rr(t).signOut()}const yf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GE{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(yf,"1"),this.storage.removeItem(yf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wR=1e3,SR=10;class KE extends GE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);eR()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,SR):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},wR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}KE.type="LOCAL";const AR=KE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE extends GE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}qE.type="SESSION";const XE=qE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IR(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new lh(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await IR(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}lh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dm(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=dm("",20);i.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(h){const d=h;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(d.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(){return window}function RR(t){Fn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QE(){return typeof Fn().WorkerGlobalScope<"u"&&typeof Fn().importScripts=="function"}async function kR(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function PR(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function NR(){return QE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YE="firebaseLocalStorageDb",OR=1,xf="firebaseLocalStorage",JE="fbase_key";class fu{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function uh(t,e){return t.transaction([xf],e?"readwrite":"readonly").objectStore(xf)}function DR(){const t=indexedDB.deleteDatabase(YE);return new fu(t).toPromise()}function Ld(){const t=indexedDB.open(YE,OR);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(xf,{keyPath:JE})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(xf)?e(n):(n.close(),await DR(),e(await Ld()))})})}async function yv(t,e,r){const n=uh(t,!0).put({[JE]:e,value:r});return new fu(n).toPromise()}async function FR(t,e){const r=uh(t,!1).get(e),n=await new fu(r).toPromise();return n===void 0?null:n.value}function xv(t,e){const r=uh(t,!0).delete(e);return new fu(r).toPromise()}const LR=800,MR=3;class ZE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ld(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>MR)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return QE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=lh._getInstance(NR()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await kR(),!this.activeServiceWorker)return;this.sender=new CR(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||PR()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ld();return await yv(e,yf,"1"),await xv(e,yf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>yv(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>FR(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>xv(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=uh(i,!1).getAll();return new fu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),LR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ZE.type="LOCAL";const VR=ZE;new uu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eT(t,e){return e?ri(e):(Re(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm extends HE{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ba(e,this._buildIdpRequest())}_linkToIdToken(e,r){return ba(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return ba(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function BR(t){return _R(t.auth,new pm(t),t.bypassAuthState)}function UR(t){const{auth:e,user:r}=t;return Re(r,e,"internal-error"),vR(r,new pm(t),t.bypassAuthState)}async function bR(t){const{auth:e,user:r}=t;return Re(r,e,"internal-error"),gR(r,new pm(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return BR;case"linkViaPopup":case"linkViaRedirect":return bR;case"reauthViaPopup":case"reauthViaRedirect":return UR;default:Bn(this.auth,"internal-error")}}resolve(e){di(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){di(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jR=new uu(2e3,1e4);async function zR(t,e,r){if(Zn(t.app))return Promise.reject(En(t,"operation-not-supported-in-this-environment"));const n=oh(t);V4(t,e,hm);const i=eT(n,r);return new Rs(n,"signInViaPopup",e,i).executeNotNull()}class Rs extends tT{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Rs.currentPopupAction&&Rs.currentPopupAction.cancel(),Rs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Re(e,this.auth,"internal-error"),e}async onExecution(){di(this.filter.length===1,"Popup operations only handle one event");const e=dm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(En(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(En(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Rs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(En(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,jR.get())};e()}}Rs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WR="pendingRedirect",Lc=new Map;class HR extends tT{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Lc.get(this.auth._key());if(!e){try{const n=await $R(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Lc.set(this.auth._key(),e)}return this.bypassAuthState||Lc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function $R(t,e){const r=qR(e),n=KR(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function GR(t,e){Lc.set(t._key(),e)}function KR(t){return ri(t._redirectPersistence)}function qR(t){return Fc(WR,t.config.apiKey,t.name)}async function XR(t,e,r=!1){if(Zn(t.app))return Promise.reject(Ds(t));const n=oh(t),i=eT(n,e),a=await new HR(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR=10*60*1e3;class YR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!JR(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!rT(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(En(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=QR&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ev(e))}saveEventToCache(e){this.cachedEventUids.add(Ev(e)),this.lastProcessedEventTime=Date.now()}}function Ev(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function rT({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function JR(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return rT(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZR(t,e={}){return po(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ek=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,tk=/^https?/;async function rk(t){if(t.config.emulator)return;const{authorizedDomains:e}=await ZR(t);for(const r of e)try{if(nk(r))return}catch{}Bn(t,"unauthorized-domain")}function nk(t){const e=Dd(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!tk.test(r))return!1;if(ek.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ik=new uu(3e4,6e4);function Tv(){const t=Fn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function sk(t){return new Promise((e,r)=>{var n,i,s;function a(){Tv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Tv(),r(En(t,"network-request-failed"))},timeout:ik.get()})}if(!((i=(n=Fn().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Fn().gapi)===null||s===void 0)&&s.load)a();else{const o=uR("iframefcb");return Fn()[o]=()=>{gapi.load?a():r(En(t,"network-request-failed"))},oR(`${lR()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw Mc=null,e})}let Mc=null;function ak(t){return Mc=Mc||sk(t),Mc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ok=new uu(5e3,15e3),lk="__/auth/iframe",uk="emulator/auth/iframe",ck={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function hk(t){const e=t.config;Re(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?om(e,uk):`https://${t.config.authDomain}/${lk}`,n={apiKey:e.apiKey,appName:t.name,v:ho},i=fk.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${lu(n).slice(1)}`}async function dk(t){const e=await ak(t),r=Fn().gapi;return Re(r,t,"internal-error"),e.open({where:document.body,url:hk(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ck,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=En(t,"network-request-failed"),o=Fn().setTimeout(()=>{s(a)},ok.get());function l(){Fn().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},mk=500,gk=600,vk="_blank",_k="http://localhost";class wv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function yk(t,e,r,n=mk,i=gk){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},pk),{width:n.toString(),height:i.toString(),top:s,left:a}),c=gr().toLowerCase();r&&(o=ME(c)?vk:r),FE(c)&&(e=e||_k,l.scrollbars="yes");const f=Object.entries(l).reduce((d,[m,_])=>`${d}${m}=${_},`,"");if(Z4(c)&&o!=="_self")return xk(e||"",o),new wv(null);const h=window.open(e||"",o,f);Re(h,t,"popup-blocked");try{h.focus()}catch{}return new wv(h)}function xk(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ek="__/auth/handler",Tk="emulator/auth/handler",wk=encodeURIComponent("fac");async function Sv(t,e,r,n,i,s){Re(t.config.authDomain,t,"auth-domain-config-required"),Re(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:ho,eventId:i};if(e instanceof hm){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",TC(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,h]of Object.entries({}))a[f]=h}if(e instanceof cu){const f=e.getScopes().filter(h=>h!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const l=await t._getAppCheckToken(),c=l?`#${wk}=${encodeURIComponent(l)}`:"";return`${Sk(t)}?${lu(o).slice(1)}${c}`}function Sk({config:t}){return t.emulator?om(t,Tk):`https://${t.authDomain}/${Ek}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E0="webStorageSupport";class Ak{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=XE,this._completeRedirectFn=XR,this._overrideRedirectResult=GR}async _openPopup(e,r,n,i){var s;di((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await Sv(e,r,n,Dd(),i);return yk(e,a,dm())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await Sv(e,r,n,Dd(),i);return RR(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(di(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await dk(e),n=new YR(e);return r.register("authEvent",i=>(Re(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(E0,{type:E0},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[E0];a!==void 0&&r(!!a),Bn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=rk(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return jE()||LE()||cm()}}const Ik=Ak;var Av="@firebase/auth",Iv="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rk(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function kk(t){Za(new js("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Re(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:zE(t)},c=new sR(n,i,s,l);return fR(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Za(new js("auth-internal",e=>{const r=oh(e.getProvider("auth").getImmediate());return(n=>new Ck(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ji(Av,Iv,Rk(t)),Ji(Av,Iv,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pk=5*60,Nk=yE("authIdTokenMaxAge")||Pk;let Cv=null;const Ok=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>Nk)return;const i=r==null?void 0:r.token;Cv!==i&&(Cv=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Dk(t=wE()){const e=nm(t,"auth");if(e.isInitialized())return e.getImmediate();const r=cR(t,{popupRedirectResolver:Ik,persistence:[VR,AR,XE]}),n=yE("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=Ok(s.toString());xR(r,a,()=>a(r.currentUser)),yR(r,o=>a(o))}}const i=vE("auth");return i&&hR(r,`http://${i}`),r}function Fk(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}aR({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=En("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",Fk().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});kk("Browser");var Rv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Fs,nT;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,y){function T(){}T.prototype=y.prototype,E.D=y.prototype,E.prototype=new T,E.prototype.constructor=E,E.C=function(C,N,L){for(var P=Array(arguments.length-2),Ie=2;Ie<arguments.length;Ie++)P[Ie-2]=arguments[Ie];return y.prototype[N].apply(C,P)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,y,T){T||(T=0);var C=Array(16);if(typeof y=="string")for(var N=0;16>N;++N)C[N]=y.charCodeAt(T++)|y.charCodeAt(T++)<<8|y.charCodeAt(T++)<<16|y.charCodeAt(T++)<<24;else for(N=0;16>N;++N)C[N]=y[T++]|y[T++]<<8|y[T++]<<16|y[T++]<<24;y=E.g[0],T=E.g[1],N=E.g[2];var L=E.g[3],P=y+(L^T&(N^L))+C[0]+3614090360&4294967295;y=T+(P<<7&4294967295|P>>>25),P=L+(N^y&(T^N))+C[1]+3905402710&4294967295,L=y+(P<<12&4294967295|P>>>20),P=N+(T^L&(y^T))+C[2]+606105819&4294967295,N=L+(P<<17&4294967295|P>>>15),P=T+(y^N&(L^y))+C[3]+3250441966&4294967295,T=N+(P<<22&4294967295|P>>>10),P=y+(L^T&(N^L))+C[4]+4118548399&4294967295,y=T+(P<<7&4294967295|P>>>25),P=L+(N^y&(T^N))+C[5]+1200080426&4294967295,L=y+(P<<12&4294967295|P>>>20),P=N+(T^L&(y^T))+C[6]+2821735955&4294967295,N=L+(P<<17&4294967295|P>>>15),P=T+(y^N&(L^y))+C[7]+4249261313&4294967295,T=N+(P<<22&4294967295|P>>>10),P=y+(L^T&(N^L))+C[8]+1770035416&4294967295,y=T+(P<<7&4294967295|P>>>25),P=L+(N^y&(T^N))+C[9]+2336552879&4294967295,L=y+(P<<12&4294967295|P>>>20),P=N+(T^L&(y^T))+C[10]+4294925233&4294967295,N=L+(P<<17&4294967295|P>>>15),P=T+(y^N&(L^y))+C[11]+2304563134&4294967295,T=N+(P<<22&4294967295|P>>>10),P=y+(L^T&(N^L))+C[12]+1804603682&4294967295,y=T+(P<<7&4294967295|P>>>25),P=L+(N^y&(T^N))+C[13]+4254626195&4294967295,L=y+(P<<12&4294967295|P>>>20),P=N+(T^L&(y^T))+C[14]+2792965006&4294967295,N=L+(P<<17&4294967295|P>>>15),P=T+(y^N&(L^y))+C[15]+1236535329&4294967295,T=N+(P<<22&4294967295|P>>>10),P=y+(N^L&(T^N))+C[1]+4129170786&4294967295,y=T+(P<<5&4294967295|P>>>27),P=L+(T^N&(y^T))+C[6]+3225465664&4294967295,L=y+(P<<9&4294967295|P>>>23),P=N+(y^T&(L^y))+C[11]+643717713&4294967295,N=L+(P<<14&4294967295|P>>>18),P=T+(L^y&(N^L))+C[0]+3921069994&4294967295,T=N+(P<<20&4294967295|P>>>12),P=y+(N^L&(T^N))+C[5]+3593408605&4294967295,y=T+(P<<5&4294967295|P>>>27),P=L+(T^N&(y^T))+C[10]+38016083&4294967295,L=y+(P<<9&4294967295|P>>>23),P=N+(y^T&(L^y))+C[15]+3634488961&4294967295,N=L+(P<<14&4294967295|P>>>18),P=T+(L^y&(N^L))+C[4]+3889429448&4294967295,T=N+(P<<20&4294967295|P>>>12),P=y+(N^L&(T^N))+C[9]+568446438&4294967295,y=T+(P<<5&4294967295|P>>>27),P=L+(T^N&(y^T))+C[14]+3275163606&4294967295,L=y+(P<<9&4294967295|P>>>23),P=N+(y^T&(L^y))+C[3]+4107603335&4294967295,N=L+(P<<14&4294967295|P>>>18),P=T+(L^y&(N^L))+C[8]+1163531501&4294967295,T=N+(P<<20&4294967295|P>>>12),P=y+(N^L&(T^N))+C[13]+2850285829&4294967295,y=T+(P<<5&4294967295|P>>>27),P=L+(T^N&(y^T))+C[2]+4243563512&4294967295,L=y+(P<<9&4294967295|P>>>23),P=N+(y^T&(L^y))+C[7]+1735328473&4294967295,N=L+(P<<14&4294967295|P>>>18),P=T+(L^y&(N^L))+C[12]+2368359562&4294967295,T=N+(P<<20&4294967295|P>>>12),P=y+(T^N^L)+C[5]+4294588738&4294967295,y=T+(P<<4&4294967295|P>>>28),P=L+(y^T^N)+C[8]+2272392833&4294967295,L=y+(P<<11&4294967295|P>>>21),P=N+(L^y^T)+C[11]+1839030562&4294967295,N=L+(P<<16&4294967295|P>>>16),P=T+(N^L^y)+C[14]+4259657740&4294967295,T=N+(P<<23&4294967295|P>>>9),P=y+(T^N^L)+C[1]+2763975236&4294967295,y=T+(P<<4&4294967295|P>>>28),P=L+(y^T^N)+C[4]+1272893353&4294967295,L=y+(P<<11&4294967295|P>>>21),P=N+(L^y^T)+C[7]+4139469664&4294967295,N=L+(P<<16&4294967295|P>>>16),P=T+(N^L^y)+C[10]+3200236656&4294967295,T=N+(P<<23&4294967295|P>>>9),P=y+(T^N^L)+C[13]+681279174&4294967295,y=T+(P<<4&4294967295|P>>>28),P=L+(y^T^N)+C[0]+3936430074&4294967295,L=y+(P<<11&4294967295|P>>>21),P=N+(L^y^T)+C[3]+3572445317&4294967295,N=L+(P<<16&4294967295|P>>>16),P=T+(N^L^y)+C[6]+76029189&4294967295,T=N+(P<<23&4294967295|P>>>9),P=y+(T^N^L)+C[9]+3654602809&4294967295,y=T+(P<<4&4294967295|P>>>28),P=L+(y^T^N)+C[12]+3873151461&4294967295,L=y+(P<<11&4294967295|P>>>21),P=N+(L^y^T)+C[15]+530742520&4294967295,N=L+(P<<16&4294967295|P>>>16),P=T+(N^L^y)+C[2]+3299628645&4294967295,T=N+(P<<23&4294967295|P>>>9),P=y+(N^(T|~L))+C[0]+4096336452&4294967295,y=T+(P<<6&4294967295|P>>>26),P=L+(T^(y|~N))+C[7]+1126891415&4294967295,L=y+(P<<10&4294967295|P>>>22),P=N+(y^(L|~T))+C[14]+2878612391&4294967295,N=L+(P<<15&4294967295|P>>>17),P=T+(L^(N|~y))+C[5]+4237533241&4294967295,T=N+(P<<21&4294967295|P>>>11),P=y+(N^(T|~L))+C[12]+1700485571&4294967295,y=T+(P<<6&4294967295|P>>>26),P=L+(T^(y|~N))+C[3]+2399980690&4294967295,L=y+(P<<10&4294967295|P>>>22),P=N+(y^(L|~T))+C[10]+4293915773&4294967295,N=L+(P<<15&4294967295|P>>>17),P=T+(L^(N|~y))+C[1]+2240044497&4294967295,T=N+(P<<21&4294967295|P>>>11),P=y+(N^(T|~L))+C[8]+1873313359&4294967295,y=T+(P<<6&4294967295|P>>>26),P=L+(T^(y|~N))+C[15]+4264355552&4294967295,L=y+(P<<10&4294967295|P>>>22),P=N+(y^(L|~T))+C[6]+2734768916&4294967295,N=L+(P<<15&4294967295|P>>>17),P=T+(L^(N|~y))+C[13]+1309151649&4294967295,T=N+(P<<21&4294967295|P>>>11),P=y+(N^(T|~L))+C[4]+4149444226&4294967295,y=T+(P<<6&4294967295|P>>>26),P=L+(T^(y|~N))+C[11]+3174756917&4294967295,L=y+(P<<10&4294967295|P>>>22),P=N+(y^(L|~T))+C[2]+718787259&4294967295,N=L+(P<<15&4294967295|P>>>17),P=T+(L^(N|~y))+C[9]+3951481745&4294967295,E.g[0]=E.g[0]+y&4294967295,E.g[1]=E.g[1]+(N+(P<<21&4294967295|P>>>11))&4294967295,E.g[2]=E.g[2]+N&4294967295,E.g[3]=E.g[3]+L&4294967295}n.prototype.u=function(E,y){y===void 0&&(y=E.length);for(var T=y-this.blockSize,C=this.B,N=this.h,L=0;L<y;){if(N==0)for(;L<=T;)i(this,E,L),L+=this.blockSize;if(typeof E=="string"){for(;L<y;)if(C[N++]=E.charCodeAt(L++),N==this.blockSize){i(this,C),N=0;break}}else for(;L<y;)if(C[N++]=E[L++],N==this.blockSize){i(this,C),N=0;break}}this.h=N,this.o+=y},n.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var y=1;y<E.length-8;++y)E[y]=0;var T=8*this.o;for(y=E.length-8;y<E.length;++y)E[y]=T&255,T/=256;for(this.u(E),E=Array(16),y=T=0;4>y;++y)for(var C=0;32>C;C+=8)E[T++]=this.g[y]>>>C&255;return E};function s(E,y){var T=o;return Object.prototype.hasOwnProperty.call(T,E)?T[E]:T[E]=y(E)}function a(E,y){this.h=y;for(var T=[],C=!0,N=E.length-1;0<=N;N--){var L=E[N]|0;C&&L==y||(T[N]=L,C=!1)}this.g=T}var o={};function l(E){return-128<=E&&128>E?s(E,function(y){return new a([y|0],0>y?-1:0)}):new a([E|0],0>E?-1:0)}function c(E){if(isNaN(E)||!isFinite(E))return h;if(0>E)return w(c(-E));for(var y=[],T=1,C=0;E>=T;C++)y[C]=E/T|0,T*=4294967296;return new a(y,0)}function f(E,y){if(E.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(E.charAt(0)=="-")return w(f(E.substring(1),y));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=c(Math.pow(y,8)),C=h,N=0;N<E.length;N+=8){var L=Math.min(8,E.length-N),P=parseInt(E.substring(N,N+L),y);8>L?(L=c(Math.pow(y,L)),C=C.j(L).add(c(P))):(C=C.j(T),C=C.add(c(P)))}return C}var h=l(0),d=l(1),m=l(16777216);t=a.prototype,t.m=function(){if(g(this))return-w(this).m();for(var E=0,y=1,T=0;T<this.g.length;T++){var C=this.i(T);E+=(0<=C?C:4294967296+C)*y,y*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(_(this))return"0";if(g(this))return"-"+w(this).toString(E);for(var y=c(Math.pow(E,6)),T=this,C="";;){var N=V(T,y).g;T=S(T,N.j(y));var L=((0<T.g.length?T.g[0]:T.h)>>>0).toString(E);if(T=N,_(T))return L+C;for(;6>L.length;)L="0"+L;C=L+C}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function _(E){if(E.h!=0)return!1;for(var y=0;y<E.g.length;y++)if(E.g[y]!=0)return!1;return!0}function g(E){return E.h==-1}t.l=function(E){return E=S(this,E),g(E)?-1:_(E)?0:1};function w(E){for(var y=E.g.length,T=[],C=0;C<y;C++)T[C]=~E.g[C];return new a(T,~E.h).add(d)}t.abs=function(){return g(this)?w(this):this},t.add=function(E){for(var y=Math.max(this.g.length,E.g.length),T=[],C=0,N=0;N<=y;N++){var L=C+(this.i(N)&65535)+(E.i(N)&65535),P=(L>>>16)+(this.i(N)>>>16)+(E.i(N)>>>16);C=P>>>16,L&=65535,P&=65535,T[N]=P<<16|L}return new a(T,T[T.length-1]&-2147483648?-1:0)};function S(E,y){return E.add(w(y))}t.j=function(E){if(_(this)||_(E))return h;if(g(this))return g(E)?w(this).j(w(E)):w(w(this).j(E));if(g(E))return w(this.j(w(E)));if(0>this.l(m)&&0>E.l(m))return c(this.m()*E.m());for(var y=this.g.length+E.g.length,T=[],C=0;C<2*y;C++)T[C]=0;for(C=0;C<this.g.length;C++)for(var N=0;N<E.g.length;N++){var L=this.i(C)>>>16,P=this.i(C)&65535,Ie=E.i(N)>>>16,Ae=E.i(N)&65535;T[2*C+2*N]+=P*Ae,x(T,2*C+2*N),T[2*C+2*N+1]+=L*Ae,x(T,2*C+2*N+1),T[2*C+2*N+1]+=P*Ie,x(T,2*C+2*N+1),T[2*C+2*N+2]+=L*Ie,x(T,2*C+2*N+2)}for(C=0;C<y;C++)T[C]=T[2*C+1]<<16|T[2*C];for(C=y;C<2*y;C++)T[C]=0;return new a(T,0)};function x(E,y){for(;(E[y]&65535)!=E[y];)E[y+1]+=E[y]>>>16,E[y]&=65535,y++}function I(E,y){this.g=E,this.h=y}function V(E,y){if(_(y))throw Error("division by zero");if(_(E))return new I(h,h);if(g(E))return y=V(w(E),y),new I(w(y.g),w(y.h));if(g(y))return y=V(E,w(y)),new I(w(y.g),y.h);if(30<E.g.length){if(g(E)||g(y))throw Error("slowDivide_ only works with positive integers.");for(var T=d,C=y;0>=C.l(E);)T=b(T),C=b(C);var N=H(T,1),L=H(C,1);for(C=H(C,2),T=H(T,2);!_(C);){var P=L.add(C);0>=P.l(E)&&(N=N.add(T),L=P),C=H(C,1),T=H(T,1)}return y=S(E,N.j(y)),new I(N,y)}for(N=h;0<=E.l(y);){for(T=Math.max(1,Math.floor(E.m()/y.m())),C=Math.ceil(Math.log(T)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),L=c(T),P=L.j(y);g(P)||0<P.l(E);)T-=C,L=c(T),P=L.j(y);_(L)&&(L=d),N=N.add(L),E=S(E,P)}return new I(N,E)}t.A=function(E){return V(this,E).h},t.and=function(E){for(var y=Math.max(this.g.length,E.g.length),T=[],C=0;C<y;C++)T[C]=this.i(C)&E.i(C);return new a(T,this.h&E.h)},t.or=function(E){for(var y=Math.max(this.g.length,E.g.length),T=[],C=0;C<y;C++)T[C]=this.i(C)|E.i(C);return new a(T,this.h|E.h)},t.xor=function(E){for(var y=Math.max(this.g.length,E.g.length),T=[],C=0;C<y;C++)T[C]=this.i(C)^E.i(C);return new a(T,this.h^E.h)};function b(E){for(var y=E.g.length+1,T=[],C=0;C<y;C++)T[C]=E.i(C)<<1|E.i(C-1)>>>31;return new a(T,E.h)}function H(E,y){var T=y>>5;y%=32;for(var C=E.g.length-T,N=[],L=0;L<C;L++)N[L]=0<y?E.i(L+T)>>>y|E.i(L+T+1)<<32-y:E.i(L+T);return new a(N,E.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,nT=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=f,Fs=a}).apply(typeof Rv<"u"?Rv:typeof self<"u"?self:typeof window<"u"?window:{});var uc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var iT,Qo,sT,Vc,Md,aT,oT,lT;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,p,v){return u==Array.prototype||u==Object.prototype||(u[p]=v.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof uc=="object"&&uc];for(var p=0;p<u.length;++p){var v=u[p];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var n=r(this);function i(u,p){if(p)e:{var v=n;u=u.split(".");for(var R=0;R<u.length-1;R++){var z=u[R];if(!(z in v))break e;v=v[z]}u=u[u.length-1],R=v[u],p=p(R),p!=R&&p!=null&&e(v,u,{configurable:!0,writable:!0,value:p})}}function s(u,p){u instanceof String&&(u+="");var v=0,R=!1,z={next:function(){if(!R&&v<u.length){var Q=v++;return{value:p(Q,u[Q]),done:!1}}return R=!0,{done:!0,value:void 0}}};return z[Symbol.iterator]=function(){return z},z}i("Array.prototype.values",function(u){return u||function(){return s(this,function(p,v){return v})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(u){var p=typeof u;return p=p!="object"?p:u?Array.isArray(u)?"array":p:"null",p=="array"||p=="object"&&typeof u.length=="number"}function c(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function f(u,p,v){return u.call.apply(u.bind,arguments)}function h(u,p,v){if(!u)throw Error();if(2<arguments.length){var R=Array.prototype.slice.call(arguments,2);return function(){var z=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(z,R),u.apply(p,z)}}return function(){return u.apply(p,arguments)}}function d(u,p,v){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:h,d.apply(null,arguments)}function m(u,p){var v=Array.prototype.slice.call(arguments,1);return function(){var R=v.slice();return R.push.apply(R,arguments),u.apply(this,R)}}function _(u,p){function v(){}v.prototype=p.prototype,u.aa=p.prototype,u.prototype=new v,u.prototype.constructor=u,u.Qb=function(R,z,Q){for(var fe=Array(arguments.length-2),rt=2;rt<arguments.length;rt++)fe[rt-2]=arguments[rt];return p.prototype[z].apply(R,fe)}}function g(u){const p=u.length;if(0<p){const v=Array(p);for(let R=0;R<p;R++)v[R]=u[R];return v}return[]}function w(u,p){for(let v=1;v<arguments.length;v++){const R=arguments[v];if(l(R)){const z=u.length||0,Q=R.length||0;u.length=z+Q;for(let fe=0;fe<Q;fe++)u[z+fe]=R[fe]}else u.push(R)}}class S{constructor(p,v){this.i=p,this.j=v,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function x(u){return/^[\s\xa0]*$/.test(u)}function I(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function V(u){return V[" "](u),u}V[" "]=function(){};var b=I().indexOf("Gecko")!=-1&&!(I().toLowerCase().indexOf("webkit")!=-1&&I().indexOf("Edge")==-1)&&!(I().indexOf("Trident")!=-1||I().indexOf("MSIE")!=-1)&&I().indexOf("Edge")==-1;function H(u,p,v){for(const R in u)p.call(v,u[R],R,u)}function E(u,p){for(const v in u)p.call(void 0,u[v],v,u)}function y(u){const p={};for(const v in u)p[v]=u[v];return p}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(u,p){let v,R;for(let z=1;z<arguments.length;z++){R=arguments[z];for(v in R)u[v]=R[v];for(let Q=0;Q<T.length;Q++)v=T[Q],Object.prototype.hasOwnProperty.call(R,v)&&(u[v]=R[v])}}function N(u){var p=1;u=u.split(":");const v=[];for(;0<p&&u.length;)v.push(u.shift()),p--;return u.length&&v.push(u.join(":")),v}function L(u){o.setTimeout(()=>{throw u},0)}function P(){var u=ye;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class Ie{constructor(){this.h=this.g=null}add(p,v){const R=Ae.get();R.set(p,v),this.h?this.h.next=R:this.g=R,this.h=R}}var Ae=new S(()=>new ht,u=>u.reset());class ht{constructor(){this.next=this.g=this.h=null}set(p,v){this.h=p,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let $e,ue=!1,ye=new Ie,we=()=>{const u=o.Promise.resolve(void 0);$e=()=>{u.then(De)}};var De=()=>{for(var u;u=P();){try{u.h.call(u.g)}catch(v){L(v)}var p=Ae;p.j(u),100>p.h&&(p.h++,u.next=p.g,p.g=u)}ue=!1};function B(){this.s=this.s,this.C=this.C}B.prototype.s=!1,B.prototype.ma=function(){this.s||(this.s=!0,this.N())},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function W(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}W.prototype.h=function(){this.defaultPrevented=!0};var j=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const v=()=>{};o.addEventListener("test",v,p),o.removeEventListener("test",v,p)}catch{}return u}();function U(u,p){if(W.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var v=this.type=u.type,R=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget){if(b){e:{try{V(p.nodeName);var z=!0;break e}catch{}z=!1}z||(p=null)}}else v=="mouseover"?p=u.fromElement:v=="mouseout"&&(p=u.toElement);this.relatedTarget=p,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:Z[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&U.aa.h.call(this)}}_(U,W);var Z={2:"touch",3:"pen",4:"mouse"};U.prototype.h=function(){U.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var me="closure_listenable_"+(1e6*Math.random()|0),Te=0;function xe(u,p,v,R,z){this.listener=u,this.proxy=null,this.src=p,this.type=v,this.capture=!!R,this.ha=z,this.key=++Te,this.da=this.fa=!1}function he(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function je(u){this.src=u,this.g={},this.h=0}je.prototype.add=function(u,p,v,R,z){var Q=u.toString();u=this.g[Q],u||(u=this.g[Q]=[],this.h++);var fe=Pt(u,p,R,z);return-1<fe?(p=u[fe],v||(p.fa=!1)):(p=new xe(p,this.src,Q,!!R,z),p.fa=v,u.push(p)),p};function Fe(u,p){var v=p.type;if(v in u.g){var R=u.g[v],z=Array.prototype.indexOf.call(R,p,void 0),Q;(Q=0<=z)&&Array.prototype.splice.call(R,z,1),Q&&(he(p),u.g[v].length==0&&(delete u.g[v],u.h--))}}function Pt(u,p,v,R){for(var z=0;z<u.length;++z){var Q=u[z];if(!Q.da&&Q.listener==p&&Q.capture==!!v&&Q.ha==R)return z}return-1}var Be="closure_lm_"+(1e6*Math.random()|0),Mr={};function it(u,p,v,R,z){if(Array.isArray(p)){for(var Q=0;Q<p.length;Q++)it(u,p[Q],v,R,z);return null}return v=ps(v),u&&u[me]?u.K(p,v,c(R)?!!R.capture:!1,z):_e(u,p,v,!1,R,z)}function _e(u,p,v,R,z,Q){if(!p)throw Error("Invalid event type");var fe=c(z)?!!z.capture:!!z,rt=ds(u);if(rt||(u[Be]=rt=new je(u)),v=rt.add(p,v,R,fe,Q),v.proxy)return v;if(R=Ar(),v.proxy=R,R.src=u,R.listener=v,u.addEventListener)j||(z=fe),z===void 0&&(z=!1),u.addEventListener(p.toString(),R,z);else if(u.attachEvent)u.attachEvent(jn(p.toString()),R);else if(u.addListener&&u.removeListener)u.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return v}function Ar(){function u(v){return p.call(u.src,u.listener,v)}const p=Cu;return u}function Yr(u,p,v,R,z){if(Array.isArray(p))for(var Q=0;Q<p.length;Q++)Yr(u,p[Q],v,R,z);else R=c(R)?!!R.capture:!!R,v=ps(v),u&&u[me]?(u=u.i,p=String(p).toString(),p in u.g&&(Q=u.g[p],v=Pt(Q,v,R,z),-1<v&&(he(Q[v]),Array.prototype.splice.call(Q,v,1),Q.length==0&&(delete u.g[p],u.h--)))):u&&(u=ds(u))&&(p=u.g[p.toString()],u=-1,p&&(u=Pt(p,v,R,z)),(v=-1<u?p[u]:null)&&un(v))}function un(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[me])Fe(p.i,u);else{var v=u.type,R=u.proxy;p.removeEventListener?p.removeEventListener(v,R,u.capture):p.detachEvent?p.detachEvent(jn(v),R):p.addListener&&p.removeListener&&p.removeListener(R),(v=ds(p))?(Fe(v,u),v.h==0&&(v.src=null,p[Be]=null)):he(u)}}}function jn(u){return u in Mr?Mr[u]:Mr[u]="on"+u}function Cu(u,p){if(u.da)u=!0;else{p=new U(p,this);var v=u.listener,R=u.ha||u.src;u.fa&&un(u),u=v.call(R,p)}return u}function ds(u){return u=u[Be],u instanceof je?u:null}var Ir="__closure_events_fn_"+(1e9*Math.random()>>>0);function ps(u){return typeof u=="function"?u:(u[Ir]||(u[Ir]=function(p){return u.handleEvent(p)}),u[Ir])}function wt(){B.call(this),this.i=new je(this),this.M=this,this.F=null}_(wt,B),wt.prototype[me]=!0,wt.prototype.removeEventListener=function(u,p,v,R){Yr(this,u,p,v,R)};function Nt(u,p){var v,R=u.F;if(R)for(v=[];R;R=R.F)v.push(R);if(u=u.M,R=p.type||p,typeof p=="string")p=new W(p,u);else if(p instanceof W)p.target=p.target||u;else{var z=p;p=new W(R,u),C(p,z)}if(z=!0,v)for(var Q=v.length-1;0<=Q;Q--){var fe=p.g=v[Q];z=Jr(fe,R,!0,p)&&z}if(fe=p.g=u,z=Jr(fe,R,!0,p)&&z,z=Jr(fe,R,!1,p)&&z,v)for(Q=0;Q<v.length;Q++)fe=p.g=v[Q],z=Jr(fe,R,!1,p)&&z}wt.prototype.N=function(){if(wt.aa.N.call(this),this.i){var u=this.i,p;for(p in u.g){for(var v=u.g[p],R=0;R<v.length;R++)he(v[R]);delete u.g[p],u.h--}}this.F=null},wt.prototype.K=function(u,p,v,R){return this.i.add(String(u),p,!1,v,R)},wt.prototype.L=function(u,p,v,R){return this.i.add(String(u),p,!0,v,R)};function Jr(u,p,v,R){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();for(var z=!0,Q=0;Q<p.length;++Q){var fe=p[Q];if(fe&&!fe.da&&fe.capture==v){var rt=fe.listener,Ht=fe.ha||fe.src;fe.fa&&Fe(u.i,fe),z=rt.call(Ht,R)!==!1&&z}}return z&&!R.defaultPrevented}function Ru(u,p,v){if(typeof u=="function")v&&(u=d(u,v));else if(u&&typeof u.handleEvent=="function")u=d(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:o.setTimeout(u,p||0)}function wo(u){u.g=Ru(()=>{u.g=null,u.i&&(u.i=!1,wo(u))},u.l);const p=u.h;u.h=null,u.m.apply(null,p)}class ku extends B{constructor(p,v){super(),this.m=p,this.l=v,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:wo(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ti(u){B.call(this),this.h=u,this.g={}}_(Ti,B);var So=[];function Ao(u){H(u.g,function(p,v){this.g.hasOwnProperty(v)&&un(p)},u),u.g={}}Ti.prototype.N=function(){Ti.aa.N.call(this),Ao(this)},Ti.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ia=o.JSON.stringify,Dh=o.JSON.parse,Fh=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function sa(){}sa.prototype.h=null;function Io(u){return u.h||(u.h=u.i())}function Co(){}var ms={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ro(){W.call(this,"d")}_(Ro,W);function wi(){W.call(this,"c")}_(wi,W);var zn={},Pu=null;function aa(){return Pu=Pu||new wt}zn.La="serverreachability";function Nu(u){W.call(this,zn.La,u)}_(Nu,W);function gs(u){const p=aa();Nt(p,new Nu(p))}zn.STAT_EVENT="statevent";function Ou(u,p){W.call(this,zn.STAT_EVENT,u),this.stat=p}_(Ou,W);function Wt(u){const p=aa();Nt(p,new Ou(p,u))}zn.Ma="timingevent";function Du(u,p){W.call(this,zn.Ma,u),this.size=p}_(Du,W);function Wn(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},p)}function vs(){this.g=!0}vs.prototype.xa=function(){this.g=!1};function Lh(u,p,v,R,z,Q){u.info(function(){if(u.g)if(Q)for(var fe="",rt=Q.split("&"),Ht=0;Ht<rt.length;Ht++){var ze=rt[Ht].split("=");if(1<ze.length){var sr=ze[0];ze=ze[1];var ar=sr.split("_");fe=2<=ar.length&&ar[1]=="type"?fe+(sr+"="+ze+"&"):fe+(sr+"=redacted&")}}else fe=null;else fe=Q;return"XMLHTTP REQ ("+R+") [attempt "+z+"]: "+p+`
`+v+`
`+fe})}function Mh(u,p,v,R,z,Q,fe){u.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+z+"]: "+p+`
`+v+`
`+Q+" "+fe})}function A(u,p,v,R){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+k(u,v)+(R?" "+R:"")})}function D(u,p){u.info(function(){return"TIMEOUT: "+p})}vs.prototype.info=function(){};function k(u,p){if(!u.g)return p;if(!p)return null;try{var v=JSON.parse(p);if(v){for(u=0;u<v.length;u++)if(Array.isArray(v[u])){var R=v[u];if(!(2>R.length)){var z=R[1];if(Array.isArray(z)&&!(1>z.length)){var Q=z[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(var fe=1;fe<z.length;fe++)z[fe]=""}}}}return ia(v)}catch{return p}}var O={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},F={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},M;function G(){}_(G,sa),G.prototype.g=function(){return new XMLHttpRequest},G.prototype.i=function(){return{}},M=new G;function Y(u,p,v,R){this.j=u,this.i=p,this.l=v,this.R=R||1,this.U=new Ti(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new K}function K(){this.i=null,this.g="",this.h=!1}var q={},X={};function ne(u,p,v){u.L=1,u.v=Mu($n(p)),u.m=v,u.P=!0,ce(u,null)}function ce(u,p){u.F=Date.now(),de(u),u.A=$n(u.v);var v=u.A,R=u.R;Array.isArray(R)||(R=[String(R)]),Sg(v.i,"t",R),u.C=0,v=u.j.J,u.h=new K,u.g=zg(u.j,v?p:null,!u.m),0<u.O&&(u.M=new ku(d(u.Y,u,u.g),u.O)),p=u.U,v=u.g,R=u.ca;var z="readystatechange";Array.isArray(z)||(z&&(So[0]=z.toString()),z=So);for(var Q=0;Q<z.length;Q++){var fe=it(v,z[Q],R||p.handleEvent,!1,p.h||p);if(!fe)break;p.g[fe.key]=fe}p=u.H?y(u.H):{},u.m?(u.u||(u.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,p)):(u.u="GET",u.g.ea(u.A,u.u,null,p)),gs(),Lh(u.i,u.u,u.A,u.l,u.R,u.m)}Y.prototype.ca=function(u){u=u.target;const p=this.M;p&&Gn(u)==3?p.j():this.Y(u)},Y.prototype.Y=function(u){try{if(u==this.g)e:{const ar=Gn(this.g);var p=this.g.Ba();const ca=this.g.Z();if(!(3>ar)&&(ar!=3||this.g&&(this.h.h||this.g.oa()||Ng(this.g)))){this.J||ar!=4||p==7||(p==8||0>=ca?gs(3):gs(2)),tt(this);var v=this.g.Z();this.X=v;t:if(pe(this)){var R=Ng(this.g);u="";var z=R.length,Q=Gn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ct(this),Ke(this);var fe="";break t}this.h.i=new o.TextDecoder}for(p=0;p<z;p++)this.h.h=!0,u+=this.h.i.decode(R[p],{stream:!(Q&&p==z-1)});R.length=0,this.h.g+=u,this.C=0,fe=this.h.g}else fe=this.g.oa();if(this.o=v==200,Mh(this.i,this.u,this.A,this.l,this.R,ar,v),this.o){if(this.T&&!this.K){t:{if(this.g){var rt,Ht=this.g;if((rt=Ht.g?Ht.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!x(rt)){var ze=rt;break t}}ze=null}if(v=ze)A(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Hn(this,v);else{this.o=!1,this.s=3,Wt(12),ct(this),Ke(this);break e}}if(this.P){v=!0;let cn;for(;!this.J&&this.C<fe.length;)if(cn=ae(this,fe),cn==X){ar==4&&(this.s=4,Wt(14),v=!1),A(this.i,this.l,null,"[Incomplete Response]");break}else if(cn==q){this.s=4,Wt(15),A(this.i,this.l,fe,"[Invalid Chunk]"),v=!1;break}else A(this.i,this.l,cn,null),Hn(this,cn);if(pe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ar!=4||fe.length!=0||this.h.h||(this.s=1,Wt(16),v=!1),this.o=this.o&&v,!v)A(this.i,this.l,fe,"[Invalid Chunked Response]"),ct(this),Ke(this);else if(0<fe.length&&!this.W){this.W=!0;var sr=this.j;sr.g==this&&sr.ba&&!sr.M&&(sr.j.info("Great, no buffering proxy detected. Bytes received: "+fe.length),jh(sr),sr.M=!0,Wt(11))}}else A(this.i,this.l,fe,null),Hn(this,fe);ar==4&&ct(this),this.o&&!this.J&&(ar==4?Bg(this.j,this):(this.o=!1,de(this)))}else SS(this.g),v==400&&0<fe.indexOf("Unknown SID")?(this.s=3,Wt(12)):(this.s=0,Wt(13)),ct(this),Ke(this)}}}catch{}finally{}};function pe(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function ae(u,p){var v=u.C,R=p.indexOf(`
`,v);return R==-1?X:(v=Number(p.substring(v,R)),isNaN(v)?q:(R+=1,R+v>p.length?X:(p=p.slice(R,R+v),u.C=R+v,p)))}Y.prototype.cancel=function(){this.J=!0,ct(this)};function de(u){u.S=Date.now()+u.I,Ce(u,u.I)}function Ce(u,p){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Wn(d(u.ba,u),p)}function tt(u){u.B&&(o.clearTimeout(u.B),u.B=null)}Y.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(D(this.i,this.A),this.L!=2&&(gs(),Wt(17)),ct(this),this.s=2,Ke(this)):Ce(this,this.S-u)};function Ke(u){u.j.G==0||u.J||Bg(u.j,u)}function ct(u){tt(u);var p=u.M;p&&typeof p.ma=="function"&&p.ma(),u.M=null,Ao(u.U),u.g&&(p=u.g,u.g=null,p.abort(),p.ma())}function Hn(u,p){try{var v=u.j;if(v.G!=0&&(v.g==u||Vr(v.h,u))){if(!u.K&&Vr(v.h,u)&&v.G==3){try{var R=v.Da.g.parse(p)}catch{R=null}if(Array.isArray(R)&&R.length==3){var z=R;if(z[0]==0){e:if(!v.u){if(v.g)if(v.g.F+3e3<u.F)zu(v),bu(v);else break e;bh(v),Wt(18)}}else v.za=z[1],0<v.za-v.T&&37500>z[2]&&v.F&&v.v==0&&!v.C&&(v.C=Wn(d(v.Za,v),6e3));if(1>=oa(v.h)&&v.ca){try{v.ca()}catch{}v.ca=void 0}}else xs(v,11)}else if((u.K||v.g==u)&&zu(v),!x(p))for(z=v.Da.g.parse(p),p=0;p<z.length;p++){let ze=z[p];if(v.T=ze[0],ze=ze[1],v.G==2)if(ze[0]=="c"){v.K=ze[1],v.ia=ze[2];const sr=ze[3];sr!=null&&(v.la=sr,v.j.info("VER="+v.la));const ar=ze[4];ar!=null&&(v.Aa=ar,v.j.info("SVER="+v.Aa));const ca=ze[5];ca!=null&&typeof ca=="number"&&0<ca&&(R=1.5*ca,v.L=R,v.j.info("backChannelRequestTimeoutMs_="+R)),R=v;const cn=u.g;if(cn){const Hu=cn.g?cn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Hu){var Q=R.h;Q.g||Hu.indexOf("spdy")==-1&&Hu.indexOf("quic")==-1&&Hu.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(Vh(Q,Q.h),Q.h=null))}if(R.D){const zh=cn.g?cn.g.getResponseHeader("X-HTTP-Session-Id"):null;zh&&(R.ya=zh,st(R.I,R.D,zh))}}v.G=3,v.l&&v.l.ua(),v.ba&&(v.R=Date.now()-u.F,v.j.info("Handshake RTT: "+v.R+"ms")),R=v;var fe=u;if(R.qa=jg(R,R.J?R.ia:null,R.W),fe.K){gg(R.h,fe);var rt=fe,Ht=R.L;Ht&&(rt.I=Ht),rt.B&&(tt(rt),de(rt)),R.g=fe}else Mg(R);0<v.i.length&&ju(v)}else ze[0]!="stop"&&ze[0]!="close"||xs(v,7);else v.G==3&&(ze[0]=="stop"||ze[0]=="close"?ze[0]=="stop"?xs(v,7):Uh(v):ze[0]!="noop"&&v.l&&v.l.ta(ze),v.v=0)}}gs(4)}catch{}}var _s=class{constructor(u,p){this.g=u,this.map=p}};function Si(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function An(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function oa(u){return u.h?1:u.g?u.g.size:0}function Vr(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function Vh(u,p){u.g?u.g.add(p):u.h=p}function gg(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}Si.prototype.cancel=function(){if(this.i=vg(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function vg(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let p=u.i;for(const v of u.g.values())p=p.concat(v.D);return p}return g(u.i)}function uS(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var p=[],v=u.length,R=0;R<v;R++)p.push(u[R]);return p}p=[],v=0;for(R in u)p[v++]=u[R];return p}function cS(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var p=[];u=u.length;for(var v=0;v<u;v++)p.push(v);return p}p=[],v=0;for(const R in u)p[v++]=R;return p}}}function _g(u,p){if(u.forEach&&typeof u.forEach=="function")u.forEach(p,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,p,void 0);else for(var v=cS(u),R=uS(u),z=R.length,Q=0;Q<z;Q++)p.call(void 0,R[Q],v&&v[Q],u)}var yg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fS(u,p){if(u){u=u.split("&");for(var v=0;v<u.length;v++){var R=u[v].indexOf("="),z=null;if(0<=R){var Q=u[v].substring(0,R);z=u[v].substring(R+1)}else Q=u[v];p(Q,z?decodeURIComponent(z.replace(/\+/g," ")):"")}}}function ys(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof ys){this.h=u.h,Fu(this,u.j),this.o=u.o,this.g=u.g,Lu(this,u.s),this.l=u.l;var p=u.i,v=new No;v.i=p.i,p.g&&(v.g=new Map(p.g),v.h=p.h),xg(this,v),this.m=u.m}else u&&(p=String(u).match(yg))?(this.h=!1,Fu(this,p[1]||"",!0),this.o=ko(p[2]||""),this.g=ko(p[3]||"",!0),Lu(this,p[4]),this.l=ko(p[5]||"",!0),xg(this,p[6]||"",!0),this.m=ko(p[7]||"")):(this.h=!1,this.i=new No(null,this.h))}ys.prototype.toString=function(){var u=[],p=this.j;p&&u.push(Po(p,Eg,!0),":");var v=this.g;return(v||p=="file")&&(u.push("//"),(p=this.o)&&u.push(Po(p,Eg,!0),"@"),u.push(encodeURIComponent(String(v)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.s,v!=null&&u.push(":",String(v))),(v=this.l)&&(this.g&&v.charAt(0)!="/"&&u.push("/"),u.push(Po(v,v.charAt(0)=="/"?pS:dS,!0))),(v=this.i.toString())&&u.push("?",v),(v=this.m)&&u.push("#",Po(v,gS)),u.join("")};function $n(u){return new ys(u)}function Fu(u,p,v){u.j=v?ko(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function Lu(u,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);u.s=p}else u.s=null}function xg(u,p,v){p instanceof No?(u.i=p,vS(u.i,u.h)):(v||(p=Po(p,mS)),u.i=new No(p,u.h))}function st(u,p,v){u.i.set(p,v)}function Mu(u){return st(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function ko(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Po(u,p,v){return typeof u=="string"?(u=encodeURI(u).replace(p,hS),v&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function hS(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Eg=/[#\/\?@]/g,dS=/[#\?:]/g,pS=/[#\?]/g,mS=/[#\?@]/g,gS=/#/g;function No(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function Ai(u){u.g||(u.g=new Map,u.h=0,u.i&&fS(u.i,function(p,v){u.add(decodeURIComponent(p.replace(/\+/g," ")),v)}))}t=No.prototype,t.add=function(u,p){Ai(this),this.i=null,u=la(this,u);var v=this.g.get(u);return v||this.g.set(u,v=[]),v.push(p),this.h+=1,this};function Tg(u,p){Ai(u),p=la(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function wg(u,p){return Ai(u),p=la(u,p),u.g.has(p)}t.forEach=function(u,p){Ai(this),this.g.forEach(function(v,R){v.forEach(function(z){u.call(p,z,R,this)},this)},this)},t.na=function(){Ai(this);const u=Array.from(this.g.values()),p=Array.from(this.g.keys()),v=[];for(let R=0;R<p.length;R++){const z=u[R];for(let Q=0;Q<z.length;Q++)v.push(p[R])}return v},t.V=function(u){Ai(this);let p=[];if(typeof u=="string")wg(this,u)&&(p=p.concat(this.g.get(la(this,u))));else{u=Array.from(this.g.values());for(let v=0;v<u.length;v++)p=p.concat(u[v])}return p},t.set=function(u,p){return Ai(this),this.i=null,u=la(this,u),wg(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},t.get=function(u,p){return u?(u=this.V(u),0<u.length?String(u[0]):p):p};function Sg(u,p,v){Tg(u,p),0<v.length&&(u.i=null,u.g.set(la(u,p),g(v)),u.h+=v.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],p=Array.from(this.g.keys());for(var v=0;v<p.length;v++){var R=p[v];const Q=encodeURIComponent(String(R)),fe=this.V(R);for(R=0;R<fe.length;R++){var z=Q;fe[R]!==""&&(z+="="+encodeURIComponent(String(fe[R]))),u.push(z)}}return this.i=u.join("&")};function la(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function vS(u,p){p&&!u.j&&(Ai(u),u.i=null,u.g.forEach(function(v,R){var z=R.toLowerCase();R!=z&&(Tg(this,R),Sg(this,z,v))},u)),u.j=p}function _S(u,p){const v=new vs;if(o.Image){const R=new Image;R.onload=m(Ii,v,"TestLoadImage: loaded",!0,p,R),R.onerror=m(Ii,v,"TestLoadImage: error",!1,p,R),R.onabort=m(Ii,v,"TestLoadImage: abort",!1,p,R),R.ontimeout=m(Ii,v,"TestLoadImage: timeout",!1,p,R),o.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=u}else p(!1)}function yS(u,p){const v=new vs,R=new AbortController,z=setTimeout(()=>{R.abort(),Ii(v,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:R.signal}).then(Q=>{clearTimeout(z),Q.ok?Ii(v,"TestPingServer: ok",!0,p):Ii(v,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(z),Ii(v,"TestPingServer: error",!1,p)})}function Ii(u,p,v,R,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),R(v)}catch{}}function xS(){this.g=new Fh}function ES(u,p,v){const R=v||"";try{_g(u,function(z,Q){let fe=z;c(z)&&(fe=ia(z)),p.push(R+Q+"="+encodeURIComponent(fe))})}catch(z){throw p.push(R+"type="+encodeURIComponent("_badmap")),z}}function Vu(u){this.l=u.Ub||null,this.j=u.eb||!1}_(Vu,sa),Vu.prototype.g=function(){return new Bu(this.l,this.j)},Vu.prototype.i=function(u){return function(){return u}}({});function Bu(u,p){wt.call(this),this.D=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(Bu,wt),t=Bu.prototype,t.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=p,this.readyState=1,Do(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(p.body=u),(this.D||o).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Oo(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Do(this)),this.g&&(this.readyState=3,Do(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ag(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ag(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?Oo(this):Do(this),this.readyState==3&&Ag(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,Oo(this))},t.Qa=function(u){this.g&&(this.response=u,Oo(this))},t.ga=function(){this.g&&Oo(this)};function Oo(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Do(u)}t.setRequestHeader=function(u,p){this.u.append(u,p)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],p=this.h.entries();for(var v=p.next();!v.done;)v=v.value,u.push(v[0]+": "+v[1]),v=p.next();return u.join(`\r
`)};function Do(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Bu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Ig(u){let p="";return H(u,function(v,R){p+=R,p+=":",p+=v,p+=`\r
`}),p}function Bh(u,p,v){e:{for(R in v){var R=!1;break e}R=!0}R||(v=Ig(v),typeof u=="string"?v!=null&&encodeURIComponent(String(v)):st(u,p,v))}function vt(u){wt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(vt,wt);var TS=/^https?$/i,wS=["POST","PUT"];t=vt.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,p,v,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():M.g(),this.v=this.o?Io(this.o):Io(M),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(Q){Cg(this,Q);return}if(u=v||"",v=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var z in R)v.set(z,R[z]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const Q of R.keys())v.set(Q,R.get(Q));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(v.keys()).find(Q=>Q.toLowerCase()=="content-type"),z=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(wS,p,void 0))||R||z||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,fe]of v)this.g.setRequestHeader(Q,fe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Pg(this),this.u=!0,this.g.send(u),this.u=!1}catch(Q){Cg(this,Q)}};function Cg(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.m=5,Rg(u),Uu(u)}function Rg(u){u.A||(u.A=!0,Nt(u,"complete"),Nt(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Nt(this,"complete"),Nt(this,"abort"),Uu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Uu(this,!0)),vt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?kg(this):this.bb())},t.bb=function(){kg(this)};function kg(u){if(u.h&&typeof a<"u"&&(!u.v[1]||Gn(u)!=4||u.Z()!=2)){if(u.u&&Gn(u)==4)Ru(u.Ea,0,u);else if(Nt(u,"readystatechange"),Gn(u)==4){u.h=!1;try{const fe=u.Z();e:switch(fe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var v;if(!(v=p)){var R;if(R=fe===0){var z=String(u.D).match(yg)[1]||null;!z&&o.self&&o.self.location&&(z=o.self.location.protocol.slice(0,-1)),R=!TS.test(z?z.toLowerCase():"")}v=R}if(v)Nt(u,"complete"),Nt(u,"success");else{u.m=6;try{var Q=2<Gn(u)?u.g.statusText:""}catch{Q=""}u.l=Q+" ["+u.Z()+"]",Rg(u)}}finally{Uu(u)}}}}function Uu(u,p){if(u.g){Pg(u);const v=u.g,R=u.v[0]?()=>{}:null;u.g=null,u.v=null,p||Nt(u,"ready");try{v.onreadystatechange=R}catch{}}}function Pg(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function Gn(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<Gn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),Dh(p)}};function Ng(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function SS(u){const p={};u=(u.g&&2<=Gn(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<u.length;R++){if(x(u[R]))continue;var v=N(u[R]);const z=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();const Q=p[z]||[];p[z]=Q,Q.push(v)}E(p,function(R){return R.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fo(u,p,v){return v&&v.internalChannelParams&&v.internalChannelParams[u]||p}function Og(u){this.Aa=0,this.i=[],this.j=new vs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Fo("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Fo("baseRetryDelayMs",5e3,u),this.cb=Fo("retryDelaySeedMs",1e4,u),this.Wa=Fo("forwardChannelMaxRetries",2,u),this.wa=Fo("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Si(u&&u.concurrentRequestLimit),this.Da=new xS,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Og.prototype,t.la=8,t.G=1,t.connect=function(u,p,v,R){Wt(0),this.W=u,this.H=p||{},v&&R!==void 0&&(this.H.OSID=v,this.H.OAID=R),this.F=this.X,this.I=jg(this,null,this.W),ju(this)};function Uh(u){if(Dg(u),u.G==3){var p=u.U++,v=$n(u.I);if(st(v,"SID",u.K),st(v,"RID",p),st(v,"TYPE","terminate"),Lo(u,v),p=new Y(u,u.j,p),p.L=2,p.v=Mu($n(v)),v=!1,o.navigator&&o.navigator.sendBeacon)try{v=o.navigator.sendBeacon(p.v.toString(),"")}catch{}!v&&o.Image&&(new Image().src=p.v,v=!0),v||(p.g=zg(p.j,null),p.g.ea(p.v)),p.F=Date.now(),de(p)}bg(u)}function bu(u){u.g&&(jh(u),u.g.cancel(),u.g=null)}function Dg(u){bu(u),u.u&&(o.clearTimeout(u.u),u.u=null),zu(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function ju(u){if(!An(u.h)&&!u.s){u.s=!0;var p=u.Ga;$e||we(),ue||($e(),ue=!0),ye.add(p,u),u.B=0}}function AS(u,p){return oa(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=p.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Wn(d(u.Ga,u,p),Ug(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const z=new Y(this,this.j,u);let Q=this.o;if(this.S&&(Q?(Q=y(Q),C(Q,this.S)):Q=this.S),this.m!==null||this.O||(z.H=Q,Q=null),this.P)e:{for(var p=0,v=0;v<this.i.length;v++){t:{var R=this.i[v];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(p+=R,4096<p){p=v;break e}if(p===4096||v===this.i.length-1){p=v+1;break e}}p=1e3}else p=1e3;p=Lg(this,z,p),v=$n(this.I),st(v,"RID",u),st(v,"CVER",22),this.D&&st(v,"X-HTTP-Session-Id",this.D),Lo(this,v),Q&&(this.O?p="headers="+encodeURIComponent(String(Ig(Q)))+"&"+p:this.m&&Bh(v,this.m,Q)),Vh(this.h,z),this.Ua&&st(v,"TYPE","init"),this.P?(st(v,"$req",p),st(v,"SID","null"),z.T=!0,ne(z,v,null)):ne(z,v,p),this.G=2}}else this.G==3&&(u?Fg(this,u):this.i.length==0||An(this.h)||Fg(this))};function Fg(u,p){var v;p?v=p.l:v=u.U++;const R=$n(u.I);st(R,"SID",u.K),st(R,"RID",v),st(R,"AID",u.T),Lo(u,R),u.m&&u.o&&Bh(R,u.m,u.o),v=new Y(u,u.j,v,u.B+1),u.m===null&&(v.H=u.o),p&&(u.i=p.D.concat(u.i)),p=Lg(u,v,1e3),v.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Vh(u.h,v),ne(v,R,p)}function Lo(u,p){u.H&&H(u.H,function(v,R){st(p,R,v)}),u.l&&_g({},function(v,R){st(p,R,v)})}function Lg(u,p,v){v=Math.min(u.i.length,v);var R=u.l?d(u.l.Na,u.l,u):null;e:{var z=u.i;let Q=-1;for(;;){const fe=["count="+v];Q==-1?0<v?(Q=z[0].g,fe.push("ofs="+Q)):Q=0:fe.push("ofs="+Q);let rt=!0;for(let Ht=0;Ht<v;Ht++){let ze=z[Ht].g;const sr=z[Ht].map;if(ze-=Q,0>ze)Q=Math.max(0,z[Ht].g-100),rt=!1;else try{ES(sr,fe,"req"+ze+"_")}catch{R&&R(sr)}}if(rt){R=fe.join("&");break e}}}return u=u.i.splice(0,v),p.D=u,R}function Mg(u){if(!u.g&&!u.u){u.Y=1;var p=u.Fa;$e||we(),ue||($e(),ue=!0),ye.add(p,u),u.v=0}}function bh(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Wn(d(u.Fa,u),Ug(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,Vg(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Wn(d(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Wt(10),bu(this),Vg(this))};function jh(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function Vg(u){u.g=new Y(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var p=$n(u.qa);st(p,"RID","rpc"),st(p,"SID",u.K),st(p,"AID",u.T),st(p,"CI",u.F?"0":"1"),!u.F&&u.ja&&st(p,"TO",u.ja),st(p,"TYPE","xmlhttp"),Lo(u,p),u.m&&u.o&&Bh(p,u.m,u.o),u.L&&(u.g.I=u.L);var v=u.g;u=u.ia,v.L=1,v.v=Mu($n(p)),v.m=null,v.P=!0,ce(v,u)}t.Za=function(){this.C!=null&&(this.C=null,bu(this),bh(this),Wt(19))};function zu(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function Bg(u,p){var v=null;if(u.g==p){zu(u),jh(u),u.g=null;var R=2}else if(Vr(u.h,p))v=p.D,gg(u.h,p),R=1;else return;if(u.G!=0){if(p.o)if(R==1){v=p.m?p.m.length:0,p=Date.now()-p.F;var z=u.B;R=aa(),Nt(R,new Du(R,v)),ju(u)}else Mg(u);else if(z=p.s,z==3||z==0&&0<p.X||!(R==1&&AS(u,p)||R==2&&bh(u)))switch(v&&0<v.length&&(p=u.h,p.i=p.i.concat(v)),z){case 1:xs(u,5);break;case 4:xs(u,10);break;case 3:xs(u,6);break;default:xs(u,2)}}}function Ug(u,p){let v=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(v*=2),v*p}function xs(u,p){if(u.j.info("Error code "+p),p==2){var v=d(u.fb,u),R=u.Xa;const z=!R;R=new ys(R||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Fu(R,"https"),Mu(R),z?_S(R.toString(),v):yS(R.toString(),v)}else Wt(2);u.G=0,u.l&&u.l.sa(p),bg(u),Dg(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Wt(2)):(this.j.info("Failed to ping google.com"),Wt(1))};function bg(u){if(u.G=0,u.ka=[],u.l){const p=vg(u.h);(p.length!=0||u.i.length!=0)&&(w(u.ka,p),w(u.ka,u.i),u.h.i.length=0,g(u.i),u.i.length=0),u.l.ra()}}function jg(u,p,v){var R=v instanceof ys?$n(v):new ys(v);if(R.g!="")p&&(R.g=p+"."+R.g),Lu(R,R.s);else{var z=o.location;R=z.protocol,p=p?p+"."+z.hostname:z.hostname,z=+z.port;var Q=new ys(null);R&&Fu(Q,R),p&&(Q.g=p),z&&Lu(Q,z),v&&(Q.l=v),R=Q}return v=u.D,p=u.ya,v&&p&&st(R,v,p),st(R,"VER",u.la),Lo(u,R),R}function zg(u,p,v){if(p&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Ca&&!u.pa?new vt(new Vu({eb:v})):new vt(u.pa),p.Ha(u.J),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Wg(){}t=Wg.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Wu(){}Wu.prototype.g=function(u,p){return new Br(u,p)};function Br(u,p){wt.call(this),this.g=new Og(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(u?u["X-WebChannel-Client-Profile"]=p.va:u={"X-WebChannel-Client-Profile":p.va}),this.g.S=u,(u=p&&p.Sb)&&!x(u)&&(this.g.m=u),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!x(p)&&(this.g.D=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new ua(this)}_(Br,wt),Br.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Br.prototype.close=function(){Uh(this.g)},Br.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var v={};v.__data__=u,u=v}else this.u&&(v={},v.__data__=ia(u),u=v);p.i.push(new _s(p.Ya++,u)),p.G==3&&ju(p)},Br.prototype.N=function(){this.g.l=null,delete this.j,Uh(this.g),delete this.g,Br.aa.N.call(this)};function Hg(u){Ro.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(const v in p){u=v;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}_(Hg,Ro);function $g(){wi.call(this),this.status=1}_($g,wi);function ua(u){this.g=u}_(ua,Wg),ua.prototype.ua=function(){Nt(this.g,"a")},ua.prototype.ta=function(u){Nt(this.g,new Hg(u))},ua.prototype.sa=function(u){Nt(this.g,new $g)},ua.prototype.ra=function(){Nt(this.g,"b")},Wu.prototype.createWebChannel=Wu.prototype.g,Br.prototype.send=Br.prototype.o,Br.prototype.open=Br.prototype.m,Br.prototype.close=Br.prototype.close,lT=function(){return new Wu},oT=function(){return aa()},aT=zn,Md={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},O.NO_ERROR=0,O.TIMEOUT=8,O.HTTP_ERROR=6,Vc=O,F.COMPLETE="complete",sT=F,Co.EventType=ms,ms.OPEN="a",ms.CLOSE="b",ms.ERROR="c",ms.MESSAGE="d",wt.prototype.listen=wt.prototype.K,Qo=Co,vt.prototype.listenOnce=vt.prototype.L,vt.prototype.getLastError=vt.prototype.Ka,vt.prototype.getLastErrorCode=vt.prototype.Ba,vt.prototype.getStatus=vt.prototype.Z,vt.prototype.getResponseJson=vt.prototype.Oa,vt.prototype.getResponseText=vt.prototype.oa,vt.prototype.send=vt.prototype.ea,vt.prototype.setWithCredentials=vt.prototype.Ha,iT=vt}).apply(typeof uc<"u"?uc:typeof self<"u"?self:typeof window<"u"?window:{});const kv="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}cr.UNAUTHENTICATED=new cr(null),cr.GOOGLE_CREDENTIALS=new cr("google-credentials-uid"),cr.FIRST_PARTY=new cr("first-party-uid"),cr.MOCK_USER=new cr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mo="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ws=new tm("@firebase/firestore");function Ho(){return Ws.logLevel}function Ee(t,...e){if(Ws.logLevel<=Ve.DEBUG){const r=e.map(mm);Ws.debug(`Firestore (${mo}): ${t}`,...r)}}function pi(t,...e){if(Ws.logLevel<=Ve.ERROR){const r=e.map(mm);Ws.error(`Firestore (${mo}): ${t}`,...r)}}function to(t,...e){if(Ws.logLevel<=Ve.WARN){const r=e.map(mm);Ws.warn(`Firestore (${mo}): ${t}`,...r)}}function mm(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ke(t="Unexpected state"){const e=`FIRESTORE (${mo}) INTERNAL ASSERTION FAILED: `+t;throw pi(e),new Error(e)}function Je(t,e){t||ke()}function Ne(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ve extends xi{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Lk{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(cr.UNAUTHENTICATED))}shutdown(){}}class Mk{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Vk{constructor(e){this.t=e,this.currentUser=cr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Je(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new ii;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ii,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ii)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Je(typeof n.accessToken=="string"),new uT(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Je(e===null||typeof e=="string"),new cr(e)}}class Bk{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=cr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Uk{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new Bk(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(cr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class bk{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class jk{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){Je(this.o===void 0);const n=s=>{s.error!=null&&Ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,Ee("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Je(typeof r.token=="string"),this.R=r.token,new bk(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zk(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=zk(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function He(t,e){return t<e?-1:t>e?1:0}function ro(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new ve(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new ve(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new ve(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ve(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Lt.fromMillis(Date.now())}static fromDate(e){return Lt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new Lt(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?He(this.nanoseconds,e.nanoseconds):He(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Pe(e)}static min(){return new Pe(new Lt(0,0))}static max(){return new Pe(new Lt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(e,r,n){r===void 0?r=0:r>e.length&&ke(),n===void 0?n=e.length-r:n>e.length-r&&ke(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return zl.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof zl?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class ot extends zl{construct(e,r,n){return new ot(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new ve(ee.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new ot(r)}static emptyPath(){return new ot([])}}const Wk=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Xt extends zl{construct(e,r,n){return new Xt(e,r,n)}static isValidIdentifier(e){return Wk.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Xt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Xt(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new ve(ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new ve(ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ve(ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new ve(ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Xt(r)}static emptyPath(){return new Xt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e){this.path=e}static fromPath(e){return new Se(ot.fromString(e))}static fromName(e){return new Se(ot.fromString(e).popFirst(5))}static empty(){return new Se(ot.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ot.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return ot.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Se(new ot(e.slice()))}}function Hk(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=Pe.fromTimestamp(n===1e9?new Lt(r+1,0):new Lt(r,n));return new rs(i,Se.empty(),e)}function $k(t){return new rs(t.readTime,t.key,-1)}class rs{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new rs(Pe.min(),Se.empty(),-1)}static max(){return new rs(Pe.max(),Se.empty(),-1)}}function Gk(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Se.comparator(t.documentKey,e.documentKey),r!==0?r:He(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class qk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hu(t){if(t.code!==ee.FAILED_PRECONDITION||t.message!==Kk)throw t;Ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ke(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new re((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof re?r:re.resolve(r)}catch(r){return re.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):re.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):re.reject(r)}static resolve(e){return new re((r,n)=>{r(e)})}static reject(e){return new re((r,n)=>{n(e)})}static waitFor(e){return new re((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=re.resolve(!1);for(const n of e)r=r.next(i=>i?re.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new re((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;r(e[c]).next(f=>{a[c]=f,++o,o===s&&n(a)},f=>i(f))}})}static doWhile(e,r){return new re((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function Xk(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function du(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}gm.oe=-1;function ch(t){return t==null}function Ef(t){return t===0&&1/t==-1/0}function Qk(t){return typeof t=="number"&&Number.isInteger(t)&&!Ef(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pv(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Ys(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function fT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e,r){this.comparator=e,this.root=r||qt.EMPTY}insert(e,r){return new gt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,qt.BLACK,null,null))}remove(e){return new gt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,qt.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new cc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new cc(this.root,e,this.comparator,!1)}getReverseIterator(){return new cc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new cc(this.root,e,this.comparator,!0)}}class cc{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class qt{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??qt.RED,this.left=i??qt.EMPTY,this.right=s??qt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new qt(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return qt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return qt.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,qt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,qt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ke();const e=this.left.check();if(e!==this.right.check())throw ke();return e+(this.isRed()?0:1)}}qt.EMPTY=null,qt.RED=!0,qt.BLACK=!1;qt.EMPTY=new class{constructor(){this.size=0}get key(){throw ke()}get value(){throw ke()}get color(){throw ke()}get left(){throw ke()}get right(){throw ke()}copy(e,r,n,i,s){return this}insert(e,r,n){return new qt(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.comparator=e,this.data=new gt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Nv(this.data.getIterator())}getIteratorFrom(e){return new Nv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Zt)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Zt(this.comparator);return r.data=e,r}}class Nv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(e){this.fields=e,e.sort(Xt.comparator)}static empty(){return new $r([])}unionWith(e){let r=new Zt(Xt.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new $r(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return ro(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new hT("Invalid base64 string: "+s):s}}(e);return new nr(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new nr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return He(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}nr.EMPTY_BYTE_STRING=new nr("");const Yk=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ns(t){if(Je(!!t),typeof t=="string"){let e=0;const r=Yk.exec(t);if(Je(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Et(t.seconds),nanos:Et(t.nanos)}}function Et(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Hs(t){return typeof t=="string"?nr.fromBase64String(t):nr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vm(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function _m(t){const e=t.mapValue.fields.__previous_value__;return vm(e)?_m(e):e}function Wl(t){const e=ns(t.mapValue.fields.__local_write_time__.timestampValue);return new Lt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jk{constructor(e,r,n,i,s,a,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class Hl{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Hl("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Hl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fc={mapValue:{}};function $s(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?vm(t)?4:eP(t)?9007199254740991:Zk(t)?10:11:ke()}function Un(t,e){if(t===e)return!0;const r=$s(t);if(r!==$s(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Wl(t).isEqual(Wl(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=ns(i.timestampValue),o=ns(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Hs(i.bytesValue).isEqual(Hs(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Et(i.geoPointValue.latitude)===Et(s.geoPointValue.latitude)&&Et(i.geoPointValue.longitude)===Et(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Et(i.integerValue)===Et(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=Et(i.doubleValue),o=Et(s.doubleValue);return a===o?Ef(a)===Ef(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return ro(t.arrayValue.values||[],e.arrayValue.values||[],Un);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(Pv(a)!==Pv(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Un(a[l],o[l])))return!1;return!0}(t,e);default:return ke()}}function $l(t,e){return(t.values||[]).find(r=>Un(r,e))!==void 0}function no(t,e){if(t===e)return 0;const r=$s(t),n=$s(e);if(r!==n)return He(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return He(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=Et(s.integerValue||s.doubleValue),l=Et(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return Ov(t.timestampValue,e.timestampValue);case 4:return Ov(Wl(t),Wl(e));case 5:return He(t.stringValue,e.stringValue);case 6:return function(s,a){const o=Hs(s),l=Hs(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const f=He(o[c],l[c]);if(f!==0)return f}return He(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=He(Et(s.latitude),Et(a.latitude));return o!==0?o:He(Et(s.longitude),Et(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Dv(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,c,f;const h=s.fields||{},d=a.fields||{},m=(o=h.value)===null||o===void 0?void 0:o.arrayValue,_=(l=d.value)===null||l===void 0?void 0:l.arrayValue,g=He(((c=m==null?void 0:m.values)===null||c===void 0?void 0:c.length)||0,((f=_==null?void 0:_.values)===null||f===void 0?void 0:f.length)||0);return g!==0?g:Dv(m,_)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===fc.mapValue&&a===fc.mapValue)return 0;if(s===fc.mapValue)return 1;if(a===fc.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},f=Object.keys(c);l.sort(),f.sort();for(let h=0;h<l.length&&h<f.length;++h){const d=He(l[h],f[h]);if(d!==0)return d;const m=no(o[l[h]],c[f[h]]);if(m!==0)return m}return He(l.length,f.length)}(t.mapValue,e.mapValue);default:throw ke()}}function Ov(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return He(t,e);const r=ns(t),n=ns(e),i=He(r.seconds,n.seconds);return i!==0?i:He(r.nanos,n.nanos)}function Dv(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=no(r[i],n[i]);if(s)return s}return He(r.length,n.length)}function io(t){return Vd(t)}function Vd(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=ns(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Hs(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Se.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=Vd(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${Vd(r.fields[a])}`;return i+"}"}(t.mapValue):ke()}function Fv(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Bd(t){return!!t&&"integerValue"in t}function ym(t){return!!t&&"arrayValue"in t}function Lv(t){return!!t&&"nullValue"in t}function Mv(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Bc(t){return!!t&&"mapValue"in t}function Zk(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function hl(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ys(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=hl(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=hl(t.arrayValue.values[r]);return e}return Object.assign({},t)}function eP(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e){this.value=e}static empty(){return new Rr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Bc(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=hl(r)}setAll(e){let r=Xt.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=hl(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());Bc(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Un(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Bc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Ys(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new Rr(hl(this.value))}}function dT(t){const e=[];return Ys(t.fields,(r,n)=>{const i=new Xt([r]);if(Bc(n)){const s=dT(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new $r(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new hr(e,0,Pe.min(),Pe.min(),Pe.min(),Rr.empty(),0)}static newFoundDocument(e,r,n,i){return new hr(e,1,r,Pe.min(),n,i,0)}static newNoDocument(e,r){return new hr(e,2,r,Pe.min(),Pe.min(),Rr.empty(),0)}static newUnknownDocument(e,r){return new hr(e,3,r,Pe.min(),Pe.min(),Rr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Rr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Rr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof hr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new hr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e,r){this.position=e,this.inclusive=r}}function Vv(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=Se.comparator(Se.fromName(a.referenceValue),r.key):n=no(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function Bv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Un(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(e,r="asc"){this.field=e,this.dir=r}}function tP(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pT{}class Ct extends pT{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new nP(e,r,n):r==="array-contains"?new aP(e,n):r==="in"?new oP(e,n):r==="not-in"?new lP(e,n):r==="array-contains-any"?new uP(e,n):new Ct(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new iP(e,n):new sP(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(no(r,this.value)):r!==null&&$s(this.value)===$s(r)&&this.matchesComparison(no(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ke()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Sn extends pT{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new Sn(e,r)}matches(e){return mT(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function mT(t){return t.op==="and"}function gT(t){return rP(t)&&mT(t)}function rP(t){for(const e of t.filters)if(e instanceof Sn)return!1;return!0}function Ud(t){if(t instanceof Ct)return t.field.canonicalString()+t.op.toString()+io(t.value);if(gT(t))return t.filters.map(e=>Ud(e)).join(",");{const e=t.filters.map(r=>Ud(r)).join(",");return`${t.op}(${e})`}}function vT(t,e){return t instanceof Ct?function(n,i){return i instanceof Ct&&n.op===i.op&&n.field.isEqual(i.field)&&Un(n.value,i.value)}(t,e):t instanceof Sn?function(n,i){return i instanceof Sn&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&vT(a,i.filters[o]),!0):!1}(t,e):void ke()}function _T(t){return t instanceof Ct?function(r){return`${r.field.canonicalString()} ${r.op} ${io(r.value)}`}(t):t instanceof Sn?function(r){return r.op.toString()+" {"+r.getFilters().map(_T).join(" ,")+"}"}(t):"Filter"}class nP extends Ct{constructor(e,r,n){super(e,r,n),this.key=Se.fromName(n.referenceValue)}matches(e){const r=Se.comparator(e.key,this.key);return this.matchesComparison(r)}}class iP extends Ct{constructor(e,r){super(e,"in",r),this.keys=yT("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class sP extends Ct{constructor(e,r){super(e,"not-in",r),this.keys=yT("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function yT(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Se.fromName(n.referenceValue))}class aP extends Ct{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return ym(r)&&$l(r.arrayValue,this.value)}}class oP extends Ct{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&$l(this.value.arrayValue,r)}}class lP extends Ct{constructor(e,r){super(e,"not-in",r)}matches(e){if($l(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!$l(this.value.arrayValue,r)}}class uP extends Ct{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!ym(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>$l(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function Uv(t,e=null,r=[],n=[],i=null,s=null,a=null){return new cP(t,e,r,n,i,s,a)}function xm(t){const e=Ne(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Ud(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),ch(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>io(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>io(n)).join(",")),e.ue=r}return e.ue}function Em(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!tP(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!vT(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Bv(t.startAt,e.startAt)&&Bv(t.endAt,e.endAt)}function bd(t){return Se.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function fP(t,e,r,n,i,s,a,o){return new pu(t,e,r,n,i,s,a,o)}function Tm(t){return new pu(t)}function bv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function xT(t){return t.collectionGroup!==null}function dl(t){const e=Ne(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Zt(Xt.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new wf(s,n))}),r.has(Xt.keyField().canonicalString())||e.ce.push(new wf(Xt.keyField(),n))}return e.ce}function Ln(t){const e=Ne(t);return e.le||(e.le=hP(e,dl(t))),e.le}function hP(t,e){if(t.limitType==="F")return Uv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new wf(i.field,s)});const r=t.endAt?new Tf(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Tf(t.startAt.position,t.startAt.inclusive):null;return Uv(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function jd(t,e){const r=t.filters.concat([e]);return new pu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function zd(t,e,r){return new pu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function fh(t,e){return Em(Ln(t),Ln(e))&&t.limitType===e.limitType}function ET(t){return`${xm(Ln(t))}|lt:${t.limitType}`}function ma(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>_T(i)).join(", ")}]`),ch(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>io(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>io(i)).join(",")),`Target(${n})`}(Ln(t))}; limitType=${t.limitType})`}function hh(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Se.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of dl(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const c=Vv(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,dl(n),i)||n.endAt&&!function(a,o,l){const c=Vv(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,dl(n),i))}(t,e)}function dP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function TT(t){return(e,r)=>{let n=!1;for(const i of dl(t)){const s=pP(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function pP(t,e,r){const n=t.field.isKeyField()?Se.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?no(l,c):ke()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ke()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ys(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return fT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mP=new gt(Se.comparator);function mi(){return mP}const wT=new gt(Se.comparator);function Yo(...t){let e=wT;for(const r of t)e=e.insert(r.key,r);return e}function ST(t){let e=wT;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function ks(){return pl()}function AT(){return pl()}function pl(){return new go(t=>t.toString(),(t,e)=>t.isEqual(e))}const gP=new gt(Se.comparator),vP=new Zt(Se.comparator);function Me(...t){let e=vP;for(const r of t)e=e.add(r);return e}const _P=new Zt(He);function yP(){return _P}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wm(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ef(e)?"-0":e}}function IT(t){return{integerValue:""+t}}function xP(t,e){return Qk(e)?IT(e):wm(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dh{constructor(){this._=void 0}}function EP(t,e,r){return t instanceof Gl?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&vm(s)&&(s=_m(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof Kl?RT(t,e):t instanceof ql?kT(t,e):function(i,s){const a=CT(i,s),o=jv(a)+jv(i.Pe);return Bd(a)&&Bd(i.Pe)?IT(o):wm(i.serializer,o)}(t,e)}function TP(t,e,r){return t instanceof Kl?RT(t,e):t instanceof ql?kT(t,e):r}function CT(t,e){return t instanceof Sf?function(n){return Bd(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Gl extends dh{}class Kl extends dh{constructor(e){super(),this.elements=e}}function RT(t,e){const r=PT(e);for(const n of t.elements)r.some(i=>Un(i,n))||r.push(n);return{arrayValue:{values:r}}}class ql extends dh{constructor(e){super(),this.elements=e}}function kT(t,e){let r=PT(e);for(const n of t.elements)r=r.filter(i=>!Un(i,n));return{arrayValue:{values:r}}}class Sf extends dh{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function jv(t){return Et(t.integerValue||t.doubleValue)}function PT(t){return ym(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(e,r){this.field=e,this.transform=r}}function SP(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Kl&&i instanceof Kl||n instanceof ql&&i instanceof ql?ro(n.elements,i.elements,Un):n instanceof Sf&&i instanceof Sf?Un(n.Pe,i.Pe):n instanceof Gl&&i instanceof Gl}(t.transform,e.transform)}class AP{constructor(e,r){this.version=e,this.transformResults=r}}class Mn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Mn}static exists(e){return new Mn(void 0,e)}static updateTime(e){return new Mn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Uc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ph{}function NT(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new DT(t.key,Mn.none()):new mu(t.key,t.data,Mn.none());{const r=t.data,n=Rr.empty();let i=new Zt(Xt.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new fs(t.key,n,new $r(i.toArray()),Mn.none())}}function IP(t,e,r){t instanceof mu?function(i,s,a){const o=i.value.clone(),l=Wv(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof fs?function(i,s,a){if(!Uc(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=Wv(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(OT(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function ml(t,e,r,n){return t instanceof mu?function(s,a,o,l){if(!Uc(s.precondition,a))return o;const c=s.value.clone(),f=Hv(s.fieldTransforms,l,a);return c.setAll(f),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof fs?function(s,a,o,l){if(!Uc(s.precondition,a))return o;const c=Hv(s.fieldTransforms,l,a),f=a.data;return f.setAll(OT(s)),f.setAll(c),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(s,a,o){return Uc(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function CP(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=CT(n.transform,i||null);s!=null&&(r===null&&(r=Rr.empty()),r.set(n.field,s))}return r||null}function zv(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&ro(n,i,(s,a)=>SP(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class mu extends ph{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class fs extends ph{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function OT(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Wv(t,e,r){const n=new Map;Je(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,TP(a,o,r[i]))}return n}function Hv(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,EP(s,a,e))}return n}class DT extends ph{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class RP extends ph{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&IP(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=ml(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=ml(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=AT();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=NT(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Pe.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Me())}isEqual(e){return this.batchId===e.batchId&&ro(this.mutations,e.mutations,(r,n)=>zv(r,n))&&ro(this.baseMutations,e.baseMutations,(r,n)=>zv(r,n))}}class Sm{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Je(e.mutations.length===n.length);let i=function(){return gP}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new Sm(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var At,Ue;function OP(t){switch(t){default:return ke();case ee.CANCELLED:case ee.UNKNOWN:case ee.DEADLINE_EXCEEDED:case ee.RESOURCE_EXHAUSTED:case ee.INTERNAL:case ee.UNAVAILABLE:case ee.UNAUTHENTICATED:return!1;case ee.INVALID_ARGUMENT:case ee.NOT_FOUND:case ee.ALREADY_EXISTS:case ee.PERMISSION_DENIED:case ee.FAILED_PRECONDITION:case ee.ABORTED:case ee.OUT_OF_RANGE:case ee.UNIMPLEMENTED:case ee.DATA_LOSS:return!0}}function FT(t){if(t===void 0)return pi("GRPC error has no .code"),ee.UNKNOWN;switch(t){case At.OK:return ee.OK;case At.CANCELLED:return ee.CANCELLED;case At.UNKNOWN:return ee.UNKNOWN;case At.DEADLINE_EXCEEDED:return ee.DEADLINE_EXCEEDED;case At.RESOURCE_EXHAUSTED:return ee.RESOURCE_EXHAUSTED;case At.INTERNAL:return ee.INTERNAL;case At.UNAVAILABLE:return ee.UNAVAILABLE;case At.UNAUTHENTICATED:return ee.UNAUTHENTICATED;case At.INVALID_ARGUMENT:return ee.INVALID_ARGUMENT;case At.NOT_FOUND:return ee.NOT_FOUND;case At.ALREADY_EXISTS:return ee.ALREADY_EXISTS;case At.PERMISSION_DENIED:return ee.PERMISSION_DENIED;case At.FAILED_PRECONDITION:return ee.FAILED_PRECONDITION;case At.ABORTED:return ee.ABORTED;case At.OUT_OF_RANGE:return ee.OUT_OF_RANGE;case At.UNIMPLEMENTED:return ee.UNIMPLEMENTED;case At.DATA_LOSS:return ee.DATA_LOSS;default:return ke()}}(Ue=At||(At={}))[Ue.OK=0]="OK",Ue[Ue.CANCELLED=1]="CANCELLED",Ue[Ue.UNKNOWN=2]="UNKNOWN",Ue[Ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ue[Ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ue[Ue.NOT_FOUND=5]="NOT_FOUND",Ue[Ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ue[Ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ue[Ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ue[Ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ue[Ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ue[Ue.ABORTED=10]="ABORTED",Ue[Ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ue[Ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ue[Ue.INTERNAL=13]="INTERNAL",Ue[Ue.UNAVAILABLE=14]="UNAVAILABLE",Ue[Ue.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FP=new Fs([4294967295,4294967295],0);function $v(t){const e=DP().encode(t),r=new nT;return r.update(e),new Uint8Array(r.digest())}function Gv(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Fs([r,n],0),new Fs([i,s],0)]}class Am{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Jo(`Invalid padding: ${r}`);if(n<0)throw new Jo(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Jo(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Jo(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Fs.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(Fs.fromNumber(n)));return i.compare(FP)===1&&(i=new Fs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=$v(e),[n,i]=Gv(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new Am(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=$v(e),[n,i]=Gv(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Jo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,gu.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new mh(Pe.min(),i,new gt(He),mi(),Me())}}class gu{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new gu(n,r,Me(),Me(),Me())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class LT{constructor(e,r){this.targetId=e,this.me=r}}class MT{constructor(e,r,n=nr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class Kv{constructor(){this.fe=0,this.ge=Xv(),this.pe=nr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Me(),r=Me(),n=Me();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:ke()}}),new gu(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=Xv()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Je(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class LP{constructor(e){this.Le=e,this.Be=new Map,this.ke=mi(),this.qe=qv(),this.Qe=new gt(He)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:ke()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if(bd(s))if(n===0){const a=new Se(s.path);this.Ue(r,a,hr.newNoDocument(a,Pe.min()))}else Je(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=Hs(n).toUint8Array()}catch(l){if(l instanceof hT)return to("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new Am(a,i,s)}catch(l){return to(l instanceof Jo?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&bd(o.target)){const l=new Se(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,hr.newNoDocument(l,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=Me();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new mh(e,r,this.Qe,this.ke,n);return this.ke=mi(),this.qe=qv(),this.Qe=new gt(He),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new Kv,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Zt(He),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Ee("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Kv),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function qv(){return new gt(Se.comparator)}function Xv(){return new gt(Se.comparator)}const MP={asc:"ASCENDING",desc:"DESCENDING"},VP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},BP={and:"AND",or:"OR"};class UP{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Wd(t,e){return t.useProto3Json||ch(e)?e:{value:e}}function Af(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function VT(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function bP(t,e){return Af(t,e.toTimestamp())}function Vn(t){return Je(!!t),Pe.fromTimestamp(function(r){const n=ns(r);return new Lt(n.seconds,n.nanos)}(t))}function Im(t,e){return Hd(t,e).canonicalString()}function Hd(t,e){const r=function(i){return new ot(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function BT(t){const e=ot.fromString(t);return Je(WT(e)),e}function $d(t,e){return Im(t.databaseId,e.path)}function T0(t,e){const r=BT(e);if(r.get(1)!==t.databaseId.projectId)throw new ve(ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new ve(ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Se(bT(r))}function UT(t,e){return Im(t.databaseId,e)}function jP(t){const e=BT(t);return e.length===4?ot.emptyPath():bT(e)}function Gd(t){return new ot(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function bT(t){return Je(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Qv(t,e,r){return{name:$d(t,e),fields:r.value.mapValue.fields}}function zP(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ke()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,f){return c.useProto3Json?(Je(f===void 0||typeof f=="string"),nr.fromBase64String(f||"")):(Je(f===void 0||f instanceof Buffer||f instanceof Uint8Array),nr.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const f=c.code===void 0?ee.UNKNOWN:FT(c.code);return new ve(f,c.message||"")}(a);r=new MT(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=T0(t,n.document.name),s=Vn(n.document.updateTime),a=n.document.createTime?Vn(n.document.createTime):Pe.min(),o=new Rr({mapValue:{fields:n.document.fields}}),l=hr.newFoundDocument(i,s,a,o),c=n.targetIds||[],f=n.removedTargetIds||[];r=new bc(c,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=T0(t,n.document),s=n.readTime?Vn(n.readTime):Pe.min(),a=hr.newNoDocument(i,s),o=n.removedTargetIds||[];r=new bc([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=T0(t,n.document),s=n.removedTargetIds||[];r=new bc([],s,i,null)}else{if(!("filter"in e))return ke();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new NP(i,s),o=n.targetId;r=new LT(o,a)}}return r}function WP(t,e){let r;if(e instanceof mu)r={update:Qv(t,e.key,e.value)};else if(e instanceof DT)r={delete:$d(t,e.key)};else if(e instanceof fs)r={update:Qv(t,e.key,e.data),updateMask:JP(e.fieldMask)};else{if(!(e instanceof RP))return ke();r={verify:$d(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof Gl)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Kl)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof ql)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Sf)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw ke()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:bP(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ke()}(t,e.precondition)),r}function HP(t,e){return t&&t.length>0?(Je(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?Vn(i.updateTime):Vn(s);return a.isEqual(Pe.min())&&(a=Vn(s)),new AP(a,i.transformResults||[])}(r,e))):[]}function $P(t,e){return{documents:[UT(t,e.path)]}}function GP(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=UT(t,i);const s=function(c){if(c.length!==0)return zT(Sn.create(c,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(c){if(c.length!==0)return c.map(f=>function(d){return{field:ga(d.field),direction:XP(d.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=Wd(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:i}}function KP(t){let e=jP(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Je(n===1);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];r.where&&(s=function(h){const d=jT(h);return d instanceof Sn&&gT(d)?d.getFilters():[d]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(d=>function(_){return new wf(va(_.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,ch(d)?null:d}(r.limit));let l=null;r.startAt&&(l=function(h){const d=!!h.before,m=h.values||[];return new Tf(m,d)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const d=!h.before,m=h.values||[];return new Tf(m,d)}(r.endAt)),fP(e,i,a,s,o,"F",l,c)}function qP(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ke()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function jT(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=va(r.unaryFilter.field);return Ct.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=va(r.unaryFilter.field);return Ct.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=va(r.unaryFilter.field);return Ct.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=va(r.unaryFilter.field);return Ct.create(a,"!=",{nullValue:"NULL_VALUE"});default:return ke()}}(t):t.fieldFilter!==void 0?function(r){return Ct.create(va(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ke()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Sn.create(r.compositeFilter.filters.map(n=>jT(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ke()}}(r.compositeFilter.op))}(t):ke()}function XP(t){return MP[t]}function QP(t){return VP[t]}function YP(t){return BP[t]}function ga(t){return{fieldPath:t.canonicalString()}}function va(t){return Xt.fromServerFormat(t.fieldPath)}function zT(t){return t instanceof Ct?function(r){if(r.op==="=="){if(Mv(r.value))return{unaryFilter:{field:ga(r.field),op:"IS_NAN"}};if(Lv(r.value))return{unaryFilter:{field:ga(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Mv(r.value))return{unaryFilter:{field:ga(r.field),op:"IS_NOT_NAN"}};if(Lv(r.value))return{unaryFilter:{field:ga(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ga(r.field),op:QP(r.op),value:r.value}}}(t):t instanceof Sn?function(r){const n=r.getFilters().map(i=>zT(i));return n.length===1?n[0]:{compositeFilter:{op:YP(r.op),filters:n}}}(t):ke()}function JP(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function WT(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(e,r,n,i,s=Pe.min(),a=Pe.min(),o=nr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Ui(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Ui(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ui(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ui(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(e){this.ct=e}}function eN(t){const e=KP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?zd(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tN{constructor(){this.un=new rN}addToCollectionParentIndex(e,r){return this.un.add(r),re.resolve()}getCollectionParents(e,r){return re.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return re.resolve()}deleteFieldIndex(e,r){return re.resolve()}deleteAllFieldIndexes(e){return re.resolve()}createTargetIndexes(e,r){return re.resolve()}getDocumentsMatchingTarget(e,r){return re.resolve(null)}getIndexType(e,r){return re.resolve(0)}getFieldIndexes(e,r){return re.resolve([])}getNextCollectionGroupToUpdate(e){return re.resolve(null)}getMinOffset(e,r){return re.resolve(rs.min())}getMinOffsetFromCollectionGroup(e,r){return re.resolve(rs.min())}updateCollectionGroup(e,r,n){return re.resolve()}updateIndexEntries(e,r){return re.resolve()}}class rN{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Zt(ot.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Zt(ot.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new so(0)}static kn(){return new so(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nN{constructor(){this.changes=new go(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,hr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?re.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&ml(n.mutation,i,$r.empty(),Lt.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Me()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Me()){const i=ks();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=Yo();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=ks();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Me()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=mi();const a=pl(),o=function(){return pl()}();return r.forEach((l,c)=>{const f=n.get(c.key);i.has(c.key)&&(f===void 0||f.mutation instanceof fs)?s=s.insert(c.key,c):f!==void 0?(a.set(c.key,f.mutation.getFieldMask()),ml(f.mutation,c,f.mutation.getFieldMask(),Lt.now())):a.set(c.key,$r.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,f)=>a.set(c,f)),r.forEach((c,f)=>{var h;return o.set(c,new iN(f,(h=a.get(c))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,r){const n=pl();let i=new gt((a,o)=>a-o),s=Me();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let f=n.get(l)||$r.empty();f=o.applyToLocalView(c,f),n.set(l,f);const h=(i.get(o.batchId)||Me()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,f=l.value,h=AT();f.forEach(d=>{if(!s.has(d)){const m=NT(r.get(d),n.get(d));m!==null&&h.set(d,m),s=s.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,h))}return re.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return Se.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):xT(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):re.resolve(ks());let o=-1,l=s;return a.next(c=>re.forEach(c,(f,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(f)?re.resolve():this.remoteDocumentCache.getEntry(e,f).next(d=>{l=l.insert(f,d)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,Me())).next(f=>({batchId:o,changes:ST(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Se(r)).next(n=>{let i=Yo();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=Yo();return this.indexManager.getCollectionParents(e,s).next(o=>re.forEach(o,l=>{const c=function(h,d){return new pu(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,n,i).next(f=>{f.forEach((h,d)=>{a=a.insert(h,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,c)=>{const f=c.getKey();a.get(f)===null&&(a=a.insert(f,hr.newInvalidDocument(f)))});let o=Yo();return a.forEach((l,c)=>{const f=s.get(l);f!==void 0&&ml(f.mutation,c,$r.empty(),Lt.now()),hh(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return re.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:Vn(i.createTime)}}(r)),re.resolve()}getNamedQuery(e,r){return re.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:eN(i.bundledQuery),readTime:Vn(i.readTime)}}(r)),re.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oN{constructor(){this.overlays=new gt(Se.comparator),this.Ir=new Map}getOverlay(e,r){return re.resolve(this.overlays.get(r))}getOverlays(e,r){const n=ks();return re.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),re.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),re.resolve()}getOverlaysForCollection(e,r,n){const i=ks(),s=r.length+1,a=new Se(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return re.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new gt((c,f)=>c-f);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let f=s.get(c.largestBatchId);f===null&&(f=ks(),s=s.insert(c.largestBatchId,f)),f.set(c.getKey(),c)}}const o=ks(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,f)=>o.set(c,f)),!(o.size()>=i)););return re.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new PP(r,n));let s=this.Ir.get(r);s===void 0&&(s=Me(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(){this.sessionToken=nr.EMPTY_BYTE_STRING}getSessionToken(e){return re.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,re.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(){this.Tr=new Zt(Mt.Er),this.dr=new Zt(Mt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new Mt(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new Mt(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Se(new ot([])),n=new Mt(r,e),i=new Mt(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Se(new ot([])),n=new Mt(r,e),i=new Mt(r,e+1);let s=Me();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new Mt(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Mt{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Se.comparator(e.key,r.key)||He(e.wr,r.wr)}static Ar(e,r){return He(e.wr,r.wr)||Se.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uN{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Zt(Mt.Er)}checkEmpty(e){return re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new kP(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new Mt(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return re.resolve(a)}lookupMutationBatch(e,r){return re.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return re.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return re.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Mt(r,0),i=new Mt(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),re.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Zt(He);return r.forEach(i=>{const s=new Mt(i,0),a=new Mt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),re.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;Se.isDocumentKey(s)||(s=s.child(""));const a=new Mt(new Se(s),0);let o=new Zt(He);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.wr)),!0)},a),re.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Je(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return re.forEach(r.mutations,i=>{const s=new Mt(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new Mt(r,0),i=this.br.firstAfterOrEqual(n);return re.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,re.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN{constructor(e){this.Mr=e,this.docs=function(){return new gt(Se.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return re.resolve(n?n.document.mutableCopy():hr.newInvalidDocument(r))}getEntries(e,r){let n=mi();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():hr.newInvalidDocument(i))}),re.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=mi();const a=r.path,o=new Se(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:f}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||Gk($k(f),n)<=0||(i.has(f.key)||hh(r,f))&&(s=s.insert(f.key,f.mutableCopy()))}return re.resolve(s)}getAllFromCollectionGroup(e,r,n,i){ke()}Or(e,r){return re.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new fN(this)}getSize(e){return re.resolve(this.size)}}class fN extends nN{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),re.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hN{constructor(e){this.persistence=e,this.Nr=new go(r=>xm(r),Em),this.lastRemoteSnapshotVersion=Pe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Cm,this.targetCount=0,this.kr=so.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),re.resolve()}getLastRemoteSnapshotVersion(e){return re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return re.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),re.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),re.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new so(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,re.resolve()}updateTargetData(e,r){return this.Kn(r),re.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,re.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),re.waitFor(s).next(()=>i)}getTargetCount(e){return re.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return re.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),re.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),re.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),re.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return re.resolve(n)}containsKey(e,r){return re.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{constructor(e,r){this.qr={},this.overlays={},this.Qr=new gm(0),this.Kr=!1,this.Kr=!0,this.$r=new lN,this.referenceDelegate=e(this),this.Ur=new hN(this),this.indexManager=new tN,this.remoteDocumentCache=function(i){return new cN(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new ZP(r),this.Gr=new aN(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new oN,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new uN(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Ee("MemoryPersistence","Starting transaction:",e);const i=new pN(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return re.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class pN extends qk{constructor(e){super(),this.currentSequenceNumber=e}}class Rm{constructor(e){this.persistence=e,this.Jr=new Cm,this.Yr=null}static Zr(e){return new Rm(e)}get Xr(){if(this.Yr)return this.Yr;throw ke()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),re.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),re.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),re.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return re.forEach(this.Xr,n=>{const i=Se.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,Pe.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return re.or([()=>re.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=Me(),i=Me();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new km(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mN{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gN{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return gC()?8:Xk(gr())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new mN;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(Ho()<=Ve.DEBUG&&Ee("QueryEngine","SDK will not create cache indexes for query:",ma(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),re.resolve()):(Ho()<=Ve.DEBUG&&Ee("QueryEngine","Query:",ma(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(Ho()<=Ve.DEBUG&&Ee("QueryEngine","The SDK decides to create cache indexes for query:",ma(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ln(r))):re.resolve())}Yi(e,r){if(bv(r))return re.resolve(null);let n=Ln(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=zd(r,null,"F"),n=Ln(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=Me(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,a,l.readTime)?this.Yi(e,zd(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,i){return bv(r)||i.isEqual(Pe.min())?re.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?re.resolve(null):(Ho()<=Ve.DEBUG&&Ee("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ma(r)),this.rs(e,a,r,Hk(i,-1)).next(o=>o))})}ts(e,r){let n=new Zt(TT(e));return r.forEach((i,s)=>{hh(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return Ho()<=Ve.DEBUG&&Ee("QueryEngine","Using full collection scan to execute query:",ma(r)),this.Ji.getDocumentsMatchingQuery(e,r,rs.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vN{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new gt(He),this._s=new go(s=>xm(s),Em),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new sN(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function _N(t,e,r,n){return new vN(t,e,r,n)}async function HT(t,e){const r=Ne(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=Me();for(const c of i){a.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}for(const c of s){o.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:a,addedBatchIds:o}))})})}function yN(t,e){const r=Ne(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,f){const h=c.batch,d=h.keys();let m=re.resolve();return d.forEach(_=>{m=m.next(()=>f.getEntry(l,_)).next(g=>{const w=c.docVersions.get(_);Je(w!==null),g.version.compareTo(w)<0&&(h.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),f.addEntry(g)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Me();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function $T(t){const e=Ne(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function xN(t,e){const r=Ne(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((f,h)=>{const d=i.get(h);if(!d)return;o.push(r.Ur.removeMatchingKeys(s,f.removedDocuments,h).next(()=>r.Ur.addMatchingKeys(s,f.addedDocuments,h)));let m=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(nr.EMPTY_BYTE_STRING,Pe.min()).withLastLimboFreeSnapshotVersion(Pe.min()):f.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(f.resumeToken,n)),i=i.insert(h,m),function(g,w,S){return g.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(d,m,f)&&o.push(r.Ur.updateTargetData(s,m))});let l=mi(),c=Me();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,f))}),o.push(EN(s,a,e.documentUpdates).next(f=>{l=f.Ps,c=f.Is})),!n.isEqual(Pe.min())){const f=r.Ur.getLastRemoteSnapshotVersion(s).next(h=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(f)}return re.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(r.os=i,s))}function EN(t,e,r){let n=Me(),i=Me();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=mi();return r.forEach((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Pe.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Ee("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function TN(t,e){const r=Ne(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function wN(t,e){const r=Ne(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,re.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new Ui(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function Kd(t,e,r){const n=Ne(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!du(a))throw a;Ee("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function Yv(t,e,r){const n=Ne(t);let i=Pe.min(),s=Me();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,f){const h=Ne(l),d=h._s.get(f);return d!==void 0?re.resolve(h.os.get(d)):h.Ur.getTargetData(c,f)}(n,a,Ln(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:Pe.min(),r?s:Me())).next(o=>(SN(n,dP(e),o),{documents:o,Ts:s})))}function SN(t,e,r){let n=t.us.get(e)||Pe.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class Jv{constructor(){this.activeTargetIds=yP()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class AN{constructor(){this.so=new Jv,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Jv,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Ee("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Ee("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hc=null;function w0(){return hc===null?hc=function(){return 268435456+Math.round(2147483648*Math.random())}():hc++,"0x"+hc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RN{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ur="WebChannelConnection";class kN extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=w0(),l=this.xo(r,n.toUriEncodedString());Ee("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,a),this.No(r,l,c,i).then(f=>(Ee("RestConnection",`Received RPC '${r}' ${o}: `,f),f),f=>{throw to("RestConnection",`RPC '${r}' ${o} failed with error: `,f,"url: ",l,"request:",i),f})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+mo}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=CN[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=w0();return new Promise((a,o)=>{const l=new iT;l.setWithCredentials(!0),l.listenOnce(sT.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Vc.NO_ERROR:const f=l.getResponseJson();Ee(ur,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),a(f);break;case Vc.TIMEOUT:Ee(ur,`RPC '${e}' ${s} timed out`),o(new ve(ee.DEADLINE_EXCEEDED,"Request time out"));break;case Vc.HTTP_ERROR:const h=l.getStatus();if(Ee(ur,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let d=l.getResponseJson();Array.isArray(d)&&(d=d[0]);const m=d==null?void 0:d.error;if(m&&m.status&&m.message){const _=function(w){const S=w.toLowerCase().replace(/_/g,"-");return Object.values(ee).indexOf(S)>=0?S:ee.UNKNOWN}(m.status);o(new ve(_,m.message))}else o(new ve(ee.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new ve(ee.UNAVAILABLE,"Connection failed."));break;default:ke()}}finally{Ee(ur,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);Ee(ur,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const i=w0(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=lT(),o=oT(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=s.join("");Ee(ur,`Creating RPC '${e}' stream ${i}: ${f}`,l);const h=a.createWebChannel(f,l);let d=!1,m=!1;const _=new RN({Io:w=>{m?Ee(ur,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(d||(Ee(ur,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),Ee(ur,`RPC '${e}' stream ${i} sending:`,w),h.send(w))},To:()=>h.close()}),g=(w,S,x)=>{w.listen(S,I=>{try{x(I)}catch(V){setTimeout(()=>{throw V},0)}})};return g(h,Qo.EventType.OPEN,()=>{m||(Ee(ur,`RPC '${e}' stream ${i} transport opened.`),_.yo())}),g(h,Qo.EventType.CLOSE,()=>{m||(m=!0,Ee(ur,`RPC '${e}' stream ${i} transport closed`),_.So())}),g(h,Qo.EventType.ERROR,w=>{m||(m=!0,to(ur,`RPC '${e}' stream ${i} transport errored:`,w),_.So(new ve(ee.UNAVAILABLE,"The operation could not be completed")))}),g(h,Qo.EventType.MESSAGE,w=>{var S;if(!m){const x=w.data[0];Je(!!x);const I=x,V=I.error||((S=I[0])===null||S===void 0?void 0:S.error);if(V){Ee(ur,`RPC '${e}' stream ${i} received error:`,V);const b=V.status;let H=function(T){const C=At[T];if(C!==void 0)return FT(C)}(b),E=V.message;H===void 0&&(H=ee.INTERNAL,E="Unknown error status: "+b+" with message "+V.message),m=!0,_.So(new ve(H,E)),h.close()}else Ee(ur,`RPC '${e}' stream ${i} received:`,x),_.bo(x)}}),g(o,aT.STAT_EVENT,w=>{w.stat===Md.PROXY?Ee(ur,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===Md.NOPROXY&&Ee(ur,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{_.wo()},0),_}}function S0(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gh(t){return new UP(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&Ee("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{constructor(e,r,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new GT(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===ee.RESOURCE_EXHAUSTED?(pi(r.toString()),pi("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new ve(ee.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Ee("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Ee("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class PN extends KT{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=zP(this.serializer,e),n=function(s){if(!("targetChange"in s))return Pe.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Pe.min():a.readTime?Vn(a.readTime):Pe.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=Gd(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=bd(l)?{documents:$P(s,l)}:{query:GP(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=VT(s,a.resumeToken);const c=Wd(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Pe.min())>0){o.readTime=Af(s,a.snapshotVersion.toTimestamp());const c=Wd(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=qP(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=Gd(this.serializer),r.removeTarget=e,this.a_(r)}}class NN extends KT{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return Je(!!e.streamToken),this.lastStreamToken=e.streamToken,Je(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Je(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=HP(e.writeResults,e.commitTime),n=Vn(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=Gd(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>WP(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ve(ee.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,Hd(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ve(ee.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,Hd(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ve(ee.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class DN{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(pi(r),this.D_=!1):Ee("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FN{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{Js(this)&&(Ee("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=Ne(l);c.L_.add(4),await vu(c),c.q_.set("Unknown"),c.L_.delete(4),await vh(c)}(this))})}),this.q_=new DN(n,i)}}async function vh(t){if(Js(t))for(const e of t.B_)await e(!0)}async function vu(t){for(const e of t.B_)await e(!1)}function qT(t,e){const r=Ne(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),Dm(r)?Om(r):vo(r).r_()&&Nm(r,e))}function Pm(t,e){const r=Ne(t),n=vo(r);r.N_.delete(e),n.r_()&&XT(r,e),r.N_.size===0&&(n.r_()?n.o_():Js(r)&&r.q_.set("Unknown"))}function Nm(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Pe.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}vo(t).A_(e)}function XT(t,e){t.Q_.xe(e),vo(t).R_(e)}function Om(t){t.Q_=new LP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),vo(t).start(),t.q_.v_()}function Dm(t){return Js(t)&&!vo(t).n_()&&t.N_.size>0}function Js(t){return Ne(t).L_.size===0}function QT(t){t.Q_=void 0}async function LN(t){t.q_.set("Online")}async function MN(t){t.N_.forEach((e,r)=>{Nm(t,e)})}async function VN(t,e){QT(t),Dm(t)?(t.q_.M_(e),Om(t)):t.q_.set("Unknown")}async function BN(t,e,r){if(t.q_.set("Online"),e instanceof MT&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){Ee("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await If(t,n)}else if(e instanceof bc?t.Q_.Ke(e):e instanceof LT?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Pe.min()))try{const n=await $T(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.N_.get(c);f&&s.N_.set(c,f.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const f=s.N_.get(l);if(!f)return;s.N_.set(l,f.withResumeToken(nr.EMPTY_BYTE_STRING,f.snapshotVersion)),XT(s,l);const h=new Ui(f.target,l,c,f.sequenceNumber);Nm(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Ee("RemoteStore","Failed to raise snapshot:",n),await If(t,n)}}async function If(t,e,r){if(!du(e))throw e;t.L_.add(1),await vu(t),t.q_.set("Offline"),r||(r=()=>$T(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ee("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await vh(t)})}function YT(t,e){return e().catch(r=>If(t,r,e))}async function _h(t){const e=Ne(t),r=is(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;UN(e);)try{const i=await TN(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,bN(e,i)}catch(i){await If(e,i)}JT(e)&&ZT(e)}function UN(t){return Js(t)&&t.O_.length<10}function bN(t,e){t.O_.push(e);const r=is(t);r.r_()&&r.V_&&r.m_(e.mutations)}function JT(t){return Js(t)&&!is(t).n_()&&t.O_.length>0}function ZT(t){is(t).start()}async function jN(t){is(t).p_()}async function zN(t){const e=is(t);for(const r of t.O_)e.m_(r.mutations)}async function WN(t,e,r){const n=t.O_.shift(),i=Sm.from(n,e,r);await YT(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await _h(t)}async function HN(t,e){e&&is(t).V_&&await async function(n,i){if(function(a){return OP(a)&&a!==ee.ABORTED}(i.code)){const s=n.O_.shift();is(n).s_(),await YT(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await _h(n)}}(t,e),JT(t)&&ZT(t)}async function e_(t,e){const r=Ne(t);r.asyncQueue.verifyOperationInProgress(),Ee("RemoteStore","RemoteStore received new credentials");const n=Js(r);r.L_.add(3),await vu(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await vh(r)}async function $N(t,e){const r=Ne(t);e?(r.L_.delete(2),await vh(r)):e||(r.L_.add(2),await vu(r),r.q_.set("Unknown"))}function vo(t){return t.K_||(t.K_=function(r,n,i){const s=Ne(r);return s.w_(),new PN(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:LN.bind(null,t),Ro:MN.bind(null,t),mo:VN.bind(null,t),d_:BN.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Dm(t)?Om(t):t.q_.set("Unknown")):(await t.K_.stop(),QT(t))})),t.K_}function is(t){return t.U_||(t.U_=function(r,n,i){const s=Ne(r);return s.w_(),new NN(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:jN.bind(null,t),mo:HN.bind(null,t),f_:zN.bind(null,t),g_:WN.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await _h(t)):(await t.U_.stop(),t.O_.length>0&&(Ee("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new ii,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new Fm(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ve(ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Lm(t,e){if(pi("AsyncQueue",`${e}: ${t}`),du(t))return new ve(ee.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Se.comparator(r.key,n.key):(r,n)=>Se.comparator(r.key,n.key),this.keyedMap=Yo(),this.sortedSet=new gt(this.comparator)}static emptySet(e){return new ja(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof ja)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new ja;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{constructor(){this.W_=new gt(Se.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):ke():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class ao{constructor(e,r,n,i,s,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new ao(e,r,ja.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&fh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class KN{constructor(){this.queries=r_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=Ne(r),s=i.queries;i.queries=r_(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new ve(ee.ABORTED,"Firestore shutting down"))}}function r_(){return new go(t=>ET(t),fh)}async function ew(t,e){const r=Ne(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new GN,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=Lm(a,`Initialization of query '${ma(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&Mm(r)}async function tw(t,e){const r=Ne(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function qN(t,e){const r=Ne(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&Mm(r)}function XN(t,e,r){const n=Ne(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function Mm(t){t.Y_.forEach(e=>{e.next()})}var qd,n_;(n_=qd||(qd={})).ea="default",n_.Cache="cache";class rw{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new ao(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=ao.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==qd.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{constructor(e){this.key=e}}class iw{constructor(e){this.key=e}}class QN{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Me(),this.mutatedKeys=Me(),this.Aa=TT(e),this.Ra=new ja(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new t_,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,h)=>{const d=i.get(f),m=hh(this.query,h)?h:null,_=!!d&&this.mutatedKeys.has(d.key),g=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let w=!1;d&&m?d.data.isEqual(m.data)?_!==g&&(n.track({type:3,doc:m}),w=!0):this.ga(d,m)||(n.track({type:2,doc:m}),w=!0,(l&&this.Aa(m,l)>0||c&&this.Aa(m,c)<0)&&(o=!0)):!d&&m?(n.track({type:0,doc:m}),w=!0):d&&!m&&(n.track({type:1,doc:d}),w=!0,(l||c)&&(o=!0)),w&&(m?(a=a.add(m),s=g?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((f,h)=>function(m,_){const g=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ke()}};return g(m)-g(_)}(f.type,h.type)||this.Aa(f.doc,h.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,a.length!==0||c?{snapshot:new ao(this.query,e.Ra,s,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new t_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Me(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new iw(n))}),this.da.forEach(n=>{e.has(n)||r.push(new nw(n))}),r}ba(e){this.Ta=e.Ts,this.da=Me();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return ao.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class YN{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class JN{constructor(e){this.key=e,this.va=!1}}class ZN{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new go(o=>ET(o),fh),this.Ma=new Map,this.xa=new Set,this.Oa=new gt(Se.comparator),this.Na=new Map,this.La=new Cm,this.Ba={},this.ka=new Map,this.qa=so.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function eO(t,e,r=!0){const n=cw(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await sw(n,e,r,!0),i}async function tO(t,e){const r=cw(t);await sw(r,e,!0,!1)}async function sw(t,e,r,n){const i=await wN(t.localStore,Ln(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await rO(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&qT(t.remoteStore,i),o}async function rO(t,e,r,n,i){t.Ka=(h,d,m)=>async function(g,w,S,x){let I=w.view.ma(S);I.ns&&(I=await Yv(g.localStore,w.query,!1).then(({documents:E})=>w.view.ma(E,I)));const V=x&&x.targetChanges.get(w.targetId),b=x&&x.targetMismatches.get(w.targetId)!=null,H=w.view.applyChanges(I,g.isPrimaryClient,V,b);return s_(g,w.targetId,H.wa),H.snapshot}(t,h,d,m);const s=await Yv(t.localStore,e,!0),a=new QN(e,s.Ts),o=a.ma(s.documents),l=gu.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),c=a.applyChanges(o,t.isPrimaryClient,l);s_(t,r,c.wa);const f=new YN(e,r,a);return t.Fa.set(e,f),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function nO(t,e,r){const n=Ne(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!fh(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Kd(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Pm(n.remoteStore,i.targetId),Xd(n,i.targetId)}).catch(hu)):(Xd(n,i.targetId),await Kd(n.localStore,i.targetId,!0))}async function iO(t,e){const r=Ne(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Pm(r.remoteStore,n.targetId))}async function sO(t,e,r){const n=hO(t);try{const i=await function(a,o){const l=Ne(a),c=Lt.now(),f=o.reduce((m,_)=>m.add(_.key),Me());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let _=mi(),g=Me();return l.cs.getEntries(m,f).next(w=>{_=w,_.forEach((S,x)=>{x.isValidDocument()||(g=g.add(S))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,_)).next(w=>{h=w;const S=[];for(const x of o){const I=CP(x,h.get(x.key).overlayedDocument);I!=null&&S.push(new fs(x.key,I,dT(I.value.mapValue),Mn.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,S,o)}).next(w=>{d=w;const S=w.applyToLocalDocumentSet(h,g);return l.documentOverlayCache.saveOverlays(m,w.batchId,S)})}).then(()=>({batchId:d.batchId,changes:ST(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let c=a.Ba[a.currentUser.toKey()];c||(c=new gt(He)),c=c.insert(o,l),a.Ba[a.currentUser.toKey()]=c}(n,i.batchId,r),await _u(n,i.changes),await _h(n.remoteStore)}catch(i){const s=Lm(i,"Failed to persist write");r.reject(s)}}async function aw(t,e){const r=Ne(t);try{const n=await xN(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(Je(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?Je(a.va):i.removedDocuments.size>0&&(Je(a.va),a.va=!1))}),await _u(r,n,e)}catch(n){await hu(n)}}function i_(t,e,r){const n=Ne(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=Ne(a);l.onlineState=o;let c=!1;l.queries.forEach((f,h)=>{for(const d of h.j_)d.Z_(o)&&(c=!0)}),c&&Mm(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function aO(t,e,r){const n=Ne(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new gt(Se.comparator);a=a.insert(s,hr.newNoDocument(s,Pe.min()));const o=Me().add(s),l=new mh(Pe.min(),new Map,new gt(He),a,o);await aw(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),Vm(n)}else await Kd(n.localStore,e,!1).then(()=>Xd(n,e,r)).catch(hu)}async function oO(t,e){const r=Ne(t),n=e.batch.batchId;try{const i=await yN(r.localStore,e);lw(r,n,null),ow(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await _u(r,i)}catch(i){await hu(i)}}async function lO(t,e,r){const n=Ne(t);try{const i=await function(a,o){const l=Ne(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let f;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(Je(h!==null),f=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,f,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,f)).next(()=>l.localDocuments.getDocuments(c,f))})}(n.localStore,e);lw(n,e,r),ow(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await _u(n,i)}catch(i){await hu(i)}}function ow(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function lw(t,e,r){const n=Ne(t);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function Xd(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||uw(t,n)})}function uw(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(Pm(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),Vm(t))}function s_(t,e,r){for(const n of r)n instanceof nw?(t.La.addReference(n.key,e),uO(t,n)):n instanceof iw?(Ee("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||uw(t,n.key)):ke()}function uO(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Ee("SyncEngine","New document in limbo: "+r),t.xa.add(n),Vm(t))}function Vm(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Se(ot.fromString(e)),n=t.qa.next();t.Na.set(n,new JN(r)),t.Oa=t.Oa.insert(r,n),qT(t.remoteStore,new Ui(Ln(Tm(r.path)),n,"TargetPurposeLimboResolution",gm.oe))}}async function _u(t,e,r){const n=Ne(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(c=>{var f;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=km.Wi(l.targetId,c);s.push(h)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,c){const f=Ne(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>re.forEach(c,d=>re.forEach(d.$i,m=>f.persistence.referenceDelegate.addReference(h,d.targetId,m)).next(()=>re.forEach(d.Ui,m=>f.persistence.referenceDelegate.removeReference(h,d.targetId,m)))))}catch(h){if(!du(h))throw h;Ee("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const d=h.targetId;if(!h.fromCache){const m=f.os.get(d),_=m.snapshotVersion,g=m.withLastLimboFreeSnapshotVersion(_);f.os=f.os.insert(d,g)}}}(n.localStore,s))}async function cO(t,e){const r=Ne(t);if(!r.currentUser.isEqual(e)){Ee("SyncEngine","User change. New user:",e.toKey());const n=await HT(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new ve(ee.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await _u(r,n.hs)}}function fO(t,e){const r=Ne(t),n=r.Na.get(e);if(n&&n.va)return Me().add(n.key);{let i=Me();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function cw(t){const e=Ne(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=aw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=fO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=aO.bind(null,e),e.Ca.d_=qN.bind(null,e.eventManager),e.Ca.$a=XN.bind(null,e.eventManager),e}function hO(t){const e=Ne(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=oO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lO.bind(null,e),e}class Cf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=gh(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return _N(this.persistence,new gN,e.initialUser,this.serializer)}Ga(e){return new dN(Rm.Zr,this.serializer)}Wa(e){return new AN}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Cf.provider={build:()=>new Cf};class Qd{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>i_(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=cO.bind(null,this.syncEngine),await $N(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new KN}()}createDatastore(e){const r=gh(e.databaseInfo.databaseId),n=function(s){return new kN(s)}(e.databaseInfo);return function(s,a,o,l){return new ON(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new FN(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>i_(this.syncEngine,r,0),function(){return Zv.D()?new Zv:new IN}())}createSyncEngine(e,r){return function(i,s,a,o,l,c,f){const h=new ZN(i,s,a,o,l,c);return f&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=Ne(i);Ee("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await vu(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Qd.provider={build:()=>new Qd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):pi("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=cr.UNAUTHENTICATED,this.clientId=cT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{Ee("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Ee("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ii;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Lm(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function A0(t,e){t.asyncQueue.verifyOperationInProgress(),Ee("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await HT(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function a_(t,e){t.asyncQueue.verifyOperationInProgress();const r=await pO(t);Ee("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>e_(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>e_(e.remoteStore,i)),t._onlineComponents=e}async function pO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ee("FirestoreClient","Using user provided OfflineComponentProvider");try{await A0(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===ee.FAILED_PRECONDITION||i.code===ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;to("Error using user provided cache. Falling back to memory cache: "+r),await A0(t,new Cf)}}else Ee("FirestoreClient","Using default OfflineComponentProvider"),await A0(t,new Cf);return t._offlineComponents}async function hw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ee("FirestoreClient","Using user provided OnlineComponentProvider"),await a_(t,t._uninitializedComponentsProvider._online)):(Ee("FirestoreClient","Using default OnlineComponentProvider"),await a_(t,new Qd))),t._onlineComponents}function mO(t){return hw(t).then(e=>e.syncEngine)}async function dw(t){const e=await hw(t),r=e.eventManager;return r.onListen=eO.bind(null,e.syncEngine),r.onUnlisten=nO.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=tO.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=iO.bind(null,e.syncEngine),r}function gO(t,e,r={}){const n=new ii;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const f=new fw({next:d=>{f.Za(),a.enqueueAndForget(()=>tw(s,h));const m=d.docs.has(o);!m&&d.fromCache?c.reject(new ve(ee.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&d.fromCache&&l&&l.source==="server"?c.reject(new ve(ee.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new rw(Tm(o.path),f,{includeMetadataChanges:!0,_a:!0});return ew(s,h)}(await dw(t),t.asyncQueue,e,r,n)),n.promise}function vO(t,e,r={}){const n=new ii;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const f=new fw({next:d=>{f.Za(),a.enqueueAndForget(()=>tw(s,h)),d.fromCache&&l.source==="server"?c.reject(new ve(ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new rw(o,f,{includeMetadataChanges:!0,_a:!0});return ew(s,h)}(await dw(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(t,e,r){if(!r)throw new ve(ee.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function _O(t,e,r,n){if(e===!0&&n===!0)throw new ve(ee.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function l_(t){if(!Se.isDocumentKey(t))throw new ve(ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function u_(t){if(Se.isDocumentKey(t))throw new ve(ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function yh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ke()}function gi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ve(ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=yh(t);throw new ve(ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new ve(ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ve(ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_O("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=pw((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ve(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ve(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ve(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class xh{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new c_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ve(ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ve(ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new c_(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Lk;switch(n.type){case"firstParty":return new Uk(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new ve(ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=o_.get(r);n&&(Ee("ComponentProvider","Removing Datastore"),o_.delete(r),n.terminate())}(this),Promise.resolve()}}function yO(t,e,r,n={}){var i;const s=(t=gi(t,xh))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&to("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=cr.MOCK_USER;else{o=uC(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new ve(ee.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new cr(c)}t._authCredentials=new Mk(new uT(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new _o(this.firestore,e,this._query)}}class Er{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Zi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Er(this.firestore,e,this._key)}}class Zi extends _o{constructor(e,r,n){super(e,r,Tm(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Er(this.firestore,null,new Se(e))}withConverter(e){return new Zi(this.firestore,e,this._path)}}function Zo(t,e,...r){if(t=rr(t),mw("collection","path",e),t instanceof xh){const n=ot.fromString(e,...r);return u_(n),new Zi(t,null,n)}{if(!(t instanceof Er||t instanceof Zi))throw new ve(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ot.fromString(e,...r));return u_(n),new Zi(t.firestore,null,n)}}function Ps(t,e,...r){if(t=rr(t),arguments.length===1&&(e=cT.newId()),mw("doc","path",e),t instanceof xh){const n=ot.fromString(e,...r);return l_(n),new Er(t,null,new Se(n))}{if(!(t instanceof Er||t instanceof Zi))throw new ve(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ot.fromString(e,...r));return l_(n),new Er(t.firestore,t instanceof Zi?t.converter:null,new Se(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new GT(this,"async_queue_retry"),this.Vu=()=>{const n=S0();n&&Ee("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=S0();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=S0();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new ii;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!du(e))throw e;Ee("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw pi("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=Fm.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&ke()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}class yu extends xh{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new f_,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new f_(e),this._firestoreClient=void 0,await e}}}function xO(t,e){const r=typeof t=="object"?t:wE(),n=typeof t=="string"?t:"(default)",i=nm(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=oC("firestore");s&&yO(i,...s)}return i}function Bm(t){if(t._terminated)throw new ve(ee.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||EO(t),t._firestoreClient}function EO(t){var e,r,n;const i=t._freezeSettings(),s=function(o,l,c,f){return new Jk(o,l,c,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,pw(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new dO(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new oo(nr.fromBase64String(e))}catch(r){throw new ve(ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new oo(nr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new ve(ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Um{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new ve(ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new ve(ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return He(this._lat,e._lat)||He(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bm{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TO=/^__.*__$/;class wO{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new fs(e,this.data,this.fieldMask,r,this.fieldTransforms):new mu(e,this.data,r,this.fieldTransforms)}}class gw{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new fs(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function vw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ke()}}class jm{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new jm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Rf(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(vw(this.Cu)&&TO.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class SO{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||gh(e)}Qu(e,r,n,i=!1){return new jm({Cu:e,methodName:r,qu:n,path:Xt.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zm(t){const e=t._freezeSettings(),r=gh(t._databaseId);return new SO(t._databaseId,!!e.ignoreUndefinedProperties,r)}function AO(t,e,r,n,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,r,i);Hm("Data must be an object, but it was:",a,n);const o=_w(n,a);let l,c;if(s.merge)l=new $r(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const h of s.mergeFields){const d=Yd(e,h,r);if(!a.contains(d))throw new ve(ee.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);xw(f,d)||f.push(d)}l=new $r(f),c=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=a.fieldTransforms;return new wO(new Rr(o),l,c)}class wh extends Th{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof wh}}class Wm extends Th{_toFieldTransform(e){return new wP(e.path,new Gl)}isEqual(e){return e instanceof Wm}}function IO(t,e,r,n){const i=t.Qu(1,e,r);Hm("Data must be an object, but it was:",i,n);const s=[],a=Rr.empty();Ys(n,(l,c)=>{const f=$m(e,l,r);c=rr(c);const h=i.Nu(f);if(c instanceof wh)s.push(f);else{const d=xu(c,h);d!=null&&(s.push(f),a.set(f,d))}});const o=new $r(s);return new gw(a,o,i.fieldTransforms)}function CO(t,e,r,n,i,s){const a=t.Qu(1,e,r),o=[Yd(e,n,r)],l=[i];if(s.length%2!=0)throw new ve(ee.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)o.push(Yd(e,s[d])),l.push(s[d+1]);const c=[],f=Rr.empty();for(let d=o.length-1;d>=0;--d)if(!xw(c,o[d])){const m=o[d];let _=l[d];_=rr(_);const g=a.Nu(m);if(_ instanceof wh)c.push(m);else{const w=xu(_,g);w!=null&&(c.push(m),f.set(m,w))}}const h=new $r(c);return new gw(f,h,a.fieldTransforms)}function RO(t,e,r,n=!1){return xu(r,t.Qu(n?4:3,e))}function xu(t,e){if(yw(t=rr(t)))return Hm("Unsupported field value:",e,t),_w(t,e);if(t instanceof Th)return function(n,i){if(!vw(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=xu(o,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=rr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return xP(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Lt.fromDate(n);return{timestampValue:Af(i.serializer,s)}}if(n instanceof Lt){const s=new Lt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Af(i.serializer,s)}}if(n instanceof Um)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof oo)return{bytesValue:VT(i.serializer,n._byteString)};if(n instanceof Er){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Im(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof bm)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return wm(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${yh(n)}`)}(t,e)}function _w(t,e){const r={};return fT(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ys(t,(n,i)=>{const s=xu(i,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function yw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Lt||t instanceof Um||t instanceof oo||t instanceof Er||t instanceof Th||t instanceof bm)}function Hm(t,e,r){if(!yw(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=yh(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function Yd(t,e,r){if((e=rr(e))instanceof Eh)return e._internalPath;if(typeof e=="string")return $m(t,e);throw Rf("Field path arguments must be of type string or ",t,!1,void 0,r)}const kO=new RegExp("[~\\*/\\[\\]]");function $m(t,e,r){if(e.search(kO)>=0)throw Rf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Eh(...e.split("."))._internalPath}catch{throw Rf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Rf(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new ve(ee.INVALID_ARGUMENT,o+t+l)}function xw(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ew{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Er(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new PO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Gm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class PO extends Ew{data(){return super.data()}}function Gm(t,e){return typeof e=="string"?$m(t,e):e instanceof Eh?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NO(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ve(ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Km{}class OO extends Km{}function Jd(t,e,...r){let n=[];e instanceof Km&&n.push(e),n=n.concat(r),function(s){const a=s.filter(l=>l instanceof qm).length,o=s.filter(l=>l instanceof Sh).length;if(a>1||a>0&&o>0)throw new ve(ee.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class Sh extends OO{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Sh(e,r,n)}_apply(e){const r=this._parse(e);return Tw(e._query,r),new _o(e.firestore,e.converter,jd(e._query,r))}_parse(e){const r=zm(e.firestore);return function(s,a,o,l,c,f,h){let d;if(c.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new ve(ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){d_(h,f);const m=[];for(const _ of h)m.push(h_(l,s,_));d={arrayValue:{values:m}}}else d=h_(l,s,h)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||d_(h,f),d=RO(o,a,h,f==="in"||f==="not-in");return Ct.create(c,f,d)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function gl(t,e,r){const n=e,i=Gm("where",t);return Sh._create(i,n,r)}class qm extends Km{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new qm(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Sn.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)Tw(a,l),a=jd(a,l)}(e._query,r),new _o(e.firestore,e.converter,jd(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function h_(t,e,r){if(typeof(r=rr(r))=="string"){if(r==="")throw new ve(ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!xT(e)&&r.indexOf("/")!==-1)throw new ve(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(ot.fromString(r));if(!Se.isDocumentKey(n))throw new ve(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Fv(t,new Se(n))}if(r instanceof Er)return Fv(t,r._key);throw new ve(ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${yh(r)}.`)}function d_(t,e){if(!Array.isArray(t)||t.length===0)throw new ve(ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Tw(t,e){const r=function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new ve(ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ve(ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class DO{convertValue(e,r="none"){switch($s(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Et(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Hs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ke()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Ys(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>Et(a.doubleValue));return new bm(s)}convertGeoPoint(e){return new Um(Et(e.latitude),Et(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=_m(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Wl(e));default:return null}}convertTimestamp(e){const r=ns(e);return new Lt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=ot.fromString(e);Je(WT(n));const i=new Hl(n.get(1),n.get(3)),s=new Se(n.popFirst(5));return i.isEqual(r)||pi(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FO(t,e,r){let n;return n=t?t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ww extends Ew{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new jc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Gm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class jc extends ww{data(e={}){return super.data(e)}}class LO{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new el(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new jc(this._firestore,this._userDataWriter,n.key,n,new el(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new ve(ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new jc(i._firestore,i._userDataWriter,o.doc.key,o.doc,new el(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new jc(i._firestore,i._userDataWriter,o.doc.key,o.doc,new el(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,f=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),f=a.indexOf(o.doc.key)),{type:MO(o.type),doc:l,oldIndex:c,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function MO(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ke()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sw(t){t=gi(t,Er);const e=gi(t.firestore,yu);return gO(Bm(e),t._key).then(r=>VO(e,t,r))}class Aw extends DO{constructor(e){super(),this.firestore=e}convertBytes(e){return new oo(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Er(this.firestore,null,r)}}function Zd(t){t=gi(t,_o);const e=gi(t.firestore,yu),r=Bm(e),n=new Aw(e);return NO(t._query),vO(r,t._query).then(i=>new LO(e,n,t,i))}function ep(t,e,r){t=gi(t,Er);const n=gi(t.firestore,yu),i=FO(t.converter,e);return Iw(n,[AO(zm(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Mn.none())])}function p_(t,e,r,...n){t=gi(t,Er);const i=gi(t.firestore,yu),s=zm(i);let a;return a=typeof(e=rr(e))=="string"||e instanceof Eh?CO(s,"updateDoc",t._key,e,r,n):IO(s,"updateDoc",t._key,e),Iw(i,[a.toMutation(t._key,Mn.exists(!0))])}function Iw(t,e){return function(n,i){const s=new ii;return n.asyncQueue.enqueueAndForget(async()=>sO(await mO(n),i,s)),s.promise}(Bm(t),e)}function VO(t,e,r){const n=r.docs.get(e._key),i=new Aw(t);return new ww(t,i,e._key,n,new el(r.hasPendingWrites,r.fromCache),e.converter)}function tp(){return new Wm("serverTimestamp")}(function(e,r=!0){(function(i){mo=i})(ho),Za(new js("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new yu(new Vk(n.getProvider("auth-internal")),new jk(n.getProvider("app-check-internal")),function(c,f){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ve(ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Hl(c.options.projectId,f)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),Ji(kv,"4.7.3",e),Ji(kv,"4.7.3","esm2017")})();/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var kf={};kf.version="0.18.5";var Cw=1252,BO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Rw=function(t){BO.indexOf(t)!=-1&&(Cw=t)};function UO(){Rw(1252)}var Xl=function(t){Rw(t)};function bO(){Xl(1200),UO()}var dc=function(e){return String.fromCharCode(e)},m_=function(e){return String.fromCharCode(e)},Pf,bi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ql(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),s=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,i=t.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=bi.charAt(s)+bi.charAt(a)+bi.charAt(o)+bi.charAt(l);return e}function vi(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=bi.indexOf(t.charAt(c++)),a=bi.indexOf(t.charAt(c++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=bi.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=bi.indexOf(t.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Ge=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ei=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Gs(t){return Ge?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function g_(t){return Ge?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var vn=function(e){return Ge?Ei(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Ah(t){if(typeof ArrayBuffer>"u")return vn(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Eu(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function jO(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var Qt=Ge?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Ei(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function zO(t){for(var e=[],r=0,n=t.length+250,i=Gs(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Gs(65535),n=65530)}return e.push(i.slice(0,r)),Qt(e)}var vl=/\u0000/g,pc=/[\u0001-\u0006]/g;function za(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function _n(t,e){var r=""+t;return r.length>=e?r:yt("0",e-r.length)+r}function Xm(t,e){var r=""+t;return r.length>=e?r:yt(" ",e-r.length)+r}function Nf(t,e){var r=""+t;return r.length>=e?r:r+yt(" ",e-r.length)}function WO(t,e){var r=""+Math.round(t);return r.length>=e?r:yt("0",e-r.length)+r}function HO(t,e){var r=""+t;return r.length>=e?r:yt("0",e-r.length)+r}var v_=Math.pow(2,32);function ha(t,e){if(t>v_||t<-v_)return WO(t,e);var r=Math.round(t);return HO(r,e)}function Of(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var __=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],I0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function $O(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var xt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},y_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},GO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Df(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,c=0,f=0,h=Math.floor(i);c<e&&(h=Math.floor(i),o=h*a+s,f=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=c,c=f;if(f>e&&(c>e?(f=l,o=s):(f=c,o=a)),!r)return[0,n*o,f];var d=Math.floor(n*o/f);return[d,n*o-d*f,f]}function mc(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=ZO(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var kw=new Date(1899,11,31,0,0,0),KO=kw.getTime(),qO=new Date(1900,2,1,0,0,0);function Pw(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=qO&&(r+=24*60*60*1e3),(r-(KO+(t.getTimezoneOffset()-kw.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Qm(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function XO(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function QO(t){var e=t<0?12:11,r=Qm(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function YO(t){var e=Qm(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function JO(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=QO(t):e===10?r=t.toFixed(10).substr(0,12):r=YO(t),Qm(XO(r.toUpperCase()))}function rp(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):JO(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ss(14,Pw(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function ZO(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function e3(t,e,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return I0[r.m-1][1];case 5:return I0[r.m-1][0];default:return I0[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return __[r.q][0];default:return __[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?_n(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=_n(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?_n(l,c):"";return f}function ji(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var Nw=/%/g;function t3(t,e,r){var n=e.replace(Nw,""),i=e.length-n.length;return si(t,n,r*Math.pow(10,2*i))+yt("%",i)}function r3(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return si(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Ow(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Ow(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Dw=/# (\?+)( ?)\/( ?)(\d+)/;function n3(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?yt(" ",t[1].length+1+t[4].length):Xm(a,t[1].length)+t[2]+"/"+t[3]+_n(o,t[4].length))}function i3(t,e,r){return r+(e===0?"":""+e)+yt(" ",t[1].length+2+t[4].length)}var Fw=/^#*0*\.([0#]+)/,Lw=/\).*[0#]/,Mw=/\(###\) ###\\?-####/;function _r(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function x_(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function E_(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function s3(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function a3(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Zr(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Lw)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Zr("n",n,r):"("+Zr("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return r3(t,e,r);if(e.indexOf("%")!==-1)return t3(t,e,r);if(e.indexOf("E")!==-1)return Ow(e,r);if(e.charCodeAt(0)===36)return"$"+Zr(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+ha(l,e.length);if(e.match(/^[#?]+$/))return i=ha(r,0),i==="0"&&(i=""),i.length>e.length?i:_r(e.substr(0,e.length-i.length))+i;if(s=e.match(Dw))return n3(s,l,c);if(e.match(/^#+0+$/))return c+ha(l,e.length-e.indexOf("0"));if(s=e.match(Fw))return i=x_(r,s[1].length).replace(/^([^\.]+)$/,"$1."+_r(s[1])).replace(/\.$/,"."+_r(s[1])).replace(/\.(\d*)$/,function(_,g){return"."+g+yt("0",_r(s[1]).length-g.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+x_(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+ji(ha(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Zr(t,e,-r):ji(""+(Math.floor(r)+s3(r,s[1].length)))+"."+_n(E_(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Zr(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=za(Zr(t,e.replace(/[\\-]/g,""),r)),a=0,za(za(e.replace(/\\/g,"")).replace(/[0#]/g,function(_){return a<i.length?i.charAt(a++):_==="0"?"0":""}));if(e.match(Mw))return i=Zr(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Df(l,Math.pow(10,a)-1,!1),i=""+c,f=si("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Nf(o[2],a),f.length<s[4].length&&(f=_r(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Df(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Xm(o[1],a)+s[2]+"/"+s[3]+Nf(o[2],a):yt(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=ha(r,0),e.length<=i.length?i:_r(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return _r(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=E_(r,s[1].length),r<0?"-"+Zr(t,e,-r):ji(a3(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?_n(0,3-_.length):"")+_})+"."+_n(a,s[1].length);switch(e){case"###,##0.00":return Zr(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=ji(ha(l,0));return m!=="0"?c+m:"";case"###,###.00":return Zr(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Zr(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function o3(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return si(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function l3(t,e,r){var n=e.replace(Nw,""),i=e.length-n.length;return si(t,n,r*Math.pow(10,2*i))+yt("%",i)}function Vw(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Vw(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Cn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Lw)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Cn("n",n,r):"("+Cn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return o3(t,e,r);if(e.indexOf("%")!==-1)return l3(t,e,r);if(e.indexOf("E")!==-1)return Vw(e,r);if(e.charCodeAt(0)===36)return"$"+Cn(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+_n(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:_r(e.substr(0,e.length-i.length))+i;if(s=e.match(Dw))return i3(s,l,c);if(e.match(/^#+0+$/))return c+_n(l,e.length-e.indexOf("0"));if(s=e.match(Fw))return i=(""+r).replace(/^([^\.]+)$/,"$1."+_r(s[1])).replace(/\.$/,"."+_r(s[1])),i=i.replace(/\.(\d*)$/,function(_,g){return"."+g+yt("0",_r(s[1]).length-g.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+ji(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Cn(t,e,-r):ji(""+r)+"."+yt("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Cn(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=za(Cn(t,e.replace(/[\\-]/g,""),r)),a=0,za(za(e.replace(/\\/g,"")).replace(/[0#]/g,function(_){return a<i.length?i.charAt(a++):_==="0"?"0":""}));if(e.match(Mw))return i=Cn(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Df(l,Math.pow(10,a)-1,!1),i=""+c,f=si("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Nf(o[2],a),f.length<s[4].length&&(f=_r(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Df(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Xm(o[1],a)+s[2]+"/"+s[3]+Nf(o[2],a):yt(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:_r(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return _r(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Cn(t,e,-r):ji(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?_n(0,3-_.length):"")+_})+"."+_n(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=ji(""+l);return m!=="0"?c+m:"";default:if(e.match(/\.[0#?]*$/))return Cn(t,e.slice(0,e.lastIndexOf(".")),r)+_r(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function si(t,e,r){return(r|0)===r?Cn(t,e,r):Zr(t,e,r)}function u3(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var Bw=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Uw(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Of(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(Bw))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function c3(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",c,f,h,d="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Of(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var m=t.charAt(++a),_=m==="("||m===")"?m:"t";i[i.length]={t:_,v:m},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=mc(e,r,t.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=mc(e,r),c==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var g={t:o,v:o};if(c==null&&(c=mc(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(g.v=c.H>=12?"P":"A"),g.t="T",d="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(g.v=c.H>=12?"PM":"AM"),g.t="T",a+=5,d="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(g.v=c.H>=12?"":""),g.t="T",a+=5,d="h"):(g.t="t",++a),c==null&&g.t==="T")return"";i[i.length]=g,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Bw)){if(c==null&&(c=mc(e,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Uw(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var w=0,S=0,x;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=d,l="h",w<1&&(w=1);break;case"s":(x=i[a].v.match(/\.0+$/))&&(S=Math.max(S,x[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[a].v.match(/[Hh]/)&&(w=1),w<2&&i[a].v.match(/[Mm]/)&&(w=2),w<3&&i[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var I="",V;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=e3(i[a].t.charCodeAt(0),i[a].v,c,S),i[a].t="t";break;case"n":case"?":for(V=a+1;i[V]!=null&&((o=i[V].t)==="?"||o==="D"||(o===" "||o==="t")&&i[V+1]!=null&&(i[V+1].t==="?"||i[V+1].t==="t"&&i[V+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[V].v==="/"||i[V].v===" "&&i[V+1]!=null&&i[V+1].t=="?"));)i[a].v+=i[V].v,i[V]={v:"",t:";"},++V;I+=i[a].v,a=V-1;break;case"G":i[a].t="t",i[a].v=rp(e,r);break}var b="",H,E;if(I.length>0){I.charCodeAt(0)==40?(H=e<0&&I.charCodeAt(0)===45?-e:e,E=si("n",I,H)):(H=e<0&&n>1?-e:e,E=si("n",I,H),H<0&&i[0]&&i[0].t=="t"&&(E=E.substr(1),i[0].v="-"+i[0].v)),V=E.length-1;var y=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){y=a;break}var T=i.length;if(y===i.length&&E.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(V>=i[a].v.length-1?(V-=i[a].v.length,i[a].v=E.substr(V+1,i[a].v.length)):V<0?i[a].v="":(i[a].v=E.substr(0,V+1),V=-1),i[a].t="t",T=a);V>=0&&T<i.length&&(i[T].v=E.substr(0,V+1)+i[T].v)}else if(y!==i.length&&E.indexOf("E")===-1){for(V=E.indexOf(".")-1,a=y;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===y?i[a].v.indexOf(".")-1:i[a].v.length-1,b=i[a].v.substr(f+1);f>=0;--f)V>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(b=E.charAt(V--)+b);i[a].v=b,i[a].t="t",T=a}for(V>=0&&T<i.length&&(i[T].v=E.substr(0,V+1)+i[T].v),V=E.indexOf(".")+1,a=y;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==y)){for(f=i[a].v.indexOf(".")>-1&&a===y?i[a].v.indexOf(".")+1:0,b=i[a].v.substr(0,f);f<i[a].v.length;++f)V<E.length&&(b+=E.charAt(V++));i[a].v=b,i[a].t="t",T=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(H=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=si(i[a].t,i[a].v,H),i[a].t="t");var C="";for(a=0;a!==i.length;++a)i[a]!=null&&(C+=i[a].v);return C}var T_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function w_(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function f3(t,e){var r=u3(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(T_),o=r[1].match(T_);return w_(e,a)?[n,r[0]]:w_(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function ss(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:xt)[t],n==null&&(n=r.table&&r.table[y_[t]]||xt[y_[t]]),n==null&&(n=GO[t]||"General");break}if(Of(n,0))return rp(e,r);e instanceof Date&&(e=Pw(e,r.date1904));var i=f3(n,e);if(Of(i[1]))return rp(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return c3(i[1],e,r,i[0])}function bw(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(xt[r]==null){e<0&&(e=r);continue}if(xt[r]==t){e=r;break}}e<0&&(e=391)}return xt[e]=t,e}function Ih(t){for(var e=0;e!=392;++e)t[e]!==void 0&&bw(t[e],e)}function Ch(){xt=$O()}var jw=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function h3(t){var e=typeof t=="number"?xt[t]:t;return e=e.replace(jw,"(\\d+)"),new RegExp("^"+e+"$")}function d3(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(jw)||[]).forEach(function(h,d){var m=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":a=m;break;case"s":l=m;break;case"m":a>=0?o=m:i=m;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?f:c+"T"+f}var p3=function(){var t={};t.version="1.2.0";function e(){for(var E=0,y=new Array(256),T=0;T!=256;++T)E=T,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,y[T]=E;return typeof Int32Array<"u"?new Int32Array(y):y}var r=e();function n(E){var y=0,T=0,C=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(C=0;C!=256;++C)N[C]=E[C];for(C=0;C!=256;++C)for(T=E[C],y=256+C;y<4096;y+=256)T=N[y]=T>>>8^E[T&255];var L=[];for(C=1;C!=16;++C)L[C-1]=typeof Int32Array<"u"?N.subarray(C*256,C*256+256):N.slice(C*256,C*256+256);return L}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],f=i[5],h=i[6],d=i[7],m=i[8],_=i[9],g=i[10],w=i[11],S=i[12],x=i[13],I=i[14];function V(E,y){for(var T=y^-1,C=0,N=E.length;C<N;)T=T>>>8^r[(T^E.charCodeAt(C++))&255];return~T}function b(E,y){for(var T=y^-1,C=E.length-15,N=0;N<C;)T=I[E[N++]^T&255]^x[E[N++]^T>>8&255]^S[E[N++]^T>>16&255]^w[E[N++]^T>>>24]^g[E[N++]]^_[E[N++]]^m[E[N++]]^d[E[N++]]^h[E[N++]]^f[E[N++]]^c[E[N++]]^l[E[N++]]^o[E[N++]]^a[E[N++]]^s[E[N++]]^r[E[N++]];for(C+=15;N<C;)T=T>>>8^r[(T^E[N++])&255];return~T}function H(E,y){for(var T=y^-1,C=0,N=E.length,L=0,P=0;C<N;)L=E.charCodeAt(C++),L<128?T=T>>>8^r[(T^L)&255]:L<2048?(T=T>>>8^r[(T^(192|L>>6&31))&255],T=T>>>8^r[(T^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,P=E.charCodeAt(C++)&1023,T=T>>>8^r[(T^(240|L>>8&7))&255],T=T>>>8^r[(T^(128|L>>2&63))&255],T=T>>>8^r[(T^(128|P>>6&15|(L&3)<<4))&255],T=T>>>8^r[(T^(128|P&63))&255]):(T=T>>>8^r[(T^(224|L>>12&15))&255],T=T>>>8^r[(T^(128|L>>6&63))&255],T=T>>>8^r[(T^(128|L&63))&255]);return~T}return t.table=r,t.bstr=V,t.buf=b,t.str=H,t}(),et=function(){var e={};e.version="1.2.1";function r(A,D){for(var k=A.split("/"),O=D.split("/"),F=0,M=0,G=Math.min(k.length,O.length);F<G;++F){if(M=k[F].length-O[F].length)return M;if(k[F]!=O[F])return k[F]<O[F]?-1:1}return k.length-O.length}function n(A){if(A.charAt(A.length-1)=="/")return A.slice(0,-1).indexOf("/")===-1?A:n(A.slice(0,-1));var D=A.lastIndexOf("/");return D===-1?A:A.slice(0,D+1)}function i(A){if(A.charAt(A.length-1)=="/")return i(A.slice(0,-1));var D=A.lastIndexOf("/");return D===-1?A:A.slice(D+1)}function s(A,D){typeof D=="string"&&(D=new Date(D));var k=D.getHours();k=k<<6|D.getMinutes(),k=k<<5|D.getSeconds()>>>1,A.write_shift(2,k);var O=D.getFullYear()-1980;O=O<<4|D.getMonth()+1,O=O<<5|D.getDate(),A.write_shift(2,O)}function a(A){var D=A.read_shift(2)&65535,k=A.read_shift(2)&65535,O=new Date,F=k&31;k>>>=5;var M=k&15;k>>>=4,O.setMilliseconds(0),O.setFullYear(k+1980),O.setMonth(M-1),O.setDate(F);var G=D&31;D>>>=5;var Y=D&63;return D>>>=6,O.setHours(D),O.setMinutes(Y),O.setSeconds(G<<1),O}function o(A){jr(A,0);for(var D={},k=0;A.l<=A.length-4;){var O=A.read_shift(2),F=A.read_shift(2),M=A.l+F,G={};switch(O){case 21589:k=A.read_shift(1),k&1&&(G.mtime=A.read_shift(4)),F>5&&(k&2&&(G.atime=A.read_shift(4)),k&4&&(G.ctime=A.read_shift(4))),G.mtime&&(G.mt=new Date(G.mtime*1e3));break}A.l=M,D[O]=G}return D}var l;function c(){return l||(l={})}function f(A,D){if(A[0]==80&&A[1]==75)return Co(A,D);if((A[0]|32)==109&&(A[1]|32)==105)return Ou(A,D);if(A.length<512)throw new Error("CFB file size "+A.length+" < 512");var k=3,O=512,F=0,M=0,G=0,Y=0,K=0,q=[],X=A.slice(0,512);jr(X,0);var ne=h(X);switch(k=ne[0],k){case 3:O=512;break;case 4:O=4096;break;case 0:if(ne[1]==0)return Co(A,D);default:throw new Error("Major Version: Expected 3 or 4 saw "+k)}O!==512&&(X=A.slice(0,O),jr(X,28));var ce=A.slice(0,O);d(X,k);var pe=X.read_shift(4,"i");if(k===3&&pe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+pe);X.l+=4,G=X.read_shift(4,"i"),X.l+=4,X.chk("00100000","Mini Stream Cutoff Size: "),Y=X.read_shift(4,"i"),F=X.read_shift(4,"i"),K=X.read_shift(4,"i"),M=X.read_shift(4,"i");for(var ae=-1,de=0;de<109&&(ae=X.read_shift(4,"i"),!(ae<0));++de)q[de]=ae;var Ce=m(A,O);w(K,M,Ce,O,q);var tt=x(Ce,G,q,O);tt[G].name="!Directory",F>0&&Y!==P&&(tt[Y].name="!MiniFAT"),tt[q[0]].name="!FAT",tt.fat_addrs=q,tt.ssz=O;var Ke={},ct=[],Hn=[],_s=[];I(G,tt,Ce,ct,F,Ke,Hn,Y),_(Hn,_s,ct),ct.shift();var Si={FileIndex:Hn,FullPaths:_s};return D&&D.raw&&(Si.raw={header:ce,sectors:Ce}),Si}function h(A){if(A[A.l]==80&&A[A.l+1]==75)return[0,0];A.chk(Ie,"Header Signature: "),A.l+=16;var D=A.read_shift(2,"u");return[A.read_shift(2,"u"),D]}function d(A,D){var k=9;switch(A.l+=2,k=A.read_shift(2)){case 9:if(D!=3)throw new Error("Sector Shift: Expected 9 saw "+k);break;case 12:if(D!=4)throw new Error("Sector Shift: Expected 12 saw "+k);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+k)}A.chk("0600","Mini Sector Shift: "),A.chk("000000000000","Reserved: ")}function m(A,D){for(var k=Math.ceil(A.length/D)-1,O=[],F=1;F<k;++F)O[F-1]=A.slice(F*D,(F+1)*D);return O[k-1]=A.slice(k*D),O}function _(A,D,k){for(var O=0,F=0,M=0,G=0,Y=0,K=k.length,q=[],X=[];O<K;++O)q[O]=X[O]=O,D[O]=k[O];for(;Y<X.length;++Y)O=X[Y],F=A[O].L,M=A[O].R,G=A[O].C,q[O]===O&&(F!==-1&&q[F]!==F&&(q[O]=q[F]),M!==-1&&q[M]!==M&&(q[O]=q[M])),G!==-1&&(q[G]=O),F!==-1&&O!=q[O]&&(q[F]=q[O],X.lastIndexOf(F)<Y&&X.push(F)),M!==-1&&O!=q[O]&&(q[M]=q[O],X.lastIndexOf(M)<Y&&X.push(M));for(O=1;O<K;++O)q[O]===O&&(M!==-1&&q[M]!==M?q[O]=q[M]:F!==-1&&q[F]!==F&&(q[O]=q[F]));for(O=1;O<K;++O)if(A[O].type!==0){if(Y=O,Y!=q[Y])do Y=q[Y],D[O]=D[Y]+"/"+D[O];while(Y!==0&&q[Y]!==-1&&Y!=q[Y]);q[O]=-1}for(D[0]+="/",O=1;O<K;++O)A[O].type!==2&&(D[O]+="/")}function g(A,D,k){for(var O=A.start,F=A.size,M=[],G=O;k&&F>0&&G>=0;)M.push(D.slice(G*L,G*L+L)),F-=L,G=Ss(k,G*4);return M.length===0?J(0):Qt(M).slice(0,A.size)}function w(A,D,k,O,F){var M=P;if(A===P){if(D!==0)throw new Error("DIFAT chain shorter than expected")}else if(A!==-1){var G=k[A],Y=(O>>>2)-1;if(!G)return;for(var K=0;K<Y&&(M=Ss(G,K*4))!==P;++K)F.push(M);w(Ss(G,O-4),D-1,k,O,F)}}function S(A,D,k,O,F){var M=[],G=[];F||(F=[]);var Y=O-1,K=0,q=0;for(K=D;K>=0;){F[K]=!0,M[M.length]=K,G.push(A[K]);var X=k[Math.floor(K*4/O)];if(q=K*4&Y,O<4+q)throw new Error("FAT boundary crossed: "+K+" 4 "+O);if(!A[X])break;K=Ss(A[X],q)}return{nodes:M,data:N_([G])}}function x(A,D,k,O){var F=A.length,M=[],G=[],Y=[],K=[],q=O-1,X=0,ne=0,ce=0,pe=0;for(X=0;X<F;++X)if(Y=[],ce=X+D,ce>=F&&(ce-=F),!G[ce]){K=[];var ae=[];for(ne=ce;ne>=0;){ae[ne]=!0,G[ne]=!0,Y[Y.length]=ne,K.push(A[ne]);var de=k[Math.floor(ne*4/O)];if(pe=ne*4&q,O<4+pe)throw new Error("FAT boundary crossed: "+ne+" 4 "+O);if(!A[de]||(ne=Ss(A[de],pe),ae[ne]))break}M[ce]={nodes:Y,data:N_([K])}}return M}function I(A,D,k,O,F,M,G,Y){for(var K=0,q=O.length?2:0,X=D[A].data,ne=0,ce=0,pe;ne<X.length;ne+=128){var ae=X.slice(ne,ne+128);jr(ae,64),ce=ae.read_shift(2),pe=tg(ae,0,ce-q),O.push(pe);var de={name:pe,type:ae.read_shift(1),color:ae.read_shift(1),L:ae.read_shift(4,"i"),R:ae.read_shift(4,"i"),C:ae.read_shift(4,"i"),clsid:ae.read_shift(16),state:ae.read_shift(4,"i"),start:0,size:0},Ce=ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2);Ce!==0&&(de.ct=V(ae,ae.l-8));var tt=ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2)+ae.read_shift(2);tt!==0&&(de.mt=V(ae,ae.l-8)),de.start=ae.read_shift(4,"i"),de.size=ae.read_shift(4,"i"),de.size<0&&de.start<0&&(de.size=de.type=0,de.start=P,de.name=""),de.type===5?(K=de.start,F>0&&K!==P&&(D[K].name="!StreamData")):de.size>=4096?(de.storage="fat",D[de.start]===void 0&&(D[de.start]=S(k,de.start,D.fat_addrs,D.ssz)),D[de.start].name=de.name,de.content=D[de.start].data.slice(0,de.size)):(de.storage="minifat",de.size<0?de.size=0:K!==P&&de.start!==P&&D[K]&&(de.content=g(de,D[K].data,(D[Y]||{}).data))),de.content&&jr(de.content,0),M[pe]=de,G.push(de)}}function V(A,D){return new Date((Wr(A,D+4)/1e7*Math.pow(2,32)+Wr(A,D)/1e7-11644473600)*1e3)}function b(A,D){return c(),f(l.readFileSync(A),D)}function H(A,D){var k=D&&D.type;switch(k||Ge&&Buffer.isBuffer(A)&&(k="buffer"),k||"base64"){case"file":return b(A,D);case"base64":return f(vn(vi(A)),D);case"binary":return f(vn(A),D)}return f(A,D)}function E(A,D){var k=D||{},O=k.root||"Root Entry";if(A.FullPaths||(A.FullPaths=[]),A.FileIndex||(A.FileIndex=[]),A.FullPaths.length!==A.FileIndex.length)throw new Error("inconsistent CFB structure");A.FullPaths.length===0&&(A.FullPaths[0]=O+"/",A.FileIndex[0]={name:O,type:5}),k.CLSID&&(A.FileIndex[0].clsid=k.CLSID),y(A)}function y(A){var D="Sh33tJ5";if(!et.find(A,"/"+D)){var k=J(4);k[0]=55,k[1]=k[3]=50,k[2]=54,A.FileIndex.push({name:D,type:2,content:k,size:4,L:69,R:69,C:69}),A.FullPaths.push(A.FullPaths[0]+D),T(A)}}function T(A,D){E(A);for(var k=!1,O=!1,F=A.FullPaths.length-1;F>=0;--F){var M=A.FileIndex[F];switch(M.type){case 0:O?k=!0:(A.FileIndex.pop(),A.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(M.R*M.L*M.C)&&(k=!0),M.R>-1&&M.L>-1&&M.R==M.L&&(k=!0);break;default:k=!0;break}}if(!(!k&&!D)){var G=new Date(1987,1,19),Y=0,K=Object.create?Object.create(null):{},q=[];for(F=0;F<A.FullPaths.length;++F)K[A.FullPaths[F]]=!0,A.FileIndex[F].type!==0&&q.push([A.FullPaths[F],A.FileIndex[F]]);for(F=0;F<q.length;++F){var X=n(q[F][0]);O=K[X],O||(q.push([X,{name:i(X).replace("/",""),type:1,clsid:ht,ct:G,mt:G,content:null}]),K[X]=!0)}for(q.sort(function(pe,ae){return r(pe[0],ae[0])}),A.FullPaths=[],A.FileIndex=[],F=0;F<q.length;++F)A.FullPaths[F]=q[F][0],A.FileIndex[F]=q[F][1];for(F=0;F<q.length;++F){var ne=A.FileIndex[F],ce=A.FullPaths[F];if(ne.name=i(ce).replace("/",""),ne.L=ne.R=ne.C=-(ne.color=1),ne.size=ne.content?ne.content.length:0,ne.start=0,ne.clsid=ne.clsid||ht,F===0)ne.C=q.length>1?1:-1,ne.size=0,ne.type=5;else if(ce.slice(-1)=="/"){for(Y=F+1;Y<q.length&&n(A.FullPaths[Y])!=ce;++Y);for(ne.C=Y>=q.length?-1:Y,Y=F+1;Y<q.length&&n(A.FullPaths[Y])!=n(ce);++Y);ne.R=Y>=q.length?-1:Y,ne.type=1}else n(A.FullPaths[F+1]||"")==n(ce)&&(ne.R=F+1),ne.type=2}}}function C(A,D){var k=D||{};if(k.fileType=="mad")return Wt(A,k);switch(T(A),k.fileType){case"zip":return Ro(A,k)}var O=function(pe){for(var ae=0,de=0,Ce=0;Ce<pe.FileIndex.length;++Ce){var tt=pe.FileIndex[Ce];if(tt.content){var Ke=tt.content.length;Ke>0&&(Ke<4096?ae+=Ke+63>>6:de+=Ke+511>>9)}}for(var ct=pe.FullPaths.length+3>>2,Hn=ae+7>>3,_s=ae+127>>7,Si=Hn+de+ct+_s,An=Si+127>>7,oa=An<=109?0:Math.ceil((An-109)/127);Si+An+oa+127>>7>An;)oa=++An<=109?0:Math.ceil((An-109)/127);var Vr=[1,oa,An,_s,ct,de,ae,0];return pe.FileIndex[0].size=ae<<6,Vr[7]=(pe.FileIndex[0].start=Vr[0]+Vr[1]+Vr[2]+Vr[3]+Vr[4]+Vr[5])+(Vr[6]+7>>3),Vr}(A),F=J(O[7]<<9),M=0,G=0;{for(M=0;M<8;++M)F.write_shift(1,Ae[M]);for(M=0;M<8;++M)F.write_shift(2,0);for(F.write_shift(2,62),F.write_shift(2,3),F.write_shift(2,65534),F.write_shift(2,9),F.write_shift(2,6),M=0;M<3;++M)F.write_shift(2,0);for(F.write_shift(4,0),F.write_shift(4,O[2]),F.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),F.write_shift(4,0),F.write_shift(4,4096),F.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:P),F.write_shift(4,O[3]),F.write_shift(-4,O[1]?O[0]-1:P),F.write_shift(4,O[1]),M=0;M<109;++M)F.write_shift(-4,M<O[2]?O[1]+M:-1)}if(O[1])for(G=0;G<O[1];++G){for(;M<236+G*127;++M)F.write_shift(-4,M<O[2]?O[1]+M:-1);F.write_shift(-4,G===O[1]-1?P:G+1)}var Y=function(pe){for(G+=pe;M<G-1;++M)F.write_shift(-4,M+1);pe&&(++M,F.write_shift(-4,P))};for(G=M=0,G+=O[1];M<G;++M)F.write_shift(-4,$e.DIFSECT);for(G+=O[2];M<G;++M)F.write_shift(-4,$e.FATSECT);Y(O[3]),Y(O[4]);for(var K=0,q=0,X=A.FileIndex[0];K<A.FileIndex.length;++K)X=A.FileIndex[K],X.content&&(q=X.content.length,!(q<4096)&&(X.start=G,Y(q+511>>9)));for(Y(O[6]+7>>3);F.l&511;)F.write_shift(-4,$e.ENDOFCHAIN);for(G=M=0,K=0;K<A.FileIndex.length;++K)X=A.FileIndex[K],X.content&&(q=X.content.length,!(!q||q>=4096)&&(X.start=G,Y(q+63>>6)));for(;F.l&511;)F.write_shift(-4,$e.ENDOFCHAIN);for(M=0;M<O[4]<<2;++M){var ne=A.FullPaths[M];if(!ne||ne.length===0){for(K=0;K<17;++K)F.write_shift(4,0);for(K=0;K<3;++K)F.write_shift(4,-1);for(K=0;K<12;++K)F.write_shift(4,0);continue}X=A.FileIndex[M],M===0&&(X.start=X.size?X.start-1:P);var ce=M===0&&k.root||X.name;if(q=2*(ce.length+1),F.write_shift(64,ce,"utf16le"),F.write_shift(2,q),F.write_shift(1,X.type),F.write_shift(1,X.color),F.write_shift(-4,X.L),F.write_shift(-4,X.R),F.write_shift(-4,X.C),X.clsid)F.write_shift(16,X.clsid,"hex");else for(K=0;K<4;++K)F.write_shift(4,0);F.write_shift(4,X.state||0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,X.start),F.write_shift(4,X.size),F.write_shift(4,0)}for(M=1;M<A.FileIndex.length;++M)if(X=A.FileIndex[M],X.size>=4096)if(F.l=X.start+1<<9,Ge&&Buffer.isBuffer(X.content))X.content.copy(F,F.l,0,X.size),F.l+=X.size+511&-512;else{for(K=0;K<X.size;++K)F.write_shift(1,X.content[K]);for(;K&511;++K)F.write_shift(1,0)}for(M=1;M<A.FileIndex.length;++M)if(X=A.FileIndex[M],X.size>0&&X.size<4096)if(Ge&&Buffer.isBuffer(X.content))X.content.copy(F,F.l,0,X.size),F.l+=X.size+63&-64;else{for(K=0;K<X.size;++K)F.write_shift(1,X.content[K]);for(;K&63;++K)F.write_shift(1,0)}if(Ge)F.l=F.length;else for(;F.l<F.length;)F.write_shift(1,0);return F}function N(A,D){var k=A.FullPaths.map(function(K){return K.toUpperCase()}),O=k.map(function(K){var q=K.split("/");return q[q.length-(K.slice(-1)=="/"?2:1)]}),F=!1;D.charCodeAt(0)===47?(F=!0,D=k[0].slice(0,-1)+D):F=D.indexOf("/")!==-1;var M=D.toUpperCase(),G=F===!0?k.indexOf(M):O.indexOf(M);if(G!==-1)return A.FileIndex[G];var Y=!M.match(pc);for(M=M.replace(vl,""),Y&&(M=M.replace(pc,"!")),G=0;G<k.length;++G)if((Y?k[G].replace(pc,"!"):k[G]).replace(vl,"")==M||(Y?O[G].replace(pc,"!"):O[G]).replace(vl,"")==M)return A.FileIndex[G];return null}var L=64,P=-2,Ie="d0cf11e0a1b11ae1",Ae=[208,207,17,224,161,177,26,225],ht="00000000000000000000000000000000",$e={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:P,FREESECT:-1,HEADER_SIGNATURE:Ie,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ht,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ue(A,D,k){c();var O=C(A,k);l.writeFileSync(D,O)}function ye(A){for(var D=new Array(A.length),k=0;k<A.length;++k)D[k]=String.fromCharCode(A[k]);return D.join("")}function we(A,D){var k=C(A,D);switch(D&&D.type||"buffer"){case"file":return c(),l.writeFileSync(D.filename,k),k;case"binary":return typeof k=="string"?k:ye(k);case"base64":return Ql(typeof k=="string"?k:ye(k));case"buffer":if(Ge)return Buffer.isBuffer(k)?k:Ei(k);case"array":return typeof k=="string"?vn(k):k}return k}var De;function B(A){try{var D=A.InflateRaw,k=new D;if(k._processChunk(new Uint8Array([3,0]),k._finishFlushFlag),k.bytesRead)De=A;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function W(A,D){if(!De)return sa(A,D);var k=De.InflateRaw,O=new k,F=O._processChunk(A.slice(A.l),O._finishFlushFlag);return A.l+=O.bytesRead,F}function j(A){return De?De.deflateRawSync(A):wo(A)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Te(A){var D=(A<<1|A<<11)&139536|(A<<5|A<<15)&558144;return(D>>16|D>>8|D)&255}for(var xe=typeof Uint8Array<"u",he=xe?new Uint8Array(256):[],je=0;je<256;++je)he[je]=Te(je);function Fe(A,D){var k=he[A&255];return D<=8?k>>>8-D:(k=k<<8|he[A>>8&255],D<=16?k>>>16-D:(k=k<<8|he[A>>16&255],k>>>24-D))}function Pt(A,D){var k=D&7,O=D>>>3;return(A[O]|(k<=6?0:A[O+1]<<8))>>>k&3}function Be(A,D){var k=D&7,O=D>>>3;return(A[O]|(k<=5?0:A[O+1]<<8))>>>k&7}function Mr(A,D){var k=D&7,O=D>>>3;return(A[O]|(k<=4?0:A[O+1]<<8))>>>k&15}function it(A,D){var k=D&7,O=D>>>3;return(A[O]|(k<=3?0:A[O+1]<<8))>>>k&31}function _e(A,D){var k=D&7,O=D>>>3;return(A[O]|(k<=1?0:A[O+1]<<8))>>>k&127}function Ar(A,D,k){var O=D&7,F=D>>>3,M=(1<<k)-1,G=A[F]>>>O;return k<8-O||(G|=A[F+1]<<8-O,k<16-O)||(G|=A[F+2]<<16-O,k<24-O)||(G|=A[F+3]<<24-O),G&M}function Yr(A,D,k){var O=D&7,F=D>>>3;return O<=5?A[F]|=(k&7)<<O:(A[F]|=k<<O&255,A[F+1]=(k&7)>>8-O),D+3}function un(A,D,k){var O=D&7,F=D>>>3;return k=(k&1)<<O,A[F]|=k,D+1}function jn(A,D,k){var O=D&7,F=D>>>3;return k<<=O,A[F]|=k&255,k>>>=8,A[F+1]=k,D+8}function Cu(A,D,k){var O=D&7,F=D>>>3;return k<<=O,A[F]|=k&255,k>>>=8,A[F+1]=k&255,A[F+2]=k>>>8,D+16}function ds(A,D){var k=A.length,O=2*k>D?2*k:D+5,F=0;if(k>=D)return A;if(Ge){var M=g_(O);if(A.copy)A.copy(M);else for(;F<A.length;++F)M[F]=A[F];return M}else if(xe){var G=new Uint8Array(O);if(G.set)G.set(A);else for(;F<k;++F)G[F]=A[F];return G}return A.length=O,A}function Ir(A){for(var D=new Array(A),k=0;k<A;++k)D[k]=0;return D}function ps(A,D,k){var O=1,F=0,M=0,G=0,Y=0,K=A.length,q=xe?new Uint16Array(32):Ir(32);for(M=0;M<32;++M)q[M]=0;for(M=K;M<k;++M)A[M]=0;K=A.length;var X=xe?new Uint16Array(K):Ir(K);for(M=0;M<K;++M)q[F=A[M]]++,O<F&&(O=F),X[M]=0;for(q[0]=0,M=1;M<=O;++M)q[M+16]=Y=Y+q[M-1]<<1;for(M=0;M<K;++M)Y=A[M],Y!=0&&(X[M]=q[Y+16]++);var ne=0;for(M=0;M<K;++M)if(ne=A[M],ne!=0)for(Y=Fe(X[M],O)>>O-ne,G=(1<<O+4-ne)-1;G>=0;--G)D[Y|G<<ne]=ne&15|M<<4;return O}var wt=xe?new Uint16Array(512):Ir(512),Nt=xe?new Uint16Array(32):Ir(32);if(!xe){for(var Jr=0;Jr<512;++Jr)wt[Jr]=0;for(Jr=0;Jr<32;++Jr)Nt[Jr]=0}(function(){for(var A=[],D=0;D<32;D++)A.push(5);ps(A,Nt,32);var k=[];for(D=0;D<=143;D++)k.push(8);for(;D<=255;D++)k.push(9);for(;D<=279;D++)k.push(7);for(;D<=287;D++)k.push(8);ps(k,wt,288)})();var Ru=function(){for(var D=xe?new Uint8Array(32768):[],k=0,O=0;k<me.length-1;++k)for(;O<me[k+1];++O)D[O]=k;for(;O<32768;++O)D[O]=29;var F=xe?new Uint8Array(259):[];for(k=0,O=0;k<Z.length-1;++k)for(;O<Z[k+1];++O)F[O]=k;function M(Y,K){for(var q=0;q<Y.length;){var X=Math.min(65535,Y.length-q),ne=q+X==Y.length;for(K.write_shift(1,+ne),K.write_shift(2,X),K.write_shift(2,~X&65535);X-- >0;)K[K.l++]=Y[q++]}return K.l}function G(Y,K){for(var q=0,X=0,ne=xe?new Uint16Array(32768):[];X<Y.length;){var ce=Math.min(65535,Y.length-X);if(ce<10){for(q=Yr(K,q,+(X+ce==Y.length)),q&7&&(q+=8-(q&7)),K.l=q/8|0,K.write_shift(2,ce),K.write_shift(2,~ce&65535);ce-- >0;)K[K.l++]=Y[X++];q=K.l*8;continue}q=Yr(K,q,+(X+ce==Y.length)+2);for(var pe=0;ce-- >0;){var ae=Y[X];pe=(pe<<5^ae)&32767;var de=-1,Ce=0;if((de=ne[pe])&&(de|=X&-32768,de>X&&(de-=32768),de<X))for(;Y[de+Ce]==Y[X+Ce]&&Ce<250;)++Ce;if(Ce>2){ae=F[Ce],ae<=22?q=jn(K,q,he[ae+1]>>1)-1:(jn(K,q,3),q+=5,jn(K,q,he[ae-23]>>5),q+=3);var tt=ae<8?0:ae-4>>2;tt>0&&(Cu(K,q,Ce-Z[ae]),q+=tt),ae=D[X-de],q=jn(K,q,he[ae]>>3),q-=3;var Ke=ae<4?0:ae-2>>1;Ke>0&&(Cu(K,q,X-de-me[ae]),q+=Ke);for(var ct=0;ct<Ce;++ct)ne[pe]=X&32767,pe=(pe<<5^Y[X])&32767,++X;ce-=Ce-1}else ae<=143?ae=ae+48:q=un(K,q,1),q=jn(K,q,he[ae]),ne[pe]=X&32767,++X}q=jn(K,q,0)-1}return K.l=(q+7)/8|0,K.l}return function(K,q){return K.length<8?M(K,q):G(K,q)}}();function wo(A){var D=J(50+Math.floor(A.length*1.1)),k=Ru(A,D);return D.slice(0,k)}var ku=xe?new Uint16Array(32768):Ir(32768),Ti=xe?new Uint16Array(32768):Ir(32768),So=xe?new Uint16Array(128):Ir(128),Ao=1,ia=1;function Dh(A,D){var k=it(A,D)+257;D+=5;var O=it(A,D)+1;D+=5;var F=Mr(A,D)+4;D+=4;for(var M=0,G=xe?new Uint8Array(19):Ir(19),Y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],K=1,q=xe?new Uint8Array(8):Ir(8),X=xe?new Uint8Array(8):Ir(8),ne=G.length,ce=0;ce<F;++ce)G[U[ce]]=M=Be(A,D),K<M&&(K=M),q[M]++,D+=3;var pe=0;for(q[0]=0,ce=1;ce<=K;++ce)X[ce]=pe=pe+q[ce-1]<<1;for(ce=0;ce<ne;++ce)(pe=G[ce])!=0&&(Y[ce]=X[pe]++);var ae=0;for(ce=0;ce<ne;++ce)if(ae=G[ce],ae!=0){pe=he[Y[ce]]>>8-ae;for(var de=(1<<7-ae)-1;de>=0;--de)So[pe|de<<ae]=ae&7|ce<<3}var Ce=[];for(K=1;Ce.length<k+O;)switch(pe=So[_e(A,D)],D+=pe&7,pe>>>=3){case 16:for(M=3+Pt(A,D),D+=2,pe=Ce[Ce.length-1];M-- >0;)Ce.push(pe);break;case 17:for(M=3+Be(A,D),D+=3;M-- >0;)Ce.push(0);break;case 18:for(M=11+_e(A,D),D+=7;M-- >0;)Ce.push(0);break;default:Ce.push(pe),K<pe&&(K=pe);break}var tt=Ce.slice(0,k),Ke=Ce.slice(k);for(ce=k;ce<286;++ce)tt[ce]=0;for(ce=O;ce<30;++ce)Ke[ce]=0;return Ao=ps(tt,ku,286),ia=ps(Ke,Ti,30),D}function Fh(A,D){if(A[0]==3&&!(A[1]&3))return[Gs(D),2];for(var k=0,O=0,F=g_(D||1<<18),M=0,G=F.length>>>0,Y=0,K=0;!(O&1);){if(O=Be(A,k),k+=3,O>>>1)O>>1==1?(Y=9,K=5):(k=Dh(A,k),Y=Ao,K=ia);else{k&7&&(k+=8-(k&7));var q=A[k>>>3]|A[(k>>>3)+1]<<8;if(k+=32,q>0)for(!D&&G<M+q&&(F=ds(F,M+q),G=F.length);q-- >0;)F[M++]=A[k>>>3],k+=8;continue}for(;;){!D&&G<M+32767&&(F=ds(F,M+32767),G=F.length);var X=Ar(A,k,Y),ne=O>>>1==1?wt[X]:ku[X];if(k+=ne&15,ne>>>=4,!(ne>>>8&255))F[M++]=ne;else{if(ne==256)break;ne-=257;var ce=ne<8?0:ne-4>>2;ce>5&&(ce=0);var pe=M+Z[ne];ce>0&&(pe+=Ar(A,k,ce),k+=ce),X=Ar(A,k,K),ne=O>>>1==1?Nt[X]:Ti[X],k+=ne&15,ne>>>=4;var ae=ne<4?0:ne-2>>1,de=me[ne];for(ae>0&&(de+=Ar(A,k,ae),k+=ae),!D&&G<pe&&(F=ds(F,pe+100),G=F.length);M<pe;)F[M]=F[M-de],++M}}}return D?[F,k+7>>>3]:[F.slice(0,M),k+7>>>3]}function sa(A,D){var k=A.slice(A.l||0),O=Fh(k,D);return A.l+=O[1],O[0]}function Io(A,D){if(A)typeof console<"u"&&console.error(D);else throw new Error(D)}function Co(A,D){var k=A;jr(k,0);var O=[],F=[],M={FileIndex:O,FullPaths:F};E(M,{root:D.root});for(var G=k.length-4;(k[G]!=80||k[G+1]!=75||k[G+2]!=5||k[G+3]!=6)&&G>=0;)--G;k.l=G+4,k.l+=4;var Y=k.read_shift(2);k.l+=6;var K=k.read_shift(4);for(k.l=K,G=0;G<Y;++G){k.l+=20;var q=k.read_shift(4),X=k.read_shift(4),ne=k.read_shift(2),ce=k.read_shift(2),pe=k.read_shift(2);k.l+=8;var ae=k.read_shift(4),de=o(k.slice(k.l+ne,k.l+ne+ce));k.l+=ne+ce+pe;var Ce=k.l;k.l=ae+4,ms(k,q,X,M,de),k.l=Ce}return M}function ms(A,D,k,O,F){A.l+=2;var M=A.read_shift(2),G=A.read_shift(2),Y=a(A);if(M&8257)throw new Error("Unsupported ZIP encryption");for(var K=A.read_shift(4),q=A.read_shift(4),X=A.read_shift(4),ne=A.read_shift(2),ce=A.read_shift(2),pe="",ae=0;ae<ne;++ae)pe+=String.fromCharCode(A[A.l++]);if(ce){var de=o(A.slice(A.l,A.l+ce));(de[21589]||{}).mt&&(Y=de[21589].mt),((F||{})[21589]||{}).mt&&(Y=F[21589].mt)}A.l+=ce;var Ce=A.slice(A.l,A.l+q);switch(G){case 8:Ce=W(A,X);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+G)}var tt=!1;M&8&&(K=A.read_shift(4),K==134695760&&(K=A.read_shift(4),tt=!0),q=A.read_shift(4),X=A.read_shift(4)),q!=D&&Io(tt,"Bad compressed size: "+D+" != "+q),X!=k&&Io(tt,"Bad uncompressed size: "+k+" != "+X),Wn(O,pe,Ce,{unsafe:!0,mt:Y})}function Ro(A,D){var k=D||{},O=[],F=[],M=J(1),G=k.compression?8:0,Y=0,K=0,q=0,X=0,ne=0,ce=A.FullPaths[0],pe=ce,ae=A.FileIndex[0],de=[],Ce=0;for(K=1;K<A.FullPaths.length;++K)if(pe=A.FullPaths[K].slice(ce.length),ae=A.FileIndex[K],!(!ae.size||!ae.content||pe=="Sh33tJ5")){var tt=X,Ke=J(pe.length);for(q=0;q<pe.length;++q)Ke.write_shift(1,pe.charCodeAt(q)&127);Ke=Ke.slice(0,Ke.l),de[ne]=p3.buf(ae.content,0);var ct=ae.content;G==8&&(ct=j(ct)),M=J(30),M.write_shift(4,67324752),M.write_shift(2,20),M.write_shift(2,Y),M.write_shift(2,G),ae.mt?s(M,ae.mt):M.write_shift(4,0),M.write_shift(-4,de[ne]),M.write_shift(4,ct.length),M.write_shift(4,ae.content.length),M.write_shift(2,Ke.length),M.write_shift(2,0),X+=M.length,O.push(M),X+=Ke.length,O.push(Ke),X+=ct.length,O.push(ct),M=J(46),M.write_shift(4,33639248),M.write_shift(2,0),M.write_shift(2,20),M.write_shift(2,Y),M.write_shift(2,G),M.write_shift(4,0),M.write_shift(-4,de[ne]),M.write_shift(4,ct.length),M.write_shift(4,ae.content.length),M.write_shift(2,Ke.length),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(4,0),M.write_shift(4,tt),Ce+=M.l,F.push(M),Ce+=Ke.length,F.push(Ke),++ne}return M=J(22),M.write_shift(4,101010256),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,ne),M.write_shift(2,ne),M.write_shift(4,Ce),M.write_shift(4,X),M.write_shift(2,0),Qt([Qt(O),Qt(F),M])}var wi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function zn(A,D){if(A.ctype)return A.ctype;var k=A.name||"",O=k.match(/\.([^\.]+)$/);return O&&wi[O[1]]||D&&(O=(k=D).match(/[\.\\]([^\.\\])+$/),O&&wi[O[1]])?wi[O[1]]:"application/octet-stream"}function Pu(A){for(var D=Ql(A),k=[],O=0;O<D.length;O+=76)k.push(D.slice(O,O+76));return k.join(`\r
`)+`\r
`}function aa(A){var D=A.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(q){var X=q.charCodeAt(0).toString(16).toUpperCase();return"="+(X.length==1?"0"+X:X)});D=D.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),D.charAt(0)==`
`&&(D="=0D"+D.slice(1)),D=D.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var k=[],O=D.split(`\r
`),F=0;F<O.length;++F){var M=O[F];if(M.length==0){k.push("");continue}for(var G=0;G<M.length;){var Y=76,K=M.slice(G,G+Y);K.charAt(Y-1)=="="?Y--:K.charAt(Y-2)=="="?Y-=2:K.charAt(Y-3)=="="&&(Y-=3),K=M.slice(G,G+Y),G+=Y,G<M.length&&(K+="="),k.push(K)}}return k.join(`\r
`)}function Nu(A){for(var D=[],k=0;k<A.length;++k){for(var O=A[k];k<=A.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+A[++k];D.push(O)}for(var F=0;F<D.length;++F)D[F]=D[F].replace(/[=][0-9A-Fa-f]{2}/g,function(M){return String.fromCharCode(parseInt(M.slice(1),16))});return vn(D.join(`\r
`))}function gs(A,D,k){for(var O="",F="",M="",G,Y=0;Y<10;++Y){var K=D[Y];if(!K||K.match(/^\s*$/))break;var q=K.match(/^(.*?):\s*([^\s].*)$/);if(q)switch(q[1].toLowerCase()){case"content-location":O=q[2].trim();break;case"content-type":M=q[2].trim();break;case"content-transfer-encoding":F=q[2].trim();break}}switch(++Y,F.toLowerCase()){case"base64":G=vn(vi(D.slice(Y).join("")));break;case"quoted-printable":G=Nu(D.slice(Y));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+F)}var X=Wn(A,O.slice(k.length),G,{unsafe:!0});M&&(X.ctype=M)}function Ou(A,D){if(ye(A.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var k=D&&D.root||"",O=(Ge&&Buffer.isBuffer(A)?A.toString("binary"):ye(A)).split(`\r
`),F=0,M="";for(F=0;F<O.length;++F)if(M=O[F],!!/^Content-Location:/i.test(M)&&(M=M.slice(M.indexOf("file")),k||(k=M.slice(0,M.lastIndexOf("/")+1)),M.slice(0,k.length)!=k))for(;k.length>0&&(k=k.slice(0,k.length-1),k=k.slice(0,k.lastIndexOf("/")+1),M.slice(0,k.length)!=k););var G=(O[1]||"").match(/boundary="(.*?)"/);if(!G)throw new Error("MAD cannot find boundary");var Y="--"+(G[1]||""),K=[],q=[],X={FileIndex:K,FullPaths:q};E(X);var ne,ce=0;for(F=0;F<O.length;++F){var pe=O[F];pe!==Y&&pe!==Y+"--"||(ce++&&gs(X,O.slice(ne,F),k),ne=F)}return X}function Wt(A,D){var k=D||{},O=k.boundary||"SheetJS";O="------="+O;for(var F=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],M=A.FullPaths[0],G=M,Y=A.FileIndex[0],K=1;K<A.FullPaths.length;++K)if(G=A.FullPaths[K].slice(M.length),Y=A.FileIndex[K],!(!Y.size||!Y.content||G=="Sh33tJ5")){G=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ce){return"_x"+Ce.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ce){return"_u"+Ce.charCodeAt(0).toString(16)+"_"});for(var q=Y.content,X=Ge&&Buffer.isBuffer(q)?q.toString("binary"):ye(q),ne=0,ce=Math.min(1024,X.length),pe=0,ae=0;ae<=ce;++ae)(pe=X.charCodeAt(ae))>=32&&pe<128&&++ne;var de=ne>=ce*4/5;F.push(O),F.push("Content-Location: "+(k.root||"file:///C:/SheetJS/")+G),F.push("Content-Transfer-Encoding: "+(de?"quoted-printable":"base64")),F.push("Content-Type: "+zn(Y,G)),F.push(""),F.push(de?aa(X):Pu(X))}return F.push(O+`--\r
`),F.join(`\r
`)}function Du(A){var D={};return E(D,A),D}function Wn(A,D,k,O){var F=O&&O.unsafe;F||E(A);var M=!F&&et.find(A,D);if(!M){var G=A.FullPaths[0];D.slice(0,G.length)==G?G=D:(G.slice(-1)!="/"&&(G+="/"),G=(G+D).replace("//","/")),M={name:i(D),type:2},A.FileIndex.push(M),A.FullPaths.push(G),F||et.utils.cfb_gc(A)}return M.content=k,M.size=k?k.length:0,O&&(O.CLSID&&(M.clsid=O.CLSID),O.mt&&(M.mt=O.mt),O.ct&&(M.ct=O.ct)),M}function vs(A,D){E(A);var k=et.find(A,D);if(k){for(var O=0;O<A.FileIndex.length;++O)if(A.FileIndex[O]==k)return A.FileIndex.splice(O,1),A.FullPaths.splice(O,1),!0}return!1}function Lh(A,D,k){E(A);var O=et.find(A,D);if(O){for(var F=0;F<A.FileIndex.length;++F)if(A.FileIndex[F]==O)return A.FileIndex[F].name=i(k),A.FullPaths[F]=k,!0}return!1}function Mh(A){T(A,!0)}return e.find=N,e.read=H,e.parse=f,e.write=we,e.writeFile=ue,e.utils={cfb_new:Du,cfb_add:Wn,cfb_del:vs,cfb_mov:Lh,cfb_gc:Mh,ReadShift:yl,CheckField:s2,prep_blob:jr,bconcat:Qt,use_zlib:B,_deflateRaw:wo,_inflateRaw:sa,consts:$e},e}();function m3(t){return typeof t=="string"?Ah(t):Array.isArray(t)?jO(t):t}function Tu(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Ah(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Jl(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([m3(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Eu(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function ir(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function S_(t,e){for(var r=[],n=ir(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function Ym(t){for(var e=[],r=ir(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Rh(t){for(var e=[],r=ir(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function g3(t){for(var e=[],r=ir(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Ff=new Date(1899,11,30,0,0,0);function Fr(t,e){var r=t.getTime(),n=Ff.getTime()+(t.getTimezoneOffset()-Ff.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var zw=new Date,v3=Ff.getTime()+(zw.getTimezoneOffset()-Ff.getTimezoneOffset())*6e4,A_=zw.getTimezoneOffset();function Ww(t){var e=new Date;return e.setTime(t*24*60*60*1e3+v3),e.getTimezoneOffset()!==A_&&e.setTime(e.getTime()+(e.getTimezoneOffset()-A_)*6e4),e}var I_=new Date("2017-02-19T19:06:09.000Z"),Hw=isNaN(I_.getFullYear())?new Date("2/19/17"):I_,_3=Hw.getFullYear()==2017;function Tr(t,e){var r=new Date(t);if(_3)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(Hw.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function kh(t,e){if(Ge&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Lr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Lr(t[r]));return e}function yt(t,e){for(var r="";r.length<e;)r+=t;return r}function ai(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var y3=["january","february","march","april","may","june","july","august","september","october","november","december"];function Yl(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&y3.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}function Oe(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Ge?n=Ei(r):n=zO(r),et.utils.cfb_add(t,e,n)}et.utils.cfb_add(t,e,r)}else t.file(e,r)}function Jm(){return et.utils.cfb_new()}var kt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,x3={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Zm=Ym(x3),eg=/[&<>'"]/g,E3=/[\u0000-\u0008\u000b-\u001f]/g;function Qe(t){var e=t+"";return e.replace(eg,function(r){return Zm[r]}).replace(E3,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function C_(t){return Qe(t).replace(/ /g,"_x0020_")}var $w=/[\u0000-\u001f]/g;function T3(t){var e=t+"";return e.replace(eg,function(r){return Zm[r]}).replace(/\n/g,"<br/>").replace($w,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function w3(t){var e=t+"";return e.replace(eg,function(r){return Zm[r]}).replace($w,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function S3(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function A3(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function C0(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function R_(t){var e=Gs(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function k_(t){return Ei(t,"binary").toString("utf8")}var gc="foo bar baz",_l=Ge&&(k_(gc)==C0(gc)&&k_||R_(gc)==C0(gc)&&R_)||C0,Jl=Ge?function(t){return Ei(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},I3=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),Gw=/(^\s|\s$|\n)/;function Yt(t,e){return"<"+t+(e.match(Gw)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Zl(t){return ir(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function oe(t,e,r){return"<"+t+(r!=null?Zl(r):"")+(e!=null?(e.match(Gw)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function np(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function C3(t,e){switch(typeof t){case"string":var r=oe("vt:lpwstr",Qe(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return oe((t|0)==t?"vt:i4":"vt:r8",Qe(String(t)));case"boolean":return oe("vt:bool",t?"true":"false")}if(t instanceof Date)return oe("vt:filetime",np(t));throw new Error("Unable to serialize "+t)}var Ut={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},yo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],zr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function R3(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function k3(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var P_=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},N_=Ge?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Ei(e)})):P_(t)}:P_,O_=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(tl(t,i)));return n.join("").replace(vl,"")},tg=Ge?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(vl,""):O_(t,e,r)}:O_,D_=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},Kw=Ge?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):D_(t,e,r)}:D_,F_=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(_a(t,i)));return n.join("")},wu=Ge?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):F_(e,r,n)}:F_,qw=function(t,e){var r=Wr(t,e);return r>0?wu(t,e+4,e+4+r-1):""},Xw=qw,Qw=function(t,e){var r=Wr(t,e);return r>0?wu(t,e+4,e+4+r-1):""},Yw=Qw,Jw=function(t,e){var r=2*Wr(t,e);return r>0?wu(t,e+4,e+4+r-1):""},Zw=Jw,e2=function(e,r){var n=Wr(e,r);return n>0?tg(e,r+4,r+4+n):""},t2=e2,r2=function(t,e){var r=Wr(t,e);return r>0?wu(t,e+4,e+4+r):""},n2=r2,i2=function(t,e){return R3(t,e)},Lf=i2,rg=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ge&&(Xw=function(e,r){if(!Buffer.isBuffer(e))return qw(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Yw=function(e,r){if(!Buffer.isBuffer(e))return Qw(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Zw=function(e,r){if(!Buffer.isBuffer(e))return Jw(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},t2=function(e,r){if(!Buffer.isBuffer(e))return e2(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},n2=function(e,r){if(!Buffer.isBuffer(e))return r2(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Lf=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):i2(e,r)},rg=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var _a=function(t,e){return t[e]},tl=function(t,e){return t[e+1]*256+t[e]},P3=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Wr=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Ss=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},N3=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function yl(t,e){var r="",n,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Ge&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(tl(this,c)),c+=2;t*=2;break;case"utf8":r=wu(this,this.l,this.l+t);break;case"utf16le":t*=2,r=tg(this,this.l,this.l+t);break;case"wstr":return yl.call(this,t,"dbcs");case"lpstr-ansi":r=Xw(this,this.l),t=4+Wr(this,this.l);break;case"lpstr-cp":r=Yw(this,this.l),t=4+Wr(this,this.l);break;case"lpwstr":r=Zw(this,this.l),t=4+2*Wr(this,this.l);break;case"lpp4":t=4+Wr(this,this.l),r=t2(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Wr(this,this.l),r=n2(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=_a(this,this.l+t++))!==0;)s.push(dc(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=tl(this,this.l+t))!==0;)s.push(dc(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=_a(this,c),this.l=c+1,o=yl.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(dc(tl(this,c))),c+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=_a(this,c),this.l=c+1,o=yl.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(dc(_a(this,c))),c+=1}r=s.join("");break;default:switch(t){case 1:return n=_a(this,this.l),this.l++,n;case 2:return n=(e==="i"?P3:tl)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Ss:N3)(this,this.l),this.l+=4,n):(i=Wr(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Lf(this,this.l):i=Lf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=Kw(this,this.l,t);break}}return this.l+=t,r}var O3=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},D3=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},F3=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function L3(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)F3(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,O3(this,e,this.l);break;case 8:if(n=8,r==="f"){k3(this,e,this.l);break}case 16:break;case-4:n=4,D3(this,e,this.l);break}return this.l+=n,this}function s2(t,e){var r=Kw(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function jr(t,e){t.l=e,t.read_shift=yl,t.chk=s2,t.write_shift=L3}function bn(t,e){t.l+=e}function J(t){var e=Gs(t);return jr(e,0),e}function Dr(){var t=[],e=Ge?256:2048,r=function(c){var f=J(c);return jr(f,0),f},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},a=function(){return i(),Qt(t)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function te(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=R8[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&rg(r)&&t.push(r)}}function xl(t,e,r){var n=Lr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function L_(t,e,r){var n=Lr(t);return n.s=xl(n.s,e.s,r),n.e=xl(n.e,e.s,r),n}function El(t,e){if(t.cRel&&t.c<0)for(t=Lr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Lr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Ze(t);return!t.cRel&&t.cRel!=null&&(r=B3(r)),!t.rRel&&t.rRel!=null&&(r=M3(r)),r}function R0(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+dr(t.s.c)+":"+(t.e.cRel?"":"$")+dr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+er(t.s.r)+":"+(t.e.rRel?"":"$")+er(t.e.r):El(t.s,e.biff)+":"+El(t.e,e.biff)}function ng(t){return parseInt(V3(t),10)-1}function er(t){return""+(t+1)}function M3(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function V3(t){return t.replace(/\$(\d+)$/,"$1")}function ig(t){for(var e=U3(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function dr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function B3(t){return t.replace(/^([A-Z])/,"$$$1")}function U3(t){return t.replace(/^\$([A-Z])/,"$1")}function b3(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function bt(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function Ze(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function qr(t){var e=t.indexOf(":");return e==-1?{s:bt(t),e:bt(t)}:{s:bt(t.slice(0,e)),e:bt(t.slice(e+1))}}function Rt(t,e){return typeof e>"u"||typeof e=="number"?Rt(t.s,t.e):(typeof t!="string"&&(t=Ze(t)),typeof e!="string"&&(e=Ze(e)),t==e?t:t+":"+e)}function ut(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function M_(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=ss(t.z,r?Fr(e):e)}catch{}try{return t.w=ss((t.XF||{}).numFmtId||(r?14:0),r?Fr(e):e)}catch{return""+e}}function _i(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Su[t.v]||t.v:e==null?M_(t,t.v):M_(t,e))}function Zs(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function a2(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?bt(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=ut(s["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),a==-1&&(c.e.r=a=f.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var m={v:e[h][d]},_=a+h,g=o+d;if(c.s.r>_&&(c.s.r=_),c.s.c>g&&(c.s.c=g),c.e.r<_&&(c.e.r=_),c.e.c<g&&(c.e.c=g),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))m=e[h][d];else if(Array.isArray(m.v)&&(m.f=e[h][d][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||xt[14],n.cellDates?(m.t="d",m.w=ss(m.z,Fr(m.v))):(m.t="n",m.v=Fr(m.v),m.w=ss(m.z,m.v))):m.t="s";if(i)s[_]||(s[_]=[]),s[_][g]&&s[_][g].z&&(m.z=s[_][g].z),s[_][g]=m;else{var w=Ze({c:g,r:_});s[w]&&s[w].z&&(m.z=s[w].z),s[w]=m}}}return c.s.c<1e7&&(s["!ref"]=Rt(c)),s}function xo(t,e){return a2(null,t,e)}function j3(t){return t.read_shift(4,"i")}function Tn(t,e){return e||(e=J(4)),e.write_shift(4,t),e}function pr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function jt(t,e){var r=!1;return e==null&&(r=!0,e=J(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function z3(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function W3(t,e){return e||(e=J(4)),e.write_shift(2,0),e.write_shift(2,0),e}function sg(t,e){var r=t.l,n=t.read_shift(1),i=pr(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(z3(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function H3(t,e){var r=!1;return e==null&&(r=!0,e=J(15+4*t.t.length)),e.write_shift(1,0),jt(t.t,e),r?e.slice(0,e.l):e}var $3=sg;function G3(t,e){var r=!1;return e==null&&(r=!0,e=J(23+4*t.t.length)),e.write_shift(1,1),jt(t.t,e),e.write_shift(4,1),W3({},e),r?e.slice(0,e.l):e}function ln(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function ea(t,e){return e==null&&(e=J(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function ta(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function ra(t,e){return e==null&&(e=J(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var K3=pr,o2=jt;function ag(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Mf(t,e){var r=!1;return e==null&&(r=!0,e=J(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var q3=pr,ip=ag,og=Mf;function l2(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Lf([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Ss(e,0)>>2;return r?i/100:i}function u2(t,e){e==null&&(e=J(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function c2(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function X3(t,e){return e||(e=J(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var na=c2,Eo=X3;function To(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Ks(t,e){return(e||J(8)).write_shift(8,t,"f")}function Q3(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=sD[i];c&&(e.rgb=K_(c));break;case 2:e.rgb=K_([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Vf(t,e){if(e||(e=J(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function Y3(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function J3(t,e){e||(e=J(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}var f2=2,Ur=3,vc=11,Bf=19,_c=64,Z3=65,eD=71,tD=4108,rD=4126,Kt=80,V_={1:{n:"CodePage",t:f2},2:{n:"Category",t:Kt},3:{n:"PresentationFormat",t:Kt},4:{n:"ByteCount",t:Ur},5:{n:"LineCount",t:Ur},6:{n:"ParagraphCount",t:Ur},7:{n:"SlideCount",t:Ur},8:{n:"NoteCount",t:Ur},9:{n:"HiddenCount",t:Ur},10:{n:"MultimediaClipCount",t:Ur},11:{n:"ScaleCrop",t:vc},12:{n:"HeadingPairs",t:tD},13:{n:"TitlesOfParts",t:rD},14:{n:"Manager",t:Kt},15:{n:"Company",t:Kt},16:{n:"LinksUpToDate",t:vc},17:{n:"CharacterCount",t:Ur},19:{n:"SharedDoc",t:vc},22:{n:"HyperlinksChanged",t:vc},23:{n:"AppVersion",t:Ur,p:"version"},24:{n:"DigSig",t:Z3},26:{n:"ContentType",t:Kt},27:{n:"ContentStatus",t:Kt},28:{n:"Language",t:Kt},29:{n:"Version",t:Kt},255:{},2147483648:{n:"Locale",t:Bf},2147483651:{n:"Behavior",t:Bf},1919054434:{}},B_={1:{n:"CodePage",t:f2},2:{n:"Title",t:Kt},3:{n:"Subject",t:Kt},4:{n:"Author",t:Kt},5:{n:"Keywords",t:Kt},6:{n:"Comments",t:Kt},7:{n:"Template",t:Kt},8:{n:"LastAuthor",t:Kt},9:{n:"RevNumber",t:Kt},10:{n:"EditTime",t:_c},11:{n:"LastPrinted",t:_c},12:{n:"CreatedDate",t:_c},13:{n:"ModifiedDate",t:_c},14:{n:"PageCount",t:Ur},15:{n:"WordCount",t:Ur},16:{n:"CharCount",t:Ur},17:{n:"Thumbnail",t:eD},18:{n:"Application",t:Kt},19:{n:"DocSecurity",t:Ur},255:{},2147483648:{n:"Locale",t:Bf},2147483651:{n:"Behavior",t:Bf},1919054434:{}};function nD(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var iD=nD([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),sD=Lr(iD),Su={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},aD={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},yc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function h2(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function d2(t,e){var r=g3(aD),n=[],i;n[n.length]=kt,n[n.length]=oe("Types",null,{xmlns:Ut.CT,"xmlns:xsd":Ut.xsd,"xmlns:xsi":Ut.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return oe("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=oe("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:yc[l][e.bookType]||yc[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(c){n[n.length]=oe("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:yc[l][e.bookType]||yc[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(c){n[n.length]=oe("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var We={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function p2(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Wa(t){var e=[kt,oe("Relationships",null,{xmlns:Ut.RELS})];return ir(t["!id"]).forEach(function(r){e[e.length]=oe("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Xe(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[We.HLINK,We.XPATH,We.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}function oD(t){var e=[kt];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function U_(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function lD(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function uD(t){var e=[kt];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(U_(t[r][0],t[r][1])),e.push(lD("",t[r][0]));return e.push(U_("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function m2(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+kf.version+"</meta:generator></office:meta></office:document-meta>"}var Ls=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function k0(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Qe(e),n[n.length]=r?oe(t,e,r):Yt(t,e))}function g2(t,e){var r=e||{},n=[kt,oe("cp:coreProperties",null,{"xmlns:cp":Ut.CORE_PROPS,"xmlns:dc":Ut.dc,"xmlns:dcterms":Ut.dcterms,"xmlns:dcmitype":Ut.dcmitype,"xmlns:xsi":Ut.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&k0("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:np(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&k0("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:np(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Ls.length;++s){var a=Ls[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&k0(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ha=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],v2=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function _2(t){var e=[],r=oe;return t||(t={}),t.Application="SheetJS",e[e.length]=kt,e[e.length]=oe("Properties",null,{xmlns:Ut.EXT_PROPS,"xmlns:vt":Ut.vt}),Ha.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Qe(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Qe(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function y2(t){var e=[kt,oe("Properties",null,{xmlns:Ut.CUST_PROPS,"xmlns:vt":Ut.vt})];if(!t)return e.join("");var r=1;return ir(t).forEach(function(i){++r,e[e.length]=oe("property",C3(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Qe(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var b_={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function cD(t,e){var r=[];return ir(b_).map(function(n){for(var i=0;i<Ls.length;++i)if(Ls[i][1]==n)return Ls[i];for(i=0;i<Ha.length;++i)if(Ha[i][1]==n)return Ha[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Yt(b_[n[1]]||n[1],i))}}),oe("DocumentProperties",r.join(""),{xmlns:zr.o})}function fD(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&ir(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<Ls.length;++a)if(s==Ls[a][1])return;for(a=0;a<Ha.length;++a)if(s==Ha[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(oe(C_(s),o,{"dt:dt":l}))}}),e&&ir(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(oe(C_(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+zr.o+'">'+i.join("")+"</"+n+">"}function hD(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=J(8);return a.write_shift(4,n),a.write_shift(4,i),a}function j_(t,e){var r=J(4),n=J(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=J(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=hD(e);break;case 31:case 80:for(n=J(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Qt([r,n])}var x2=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function dD(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function z_(t,e,r){var n=J(8),i=[],s=[],a=8,o=0,l=J(8),c=J(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!e){c=J(8),c.write_shift(4,0),i.unshift(c);var f=[J(4)];for(f[0].write_shift(4,t.length),o=0;o<t.length;++o){var h=t[o][0];for(l=J(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=Qt(f),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(x2.indexOf(t[o][0])>-1||v2.indexOf(t[o][0])>-1)&&t[o][1]!=null){var d=t[o][1],m=0;if(e){m=+e[t[o][0]];var _=r[m];if(_.p=="version"&&typeof d=="string"){var g=d.split(".");d=(+g[0]<<16)+(+g[1]||0)}l=j_(_.t,d)}else{var w=dD(d);w==-1&&(w=31,d=String(d)),l=j_(w,d)}s.push(l),c=J(8),c.write_shift(4,e?m:2+o),i.push(c),a+=8+l.length}var S=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,S),S+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Qt([n].concat(i).concat(s))}function W_(t,e,r,n,i,s){var a=J(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,et.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=z_(t,r,n);if(o.push(l),i){var c=z_(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return Qt(o)}function pD(t,e){e||(e=J(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function mD(t,e){return t.read_shift(e)===1}function yr(t,e){return e||(e=J(2)),e.write_shift(2,+!!t),e}function E2(t){return t.read_shift(2,"u")}function en(t,e){return e||(e=J(2)),e.write_shift(2,t),e}function T2(t,e,r){return r||(r=J(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function w2(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function gD(t){var e=t.t||"",r=J(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=J(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return Qt(i)}function vD(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function _D(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):vD(t,n,r)}function yD(t,e,r){if(r.biff>5)return _D(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function S2(t,e,r){return r||(r=J(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function H_(t,e){e||(e=J(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function xD(t){var e=J(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),H_(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&H_(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function qs(t,e,r,n){return n||(n=J(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function ED(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function TD(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function A2(t,e){return e||(e=J(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function lg(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=J(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function wD(t,e){var r=!e||e.biff==8,n=J(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function SD(t,e){var r=!e||e.biff>=8?2:1,n=J(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function AD(t,e){var r=J(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=gD(t[i]);var s=Qt([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function ID(){var t=J(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function CD(t){var e=J(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function RD(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=J(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function kD(t,e,r,n){var i=J(10);return qs(t,e,n,i),i.write_shift(4,r),i}function PD(t,e,r,n,i){var s=!i||i.biff==8,a=J(8+ +s+(1+s)*r.length);return qs(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function ND(t,e,r,n){var i=r&&r.biff==5;n||(n=J(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function OD(t,e){var r=e.biff==8||!e.biff?4:2,n=J(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function $_(t,e,r,n){var i=r&&r.biff==5;n||(n=J(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function DD(t){var e=J(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function FD(t,e,r,n,i,s){var a=J(8);return qs(t,e,n,a),T2(r,s,a),a}function LD(t,e,r,n){var i=J(14);return qs(t,e,n,i),Ks(r,i),i}function MD(t,e,r){if(r.biff<8)return VD(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(ED(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function VD(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=w2(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function BD(t){var e=J(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)A2(t[r],e);return e}function UD(t){var e=J(24),r=bt(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Qt([e,xD(t[1])])}function bD(t){var e=t[1].Tooltip,r=J(10+2*(e.length+1));r.write_shift(2,2048);var n=bt(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function jD(t){return t||(t=J(4)),t.write_shift(2,1),t.write_shift(2,1),t}function zD(t,e,r){if(!r.cellStyles)return bn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function WD(t,e){var r=J(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function HD(t){for(var e=J(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}function $D(t,e,r){var n=J(15);return Iu(n,t,e),n.write_shift(8,r,"f"),n}function GD(t,e,r){var n=J(9);return Iu(n,t,e),n.write_shift(2,r),n}var KD=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Ym({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],f=Gs(1);switch(l.type){case"base64":f=vn(vi(o));break;case"binary":f=vn(o);break;case"buffer":case"array":f=o;break}jr(f,0);var h=f.read_shift(1),d=!!(h&136),m=!1,_=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,d=!0;break;case 49:m=!0,d=!0;break;case 131:break;case 139:break;case 140:_=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,w=521;h==2&&(g=f.read_shift(2)),f.l+=3,h!=2&&(g=f.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(w=f.read_shift(2));var S=f.read_shift(2),x=l.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(x=t[f[f.l]]),f.l+=1,f.l+=2),_&&(f.l+=36);for(var I=[],V={},b=Math.min(f.length,h==2?521:w-10-(m?264:0)),H=_?32:11;f.l<b&&f[f.l]!=13;)switch(V={},V.name=Pf.utils.decode(x,f.slice(f.l,f.l+H)).replace(/[\u0000\r\n].*$/g,""),f.l+=H,V.type=String.fromCharCode(f.read_shift(1)),h!=2&&!_&&(V.offset=f.read_shift(4)),V.len=f.read_shift(1),h==2&&(V.offset=f.read_shift(2)),V.dec=f.read_shift(1),V.name.length&&I.push(V),h!=2&&(f.l+=_?13:14),V.type){case"B":(!m||V.len!=8)&&l.WTF&&console.log("Skipping "+V.name+":"+V.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+V.name+":"+V.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+V.type)}if(f[f.l]!==13&&(f.l=w-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=w;var E=0,y=0;for(c[0]=[],y=0;y!=I.length;++y)c[0][y]=I[y].name;for(;g-- >0;){if(f[f.l]===42){f.l+=S;continue}for(++f.l,c[++E]=[],y=0,y=0;y!=I.length;++y){var T=f.slice(f.l,f.l+I[y].len);f.l+=I[y].len,jr(T,0);var C=Pf.utils.decode(x,T);switch(I[y].type){case"C":C.trim().length&&(c[E][y]=C.replace(/\s+$/,""));break;case"D":C.length===8?c[E][y]=new Date(+C.slice(0,4),+C.slice(4,6)-1,+C.slice(6,8)):c[E][y]=C;break;case"F":c[E][y]=parseFloat(C.trim());break;case"+":case"I":c[E][y]=_?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(C.trim().toUpperCase()){case"Y":case"T":c[E][y]=!0;break;case"N":case"F":c[E][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+C+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[E][y]="##MEMO##"+(_?parseInt(C.trim(),10):T.read_shift(4));break;case"N":C=C.replace(/\u0000/g,"").trim(),C&&C!="."&&(c[E][y]=+C||0);break;case"@":c[E][y]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":c[E][y]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":c[E][y]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[E][y]=-T.read_shift(-8,"f");break;case"B":if(m&&I[y].len==8){c[E][y]=T.read_shift(8,"f");break}case"G":case"P":T.l+=I[y].len;break;case"0":if(I[y].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+I[y].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=I,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=xo(r(o,c),c);return f["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,f}function i(o,l){try{return Zs(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&Xl(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=Dr(),h=Wf(o,{header:1,raw:!0,cellDates:!0}),d=h[0],m=h.slice(1),_=o["!cols"]||[],g=0,w=0,S=0,x=1;for(g=0;g<d.length;++g){if(((_[g]||{}).DBF||{}).name){d[g]=_[g].DBF.name,++S;continue}if(d[g]!=null){if(++S,typeof d[g]=="number"&&(d[g]=d[g].toString(10)),typeof d[g]!="string")throw new Error("DBF Invalid column name "+d[g]+" |"+typeof d[g]+"|");if(d.indexOf(d[g])!==g){for(w=0;w<1024;++w)if(d.indexOf(d[g]+"_"+w)==-1){d[g]+="_"+w;break}}}}var I=ut(o["!ref"]),V=[],b=[],H=[];for(g=0;g<=I.e.c-I.s.c;++g){var E="",y="",T=0,C=[];for(w=0;w<m.length;++w)m[w][g]!=null&&C.push(m[w][g]);if(C.length==0||d[g]==null){V[g]="?";continue}for(w=0;w<C.length;++w){switch(typeof C[w]){case"number":y="B";break;case"string":y="C";break;case"boolean":y="L";break;case"object":y=C[w]instanceof Date?"D":"C";break;default:y="C"}T=Math.max(T,String(C[w]).length),E=E&&E!=y?"C":y}T>250&&(T=250),y=((_[g]||{}).DBF||{}).type,y=="C"&&_[g].DBF.len>T&&(T=_[g].DBF.len),E=="B"&&y=="N"&&(E="N",H[g]=_[g].DBF.dec,T=_[g].DBF.len),b[g]=E=="C"||y=="N"?T:s[E]||0,x+=b[g],V[g]=E}var N=f.next(32);for(N.write_shift(4,318902576),N.write_shift(4,m.length),N.write_shift(2,296+32*S),N.write_shift(2,x),g=0;g<4;++g)N.write_shift(4,0);for(N.write_shift(4,0|(+e[Cw]||3)<<8),g=0,w=0;g<d.length;++g)if(d[g]!=null){var L=f.next(32),P=(d[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,P,"sbcs"),L.write_shift(1,V[g]=="?"?"C":V[g],"sbcs"),L.write_shift(4,w),L.write_shift(1,b[g]||s[V[g]]||0),L.write_shift(1,H[g]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),w+=b[g]||s[V[g]]||0}var Ie=f.next(264);for(Ie.write_shift(4,13),g=0;g<65;++g)Ie.write_shift(4,0);for(g=0;g<m.length;++g){var Ae=f.next(x);for(Ae.write_shift(1,0),w=0;w<d.length;++w)if(d[w]!=null)switch(V[w]){case"L":Ae.write_shift(1,m[g][w]==null?63:m[g][w]?84:70);break;case"B":Ae.write_shift(8,m[g][w]||0,"f");break;case"N":var ht="0";for(typeof m[g][w]=="number"&&(ht=m[g][w].toFixed(H[w]||0)),S=0;S<b[w]-ht.length;++S)Ae.write_shift(1,32);Ae.write_shift(1,ht,"sbcs");break;case"D":m[g][w]?(Ae.write_shift(4,("0000"+m[g][w].getFullYear()).slice(-4),"sbcs"),Ae.write_shift(2,("00"+(m[g][w].getMonth()+1)).slice(-2),"sbcs"),Ae.write_shift(2,("00"+m[g][w].getDate()).slice(-2),"sbcs")):Ae.write_shift(8,"00000000","sbcs");break;case"C":var $e=String(m[g][w]!=null?m[g][w]:"").slice(0,b[w]);for(Ae.write_shift(1,$e,"sbcs"),S=0;S<b[w]-$e.length;++S)Ae.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),qD=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+ir(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,m){var _=t[m];return typeof _=="number"?m_(_):_},n=function(d,m,_){var g=m.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return g==59?d:m_(g)};t["|"]=254;function i(d,m){switch(m.type){case"base64":return s(vi(d),m);case"binary":return s(d,m);case"buffer":return s(Ge&&Buffer.isBuffer(d)?d.toString("binary"):Eu(d),m);case"array":return s(kh(d),m)}throw new Error("Unrecognized type "+m.type)}function s(d,m){var _=d.split(/[\n\r]+/),g=-1,w=-1,S=0,x=0,I=[],V=[],b=null,H={},E=[],y=[],T=[],C=0,N;for(+m.codepage>=0&&Xl(+m.codepage);S!==_.length;++S){C=0;var L=_[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),P=L.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),Ie=P[0],Ae;if(L.length>0)switch(Ie){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":P[1].charAt(0)=="P"&&V.push(L.slice(3).replace(/;;/g,";"));break;case"C":var ht=!1,$e=!1,ue=!1,ye=!1,we=-1,De=-1;for(x=1;x<P.length;++x)switch(P[x].charAt(0)){case"A":break;case"X":w=parseInt(P[x].slice(1))-1,$e=!0;break;case"Y":for(g=parseInt(P[x].slice(1))-1,$e||(w=0),N=I.length;N<=g;++N)I[N]=[];break;case"K":Ae=P[x].slice(1),Ae.charAt(0)==='"'?Ae=Ae.slice(1,Ae.length-1):Ae==="TRUE"?Ae=!0:Ae==="FALSE"?Ae=!1:isNaN(ai(Ae))?isNaN(Yl(Ae).getDate())||(Ae=Tr(Ae)):(Ae=ai(Ae),b!==null&&Uw(b)&&(Ae=Ww(Ae))),ht=!0;break;case"E":ye=!0;var B=GF(P[x].slice(1),{r:g,c:w});I[g][w]=[I[g][w],B];break;case"S":ue=!0,I[g][w]=[I[g][w],"S5S"];break;case"G":break;case"R":we=parseInt(P[x].slice(1))-1;break;case"C":De=parseInt(P[x].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+L)}if(ht&&(I[g][w]&&I[g][w].length==2?I[g][w][0]=Ae:I[g][w]=Ae,b=null),ue){if(ye)throw new Error("SYLK shared formula cannot have own formula");var W=we>-1&&I[we][De];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");I[g][w][1]=KF(W[1],{r:g-we,c:w-De})}break;case"F":var j=0;for(x=1;x<P.length;++x)switch(P[x].charAt(0)){case"X":w=parseInt(P[x].slice(1))-1,++j;break;case"Y":for(g=parseInt(P[x].slice(1))-1,N=I.length;N<=g;++N)I[N]=[];break;case"M":C=parseInt(P[x].slice(1))/20;break;case"F":break;case"G":break;case"P":b=V[parseInt(P[x].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=P[x].slice(1).split(" "),N=parseInt(T[0],10);N<=parseInt(T[1],10);++N)C=parseInt(T[2],10),y[N-1]=C===0?{hidden:!0}:{wch:C},ug(y[N-1]);break;case"C":w=parseInt(P[x].slice(1))-1,y[w]||(y[w]={});break;case"R":g=parseInt(P[x].slice(1))-1,E[g]||(E[g]={}),C>0?(E[g].hpt=C,E[g].hpx=P2(C)):C===0&&(E[g].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+L)}j<1&&(b=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+L)}}return E.length>0&&(H["!rows"]=E),y.length>0&&(H["!cols"]=y),m&&m.sheetRows&&(I=I.slice(0,m.sheetRows)),[I,H]}function a(d,m){var _=i(d,m),g=_[0],w=_[1],S=xo(g,m);return ir(w).forEach(function(x){S[x]=w[x]}),S}function o(d,m){return Zs(a(d,m),m)}function l(d,m,_,g){var w="C;Y"+(_+1)+";X"+(g+1)+";K";switch(d.t){case"n":w+=d.v||0,d.f&&!d.F&&(w+=";E"+fg(d.f,{r:_,c:g}));break;case"b":w+=d.v?"TRUE":"FALSE";break;case"e":w+=d.w||d.v;break;case"d":w+='"'+(d.w||d.v)+'"';break;case"s":w+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(d,m){m.forEach(function(_,g){var w="F;W"+(g+1)+" "+(g+1)+" ";_.hidden?w+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=Uf(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=bf(_.wpx)),typeof _.wch=="number"&&(w+=Math.round(_.wch))),w.charAt(w.length-1)!=" "&&d.push(w)})}function f(d,m){m.forEach(function(_,g){var w="F;";_.hidden?w+="M0;":_.hpt?w+="M"+20*_.hpt+";":_.hpx&&(w+="M"+20*jf(_.hpx)+";"),w.length>2&&d.push(w+"R"+(g+1))})}function h(d,m){var _=["ID;PWXL;N;E"],g=[],w=ut(d["!ref"]),S,x=Array.isArray(d),I=`\r
`;_.push("P;PGeneral"),_.push("F;P0;DG0G8;M255"),d["!cols"]&&c(_,d["!cols"]),d["!rows"]&&f(_,d["!rows"]),_.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var V=w.s.r;V<=w.e.r;++V)for(var b=w.s.c;b<=w.e.c;++b){var H=Ze({r:V,c:b});S=x?(d[V]||[])[b]:d[H],!(!S||S.v==null&&(!S.f||S.F))&&g.push(l(S,d,V,b))}return _.join(I)+I+g.join(I)+I+"E"+I}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),XD=function(){function t(s,a){switch(a.type){case"base64":return e(vi(s),a);case"binary":return e(s,a);case"buffer":return e(Ge&&Buffer.isBuffer(s)?s.toString("binary"):Eu(s),a);case"array":return e(kh(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var d=o[f].trim().split(","),m=d[0],_=d[1];++f;for(var g=o[f]||"";(g.match(/["]/g)||[]).length&1&&f<o.length-1;)g+=`
`+o[++f];switch(g=g.trim(),+m){case-1:if(g==="BOT"){h[++l]=[],c=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[l][c]=!0:g==="FALSE"?h[l][c]=!1:isNaN(ai(_))?isNaN(Yl(_).getDate())?h[l][c]=_:h[l][c]=Tr(_):h[l][c]=ai(_),++c;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[l][c++]=g!==""?g:null;break}if(g==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return xo(t(s,a),a)}function n(s,a){return Zs(r(s,a),a)}var i=function(){var s=function(l,c,f,h,d){l.push(c),l.push(f+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},a=function(l,c,f,h){l.push(c+","+f),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],f=ut(l["!ref"]),h,d=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,f.e.r-f.s.r+1,""),s(c,"TUPLES",0,f.e.c-f.s.c+1,""),s(c,"DATA",0,0,"");for(var m=f.s.r;m<=f.e.r;++m){a(c,-1,0,"BOT");for(var _=f.s.c;_<=f.e.c;++_){var g=Ze({r:m,c:_});if(h=d?(l[m]||[])[_]:l[g],!h){a(c,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?a(c,1,0,"="+h.f):a(c,1,0,""):a(c,0,w,"V");break;case"b":a(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=ss(h.z||xt[14],Fr(Tr(h.v)))),a(c,0,h.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var S=`\r
`,x=c.join(S);return x}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),I2=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var m=h.split(`
`),_=-1,g=-1,w=0,S=[];w!==m.length;++w){var x=m[w].trim().split(":");if(x[0]==="cell"){var I=bt(x[1]);if(S.length<=I.r)for(_=S.length;_<=I.r;++_)S[_]||(S[_]=[]);switch(_=I.r,g=I.c,x[2]){case"t":S[_][g]=t(x[3]);break;case"v":S[_][g]=+x[3];break;case"vtf":var V=x[x.length-1];case"vtc":switch(x[3]){case"nl":S[_][g]=!!+x[4];break;default:S[_][g]=+x[4];break}x[2]=="vtf"&&(S[_][g]=[S[_][g],V])}}}return d&&d.sheetRows&&(S=S.slice(0,d.sheetRows)),S}function n(h,d){return xo(r(h,d),d)}function i(h,d){return Zs(n(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],m=[],_,g="",w=qr(h["!ref"]),S=Array.isArray(h),x=w.s.r;x<=w.e.r;++x)for(var I=w.s.c;I<=w.e.c;++I)if(g=Ze({r:x,c:I}),_=S?(h[x]||[])[I]:h[g],!(!_||_.v==null||_.t==="z")){switch(m=["cell",g,"t"],_.t){case"s":case"str":m.push(e(_.v));break;case"n":_.f?(m[2]="vtf",m[3]="n",m[4]=_.v,m[5]=e(_.f)):(m[2]="v",m[3]=_.v);break;case"b":m[2]="vt"+(_.f?"f":"c"),m[3]="nl",m[4]=_.v?"1":"0",m[5]=e(_.f||(_.v?"TRUE":"FALSE"));break;case"d":var V=Fr(Tr(_.v));m[2]="vtc",m[3]="nd",m[4]=""+V,m[5]=_.w||ss(_.z||xt[14],V);break;case"e":continue}d.push(m.join(":"))}return d.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(h){return[s,a,o,a,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),QD=function(){function t(f,h,d,m,_){_.raw?h[d][m]=f:f===""||(f==="TRUE"?h[d][m]=!0:f==="FALSE"?h[d][m]=!1:isNaN(ai(f))?isNaN(Yl(f).getDate())?h[d][m]=f:h[d][m]=Tr(f):h[d][m]=ai(f))}function e(f,h){var d=h||{},m=[];if(!f||f.length===0)return m;for(var _=f.split(/[\r\n]/),g=_.length-1;g>=0&&_[g].length===0;)--g;for(var w=10,S=0,x=0;x<=g;++x)S=_[x].indexOf(" "),S==-1?S=_[x].length:S++,w=Math.max(w,S);for(x=0;x<=g;++x){m[x]=[];var I=0;for(t(_[x].slice(0,w).trim(),m,x,I,d),I=1;I<=(_[x].length-w)/10+1;++I)t(_[x].slice(w+(I-1)*10,w+I*10).trim(),m,x,I,d)}return d.sheetRows&&(m=m.slice(0,d.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var h={},d=!1,m=0,_=0;m<f.length;++m)(_=f.charCodeAt(m))==34?d=!d:!d&&_ in r&&(h[_]=(h[_]||0)+1);_=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&_.push([h[m],m]);if(!_.length){h=n;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&_.push([h[m],m])}return _.sort(function(g,w){return g[0]-w[0]||n[g[1]]-n[w[1]]}),r[_.pop()[1]]||44}function s(f,h){var d=h||{},m="",_=d.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(m=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(m=f.charAt(4),f=f.slice(6)):m=i(f.slice(0,1024)):d&&d.FS?m=d.FS:m=i(f.slice(0,1024));var w=0,S=0,x=0,I=0,V=0,b=m.charCodeAt(0),H=!1,E=0,y=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var T=d.dateNF!=null?h3(d.dateNF):null;function C(){var N=f.slice(I,V),L={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)L.t="z";else if(d.raw)L.t="s",L.v=N;else if(N.trim().length===0)L.t="s",L.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(L.t="s",L.v=N.slice(2,-1).replace(/""/g,'"')):qF(N)?(L.t="n",L.f=N.slice(1)):(L.t="s",L.v=N);else if(N=="TRUE")L.t="b",L.v=!0;else if(N=="FALSE")L.t="b",L.v=!1;else if(!isNaN(x=ai(N)))L.t="n",d.cellText!==!1&&(L.w=N),L.v=x;else if(!isNaN(Yl(N).getDate())||T&&N.match(T)){L.z=d.dateNF||xt[14];var P=0;T&&N.match(T)&&(N=d3(N,d.dateNF,N.match(T)||[]),P=1),d.cellDates?(L.t="d",L.v=Tr(N,P)):(L.t="n",L.v=Fr(Tr(N,P))),d.cellText!==!1&&(L.w=ss(L.z,L.v instanceof Date?Fr(L.v):L.v)),d.cellNF||delete L.z}else L.t="s",L.v=N;if(L.t=="z"||(d.dense?(_[w]||(_[w]=[]),_[w][S]=L):_[Ze({c:S,r:w})]=L),I=V+1,y=f.charCodeAt(I),g.e.c<S&&(g.e.c=S),g.e.r<w&&(g.e.r=w),E==b)++S;else if(S=0,++w,d.sheetRows&&d.sheetRows<=w)return!0}e:for(;V<f.length;++V)switch(E=f.charCodeAt(V)){case 34:y===34&&(H=!H);break;case b:case 10:case 13:if(!H&&C())break e;break}return V-I>0&&C(),_["!ref"]=Rt(g),_}function a(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,h):xo(e(f,h),h)}function o(f,h){var d="",m=h.type=="string"?[0,0,0,0]:l5(f,h);switch(h.type){case"base64":d=vi(f);break;case"binary":d=f;break;case"buffer":h.codepage==65001?d=f.toString("utf8"):h.codepage&&typeof Pf<"u"||(d=Ge&&Buffer.isBuffer(f)?f.toString("binary"):Eu(f));break;case"array":d=kh(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?d=_l(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=_l(d):h.type=="binary"&&typeof Pf<"u",d.slice(0,19)=="socialcalc:version:"?I2.to_sheet(h.type=="string"?d:_l(d),h):a(d,h)}function l(f,h){return Zs(o(f,h),h)}function c(f){for(var h=[],d=ut(f["!ref"]),m,_=Array.isArray(f),g=d.s.r;g<=d.e.r;++g){for(var w=[],S=d.s.c;S<=d.e.c;++S){var x=Ze({r:g,c:S});if(m=_?(f[g]||[])[S]:f[x],!m||m.v==null){w.push("          ");continue}for(var I=(m.w||(_i(m),m.w)||"").slice(0,10);I.length<10;)I+=" ";w.push(I+(S===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}(),G_=function(){function t(B,W,j){if(B){jr(B,B.l||0);for(var U=j.Enum||we;B.l<B.length;){var Z=B.read_shift(2),me=U[Z]||U[65535],Te=B.read_shift(2),xe=B.l+Te,he=me.f&&me.f(B,Te,j);if(B.l=xe,W(he,me,Z))return}}}function e(B,W){switch(W.type){case"base64":return r(vn(vi(B)),W);case"binary":return r(vn(B),W);case"buffer":case"array":return r(B,W)}throw"Unsupported type "+W.type}function r(B,W){if(!B)return B;var j=W||{},U=j.dense?[]:{},Z="Sheet1",me="",Te=0,xe={},he=[],je=[],Fe={s:{r:0,c:0},e:{r:0,c:0}},Pt=j.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)j.Enum=we,t(B,function(_e,Ar,Yr){switch(Yr){case 0:j.vers=_e,_e>=4096&&(j.qpro=!0);break;case 6:Fe=_e;break;case 204:_e&&(me=_e);break;case 222:me=_e;break;case 15:case 51:j.qpro||(_e[1].v=_e[1].v.slice(1));case 13:case 14:case 16:Yr==14&&(_e[2]&112)==112&&(_e[2]&15)>1&&(_e[2]&15)<15&&(_e[1].z=j.dateNF||xt[14],j.cellDates&&(_e[1].t="d",_e[1].v=Ww(_e[1].v))),j.qpro&&_e[3]>Te&&(U["!ref"]=Rt(Fe),xe[Z]=U,he.push(Z),U=j.dense?[]:{},Fe={s:{r:0,c:0},e:{r:0,c:0}},Te=_e[3],Z=me||"Sheet"+(Te+1),me="");var un=j.dense?(U[_e[0].r]||[])[_e[0].c]:U[Ze(_e[0])];if(un){un.t=_e[1].t,un.v=_e[1].v,_e[1].z!=null&&(un.z=_e[1].z),_e[1].f!=null&&(un.f=_e[1].f);break}j.dense?(U[_e[0].r]||(U[_e[0].r]=[]),U[_e[0].r][_e[0].c]=_e[1]):U[Ze(_e[0])]=_e[1];break}},j);else if(B[2]==26||B[2]==14)j.Enum=De,B[2]==14&&(j.qpro=!0,B.l=0),t(B,function(_e,Ar,Yr){switch(Yr){case 204:Z=_e;break;case 22:_e[1].v=_e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(_e[3]>Te&&(U["!ref"]=Rt(Fe),xe[Z]=U,he.push(Z),U=j.dense?[]:{},Fe={s:{r:0,c:0},e:{r:0,c:0}},Te=_e[3],Z="Sheet"+(Te+1)),Pt>0&&_e[0].r>=Pt)break;j.dense?(U[_e[0].r]||(U[_e[0].r]=[]),U[_e[0].r][_e[0].c]=_e[1]):U[Ze(_e[0])]=_e[1],Fe.e.c<_e[0].c&&(Fe.e.c=_e[0].c),Fe.e.r<_e[0].r&&(Fe.e.r=_e[0].r);break;case 27:_e[14e3]&&(je[_e[14e3][0]]=_e[14e3][1]);break;case 1537:je[_e[0]]=_e[1],_e[0]==Te&&(Z=_e[1]);break}},j);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(U["!ref"]=Rt(Fe),xe[me||Z]=U,he.push(me||Z),!je.length)return{SheetNames:he,Sheets:xe};for(var Be={},Mr=[],it=0;it<je.length;++it)xe[he[it]]?(Mr.push(je[it]||he[it]),Be[je[it]]=xe[je[it]]||xe[he[it]]):(Mr.push(je[it]),Be[je[it]]={"!ref":"A1"});return{SheetNames:Mr,Sheets:Be}}function n(B,W){var j=W||{};if(+j.codepage>=0&&Xl(+j.codepage),j.type=="string")throw new Error("Cannot write WK1 to JS string");var U=Dr(),Z=ut(B["!ref"]),me=Array.isArray(B),Te=[];le(U,0,s(1030)),le(U,6,l(Z));for(var xe=Math.min(Z.e.r,8191),he=Z.s.r;he<=xe;++he)for(var je=er(he),Fe=Z.s.c;Fe<=Z.e.c;++Fe){he===Z.s.r&&(Te[Fe]=dr(Fe));var Pt=Te[Fe]+je,Be=me?(B[he]||[])[Fe]:B[Pt];if(!(!Be||Be.t=="z"))if(Be.t=="n")(Be.v|0)==Be.v&&Be.v>=-32768&&Be.v<=32767?le(U,13,m(he,Fe,Be.v)):le(U,14,g(he,Fe,Be.v));else{var Mr=_i(Be);le(U,15,h(he,Fe,Mr.slice(0,239)))}}return le(U,1),U.end()}function i(B,W){var j=W||{};if(+j.codepage>=0&&Xl(+j.codepage),j.type=="string")throw new Error("Cannot write WK3 to JS string");var U=Dr();le(U,0,a(B));for(var Z=0,me=0;Z<B.SheetNames.length;++Z)(B.Sheets[B.SheetNames[Z]]||{})["!ref"]&&le(U,27,ye(B.SheetNames[Z],me++));var Te=0;for(Z=0;Z<B.SheetNames.length;++Z){var xe=B.Sheets[B.SheetNames[Z]];if(!(!xe||!xe["!ref"])){for(var he=ut(xe["!ref"]),je=Array.isArray(xe),Fe=[],Pt=Math.min(he.e.r,8191),Be=he.s.r;Be<=Pt;++Be)for(var Mr=er(Be),it=he.s.c;it<=he.e.c;++it){Be===he.s.r&&(Fe[it]=dr(it));var _e=Fe[it]+Mr,Ar=je?(xe[Be]||[])[it]:xe[_e];if(!(!Ar||Ar.t=="z"))if(Ar.t=="n")le(U,23,C(Be,it,Te,Ar.v));else{var Yr=_i(Ar);le(U,22,E(Be,it,Te,Yr.slice(0,239)))}}++Te}}return le(U,1),U.end()}function s(B){var W=J(2);return W.write_shift(2,B),W}function a(B){var W=J(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var j=0,U=0,Z=0,me=0;me<B.SheetNames.length;++me){var Te=B.SheetNames[me],xe=B.Sheets[Te];if(!(!xe||!xe["!ref"])){++Z;var he=qr(xe["!ref"]);j<he.e.r&&(j=he.e.r),U<he.e.c&&(U=he.e.c)}}return j>8191&&(j=8191),W.write_shift(2,j),W.write_shift(1,Z),W.write_shift(1,U),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function o(B,W,j){var U={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&j.qpro?(U.s.c=B.read_shift(1),B.l++,U.s.r=B.read_shift(2),U.e.c=B.read_shift(1),B.l++,U.e.r=B.read_shift(2),U):(U.s.c=B.read_shift(2),U.s.r=B.read_shift(2),W==12&&j.qpro&&(B.l+=2),U.e.c=B.read_shift(2),U.e.r=B.read_shift(2),W==12&&j.qpro&&(B.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function l(B){var W=J(8);return W.write_shift(2,B.s.c),W.write_shift(2,B.s.r),W.write_shift(2,B.e.c),W.write_shift(2,B.e.r),W}function c(B,W,j){var U=[{c:0,r:0},{t:"n",v:0},0,0];return j.qpro&&j.vers!=20768?(U[0].c=B.read_shift(1),U[3]=B.read_shift(1),U[0].r=B.read_shift(2),B.l+=2):(U[2]=B.read_shift(1),U[0].c=B.read_shift(2),U[0].r=B.read_shift(2)),U}function f(B,W,j){var U=B.l+W,Z=c(B,W,j);if(Z[1].t="s",j.vers==20768){B.l++;var me=B.read_shift(1);return Z[1].v=B.read_shift(me,"utf8"),Z}return j.qpro&&B.l++,Z[1].v=B.read_shift(U-B.l,"cstr"),Z}function h(B,W,j){var U=J(7+j.length);U.write_shift(1,255),U.write_shift(2,W),U.write_shift(2,B),U.write_shift(1,39);for(var Z=0;Z<U.length;++Z){var me=j.charCodeAt(Z);U.write_shift(1,me>=128?95:me)}return U.write_shift(1,0),U}function d(B,W,j){var U=c(B,W,j);return U[1].v=B.read_shift(2,"i"),U}function m(B,W,j){var U=J(7);return U.write_shift(1,255),U.write_shift(2,W),U.write_shift(2,B),U.write_shift(2,j,"i"),U}function _(B,W,j){var U=c(B,W,j);return U[1].v=B.read_shift(8,"f"),U}function g(B,W,j){var U=J(13);return U.write_shift(1,255),U.write_shift(2,W),U.write_shift(2,B),U.write_shift(8,j,"f"),U}function w(B,W,j){var U=B.l+W,Z=c(B,W,j);if(Z[1].v=B.read_shift(8,"f"),j.qpro)B.l=U;else{var me=B.read_shift(2);V(B.slice(B.l,B.l+me),Z),B.l+=me}return Z}function S(B,W,j){var U=W&32768;return W&=-32769,W=(U?B:0)+(W>=8192?W-16384:W),(U?"":"$")+(j?dr(W):er(W))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},I=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function V(B,W){jr(B,0);for(var j=[],U=0,Z="",me="",Te="",xe="";B.l<B.length;){var he=B[B.l++];switch(he){case 0:j.push(B.read_shift(8,"f"));break;case 1:me=S(W[0].c,B.read_shift(2),!0),Z=S(W[0].r,B.read_shift(2),!1),j.push(me+Z);break;case 2:{var je=S(W[0].c,B.read_shift(2),!0),Fe=S(W[0].r,B.read_shift(2),!1);me=S(W[0].c,B.read_shift(2),!0),Z=S(W[0].r,B.read_shift(2),!1),j.push(je+Fe+":"+me+Z)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:j.push("("+j.pop()+")");break;case 5:j.push(B.read_shift(2));break;case 6:{for(var Pt="";he=B[B.l++];)Pt+=String.fromCharCode(he);j.push('"'+Pt.replace(/"/g,'""')+'"')}break;case 8:j.push("-"+j.pop());break;case 23:j.push("+"+j.pop());break;case 22:j.push("NOT("+j.pop()+")");break;case 20:case 21:xe=j.pop(),Te=j.pop(),j.push(["AND","OR"][he-20]+"("+Te+","+xe+")");break;default:if(he<32&&I[he])xe=j.pop(),Te=j.pop(),j.push(Te+I[he]+xe);else if(x[he]){if(U=x[he][1],U==69&&(U=B[B.l++]),U>j.length){console.error("WK1 bad formula parse 0x"+he.toString(16)+":|"+j.join("|")+"|");return}var Be=j.slice(-U);j.length-=U,j.push(x[he][0]+"("+Be.join(",")+")")}else return he<=7?console.error("WK1 invalid opcode "+he.toString(16)):he<=24?console.error("WK1 unsupported op "+he.toString(16)):he<=30?console.error("WK1 invalid opcode "+he.toString(16)):he<=115?console.error("WK1 unsupported function opcode "+he.toString(16)):console.error("WK1 unrecognized opcode "+he.toString(16))}}j.length==1?W[1].f=""+j[0]:console.error("WK1 bad formula parse |"+j.join("|")+"|")}function b(B){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=B.read_shift(2),W[3]=B[B.l++],W[0].c=B[B.l++],W}function H(B,W){var j=b(B);return j[1].t="s",j[1].v=B.read_shift(W-4,"cstr"),j}function E(B,W,j,U){var Z=J(6+U.length);Z.write_shift(2,B),Z.write_shift(1,j),Z.write_shift(1,W),Z.write_shift(1,39);for(var me=0;me<U.length;++me){var Te=U.charCodeAt(me);Z.write_shift(1,Te>=128?95:Te)}return Z.write_shift(1,0),Z}function y(B,W){var j=b(B);j[1].v=B.read_shift(2);var U=j[1].v>>1;if(j[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return j[1].v=U,j}function T(B,W){var j=b(B),U=B.read_shift(4),Z=B.read_shift(4),me=B.read_shift(2);if(me==65535)return U===0&&Z===3221225472?(j[1].t="e",j[1].v=15):U===0&&Z===3489660928?(j[1].t="e",j[1].v=42):j[1].v=0,j;var Te=me&32768;return me=(me&32767)-16446,j[1].v=(1-Te*2)*(Z*Math.pow(2,me+32)+U*Math.pow(2,me)),j}function C(B,W,j,U){var Z=J(14);if(Z.write_shift(2,B),Z.write_shift(1,j),Z.write_shift(1,W),U==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var me=0,Te=0,xe=0,he=0;return U<0&&(me=1,U=-U),Te=Math.log2(U)|0,U/=Math.pow(2,Te-31),he=U>>>0,he&2147483648||(U/=2,++Te,he=U>>>0),U-=he,he|=2147483648,he>>>=0,U*=Math.pow(2,32),xe=U>>>0,Z.write_shift(4,xe),Z.write_shift(4,he),Te+=16383+(me?32768:0),Z.write_shift(2,Te),Z}function N(B,W){var j=T(B);return B.l+=W-14,j}function L(B,W){var j=b(B),U=B.read_shift(4);return j[1].v=U>>6,j}function P(B,W){var j=b(B),U=B.read_shift(8,"f");return j[1].v=U,j}function Ie(B,W){var j=P(B);return B.l+=W-10,j}function Ae(B,W){return B[B.l+W-1]==0?B.read_shift(W,"cstr"):""}function ht(B,W){var j=B[B.l++];j>W-1&&(j=W-1);for(var U="";U.length<j;)U+=String.fromCharCode(B[B.l++]);return U}function $e(B,W,j){if(!(!j.qpro||W<21)){var U=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var Z=B.read_shift(W-21,"cstr");return[U,Z]}}function ue(B,W){for(var j={},U=B.l+W;B.l<U;){var Z=B.read_shift(2);if(Z==14e3){for(j[Z]=[0,""],j[Z][0]=B.read_shift(2);B[B.l];)j[Z][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return j}function ye(B,W){var j=J(5+B.length);j.write_shift(2,14e3),j.write_shift(2,W);for(var U=0;U<B.length;++U){var Z=B.charCodeAt(U);j[j.l++]=Z>127?95:Z}return j[j.l++]=0,j}var we={0:{n:"BOF",f:E2},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:_},15:{n:"LABEL",f},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ae},222:{n:"SHEETNAMELP",f:ht},65535:{n:""}},De={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:H},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:y},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ue},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:P},40:{n:"FORMULA28",f:Ie},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:$e},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}(),YD=/^\s|\s$|[\t\n\r]/;function C2(t,e){if(!e.bookSST)return"";var r=[kt];r[r.length]=oe("sst",null,{xmlns:yo[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(YD)&&(s+=' xml:space="preserve"'),s+=">"+Qe(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function JD(t){return[t.read_shift(4),t.read_shift(4)]}function ZD(t,e){return e||(e=J(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var eF=H3;function tF(t){var e=Dr();te(e,159,ZD(t));for(var r=0;r<t.length;++r)te(e,19,eF(t[r]));return te(e,160),e.end()}function rF(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function R2(t){var e=0,r,n=rF(t),i=n.length+1,s,a,o,l,c;for(r=Gs(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var nF=function(){function t(i,s){switch(s.type){case"base64":return e(vi(i),s);case"binary":return e(i,s);case"buffer":return e(Ge&&Buffer.isBuffer(i)?i.toString("binary"):Eu(i),s);case"array":return e(kh(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,m=0,_,g=-1;_=d.exec(f);){switch(_[0]){case"\\cell":var w=f.slice(m,d.lastIndex-_[0].length);if(w[0]==" "&&(w=w.slice(1)),++g,w.length){var S={v:w,t:"s"};Array.isArray(o)?o[h][g]=S:o[Ze({r:h,c:g})]=S}break}m=d.lastIndex}g>c.e.c&&(c.e.c=g)}),o["!ref"]=Rt(c),o}function r(i,s){return Zs(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=ut(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var h=Ze({r:c,c:f});o=l?(i[c]||[])[f]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(_i(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function K_(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}var iF=6,oi=iF;function Uf(t){return Math.floor((t+Math.round(128/oi)/256)*oi)}function bf(t){return Math.floor((t-5)/oi*100+.5)/100}function sp(t){return Math.round((t*oi+5)/oi*256)/256}function ug(t){t.width?(t.wpx=Uf(t.width),t.wch=bf(t.wpx),t.MDW=oi):t.wpx?(t.wch=bf(t.wpx),t.width=sp(t.wch),t.MDW=oi):typeof t.wch=="number"&&(t.width=sp(t.wch),t.wpx=Uf(t.width),t.MDW=oi),t.customWidth&&delete t.customWidth}var sF=96,k2=sF;function jf(t){return t*96/k2}function P2(t){return t*k2/96}function aF(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=oe("numFmt",null,{numFmtId:n,formatCode:Qe(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=oe("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function oF(t){var e=[];return e[e.length]=oe("cellXfs",null),t.forEach(function(r){e[e.length]=oe("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=oe("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function N2(t,e){var r=[kt,oe("styleSheet",null,{xmlns:yo[0],"xmlns:vt":Ut.vt})],n;return t.SSF&&(n=aF(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=oF(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function lF(t,e){var r=t.read_shift(2),n=pr(t);return[r,n]}function uF(t,e,r){r||(r=J(6+4*e.length)),r.write_shift(2,t),jt(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function cF(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=Y3(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=Q3(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=pr(t),n}function fF(t,e){e||(e=J(25+4*32)),e.write_shift(2,t.sz*20),J3(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Vf(t.color,e);var n=0;return n=2,e.write_shift(1,n),jt(t.name,e),e.length>e.l?e.slice(0,e.l):e}var hF=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],P0,dF=bn;function q_(t,e){e||(e=J(4*3+8*7+16*1)),P0||(P0=Ym(hF));var r=P0[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Vf({auto:1},e),Vf({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function pF(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function O2(t,e,r){r||(r=J(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function $o(t,e){return e||(e=J(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var mF=bn;function gF(t,e){return e||(e=J(51)),e.write_shift(1,0),$o(null,e),$o(null,e),$o(null,e),$o(null,e),$o(null,e),e.length>e.l?e.slice(0,e.l):e}function vF(t,e){return e||(e=J(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Mf(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function _F(t,e,r){var n=J(2052);return n.write_shift(4,t),Mf(e,n),Mf(r,n),n.length>n.l?n.slice(0,n.l):n}function yF(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(te(t,615,Tn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&te(t,44,uF(i,e[i]))}),te(t,616))}}function xF(t){var e=1;te(t,611,Tn(e)),te(t,43,fF({sz:12,color:{theme:1},name:"Calibri",family:2})),te(t,612)}function EF(t){var e=2;te(t,603,Tn(e)),te(t,45,q_({patternType:"none"})),te(t,45,q_({patternType:"gray125"})),te(t,604)}function TF(t){var e=1;te(t,613,Tn(e)),te(t,46,gF()),te(t,614)}function wF(t){var e=1;te(t,626,Tn(e)),te(t,47,O2({numFmtId:0},65535)),te(t,627)}function SF(t,e){te(t,617,Tn(e.length)),e.forEach(function(r){te(t,47,O2(r,0))}),te(t,618)}function AF(t){var e=1;te(t,619,Tn(e)),te(t,48,vF({xfId:0,name:"Normal"})),te(t,620)}function IF(t){var e=0;te(t,505,Tn(e)),te(t,506)}function CF(t){var e=0;te(t,508,_F(e,"TableStyleMedium9","PivotStyleMedium4")),te(t,509)}function RF(t,e){var r=Dr();return te(r,278),yF(r,t.SSF),xF(r),EF(r),TF(r),wF(r),SF(r,e.cellXfs),AF(r),IF(r),CF(r),te(r,279),r.end()}function D2(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[kt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function kF(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:pr(t)}}function PF(t){var e=J(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),jt(t.name,e),e.slice(0,e.l)}function NF(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function OF(t){var e=J(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function DF(t,e){var r=J(8+2*e.length);return r.write_shift(4,t),jt(e,r),r.slice(0,r.l)}function FF(t){return t.l+=4,t.read_shift(4)!=0}function LF(t,e){var r=J(8);return r.write_shift(4,t),r.write_shift(4,1),r}function MF(){var t=Dr();return te(t,332),te(t,334,Tn(1)),te(t,335,PF({name:"XLDAPR",version:12e4,flags:3496657072})),te(t,336),te(t,339,DF(1,"XLDAPR")),te(t,52),te(t,35,Tn(514)),te(t,4096,Tn(0)),te(t,4097,en(1)),te(t,36),te(t,53),te(t,340),te(t,337,LF(1)),te(t,51,OF([[1,0]])),te(t,338),te(t,333),t.end()}function F2(){var t=[kt];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function VF(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Ze(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}var Na=1024;function L2(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[oe("xml",null,{"xmlns:v":zr.v,"xmlns:o":zr.o,"xmlns:x":zr.x,"xmlns:mv":zr.mv}).replace(/\/>/,">"),oe("o:shapelayout",oe("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),oe("v:shapetype",[oe("v:stroke",null,{joinstyle:"miter"}),oe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Na<t*1e3;)Na+=1e3;return e.forEach(function(s){var a=bt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?oe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=oe("v:fill",l,o),f={on:"t",obscured:"t"};++Na,i=i.concat(["<v:shape"+Zl({id:"_x0000_s"+Na,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,oe("v:shadow",null,f),oe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Yt("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Yt("x:AutoFill","False"),Yt("x:Row",String(a.r)),Yt("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function M2(t){var e=[kt,oe("comments",null,{xmlns:yo[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=Qe(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Qe(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Yt("t",Qe(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Yt("t",Qe(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function BF(t,e,r){var n=[kt,oe("ThreadedComments",null,{xmlns:Ut.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(oe("threadedComment",Yt("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function UF(t){var e=[kt,oe("personList",null,{xmlns:Ut.TCMNT,"xmlns:x":yo[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(oe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function bF(t){var e={};e.iauthor=t.read_shift(4);var r=na(t);return e.rfx=r.s,e.ref=Ze(r.s),t.l+=16,e}function jF(t,e){return e==null&&(e=J(36)),e.write_shift(4,t[1].iauthor),Eo(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var zF=pr;function WF(t){return jt(t.slice(0,54))}function HF(t){var e=Dr(),r=[];return te(e,628),te(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),te(e,632,WF(i.a)))})}),te(e,631),te(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:bt(n[0]),e:bt(n[0])};te(e,635,jF([s,i])),i.t&&i.t.length>0&&te(e,637,G3(i)),te(e,636),delete i.iauthor})}),te(e,634),te(e,629),e.end()}function $F(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&et.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var V2=["xlsb","xlsm","xlam","biff8","xla"],GF=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,l?c+=e.r:--c,i+(o?"":"$")+dr(f)+(l?"":"$")+er(c)}return function(i,s){return e=s,i.replace(t,r)}}(),cg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,fg=function(){return function(e,r){return e.replace(cg,function(n,i,s,a,o,l){var c=ig(a)-(s?0:r.c),f=ng(l)-(o?0:r.r),h=f==0?"":o?f+1:"["+f+"]",d=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+d})}}();function KF(t,e){return t.replace(cg,function(r,n,i,s,a,o){return n+(i=="$"?i+s:dr(ig(s)+e.c))+(a=="$"?a+o:er(ng(o)+e.r))})}function qF(t){return t.length!=1}function St(t){t.l+=1}function as(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function B2(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return U2(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=as(t),o=as(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function U2(t){var e=as(t),r=as(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function XF(t,e,r){if(r.biff<8)return U2(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=as(t),a=as(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function b2(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return QF(t);var n=t.read_shift(r&&r.biff==12?4:2),i=as(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function QF(t){var e=as(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function YF(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function JF(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return ZF(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function ZF(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function eL(t,e,r){var n=(t[t.l++]&96)>>5,i=B2(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function tL(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=B2(t,s,r);return[n,i,a]}function rL(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function nL(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function iL(t,e,r){var n=(t[t.l++]&96)>>5,i=XF(t,e-1,r);return[n,i]}function sL(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function X_(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function aL(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function oL(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function lL(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function uL(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function cL(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function j2(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function fL(t){return t.read_shift(2),j2(t)}function hL(t){return t.read_shift(2),j2(t)}function dL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=b2(t,0,r);return[n,i]}function pL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=JF(t,0,r);return[n,i]}function mL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=b2(t,0,r);return[n,i,s]}function gL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[g6[i],H2[i],n]}function vL(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:_L(t);return[i,(s[0]===0?H2:m6)[s[1]]]}function _L(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function yL(t,e,r){t.l+=r&&r.biff==2?3:4}function xL(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function EL(t){return t.l++,Su[t.read_shift(1)]}function TL(t){return t.l++,t.read_shift(2)}function wL(t){return t.l++,t.read_shift(1)!==0}function SL(t){return t.l++,To(t)}function AL(t,e,r){return t.l++,w2(t,e-1,r)}function IL(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=mD(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Su[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=To(t);break;case 2:r[1]=yD(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function CL(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?na:TD)(t));return i}function RL(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=IL(t,r.biff);return a}function kL(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function PL(t,e,r){if(r.biff==5)return NL(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function NL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function OL(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function DL(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function FL(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function LL(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var ML=bn,VL=bn,BL=bn;function Au(t,e,r){return t.l+=2,[YF(t)]}function hg(t){return t.l+=6,[]}var UL=Au,bL=hg,jL=hg,zL=Au;function z2(t){return t.l+=2,[E2(t),t.read_shift(2)&1]}var WL=Au,HL=z2,$L=hg,GL=Au,KL=Au,qL=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function XL(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=qL[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function QL(t){return t.l+=2,[t.read_shift(4)]}function YL(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function JL(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function ZL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function e6(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function t6(t){return t.l+=4,[0,0]}var Q_={1:{n:"PtgExp",f:xL},2:{n:"PtgTbl",f:BL},3:{n:"PtgAdd",f:St},4:{n:"PtgSub",f:St},5:{n:"PtgMul",f:St},6:{n:"PtgDiv",f:St},7:{n:"PtgPower",f:St},8:{n:"PtgConcat",f:St},9:{n:"PtgLt",f:St},10:{n:"PtgLe",f:St},11:{n:"PtgEq",f:St},12:{n:"PtgGe",f:St},13:{n:"PtgGt",f:St},14:{n:"PtgNe",f:St},15:{n:"PtgIsect",f:St},16:{n:"PtgUnion",f:St},17:{n:"PtgRange",f:St},18:{n:"PtgUplus",f:St},19:{n:"PtgUminus",f:St},20:{n:"PtgPercent",f:St},21:{n:"PtgParen",f:St},22:{n:"PtgMissArg",f:St},23:{n:"PtgStr",f:AL},26:{n:"PtgSheet",f:YL},27:{n:"PtgEndSheet",f:JL},28:{n:"PtgErr",f:EL},29:{n:"PtgBool",f:wL},30:{n:"PtgInt",f:TL},31:{n:"PtgNum",f:SL},32:{n:"PtgArray",f:sL},33:{n:"PtgFunc",f:gL},34:{n:"PtgFuncVar",f:vL},35:{n:"PtgName",f:kL},36:{n:"PtgRef",f:dL},37:{n:"PtgArea",f:eL},38:{n:"PtgMemArea",f:OL},39:{n:"PtgMemErr",f:ML},40:{n:"PtgMemNoMem",f:VL},41:{n:"PtgMemFunc",f:DL},42:{n:"PtgRefErr",f:FL},43:{n:"PtgAreaErr",f:rL},44:{n:"PtgRefN",f:pL},45:{n:"PtgAreaN",f:iL},46:{n:"PtgMemAreaN",f:ZL},47:{n:"PtgMemNoMemN",f:e6},57:{n:"PtgNameX",f:PL},58:{n:"PtgRef3d",f:mL},59:{n:"PtgArea3d",f:tL},60:{n:"PtgRefErr3d",f:LL},61:{n:"PtgAreaErr3d",f:nL},255:{}},r6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},n6={1:{n:"PtgElfLel",f:z2},2:{n:"PtgElfRw",f:GL},3:{n:"PtgElfCol",f:UL},6:{n:"PtgElfRwV",f:KL},7:{n:"PtgElfColV",f:zL},10:{n:"PtgElfRadical",f:WL},11:{n:"PtgElfRadicalS",f:$L},13:{n:"PtgElfColS",f:bL},15:{n:"PtgElfColSV",f:jL},16:{n:"PtgElfRadicalLel",f:HL},25:{n:"PtgList",f:XL},29:{n:"PtgSxName",f:QL},255:{}},i6={0:{n:"PtgAttrNoop",f:t6},1:{n:"PtgAttrSemi",f:cL},2:{n:"PtgAttrIf",f:lL},4:{n:"PtgAttrChoose",f:aL},8:{n:"PtgAttrGoto",f:oL},16:{n:"PtgAttrSum",f:yL},32:{n:"PtgAttrBaxcel",f:X_},33:{n:"PtgAttrBaxcel",f:X_},64:{n:"PtgAttrSpace",f:fL},65:{n:"PtgAttrSpaceSemi",f:hL},128:{n:"PtgAttrIfError",f:uL},255:{}};function s6(t,e,r,n){if(n.biff<8)return bn(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=RL(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=CL(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(bn(t,e)),s}function a6(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=Q_[s]||Q_[r6[s]],(s===24||s===25)&&(i=(s===24?n6:i6)[t[t.l+1]]),!i||!i.f?bn(t,e):a.push([i.n,i.f(t,e,r)]);return a}function o6(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var l6={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function u6(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function W2(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Y_(t,e,r){var n=W2(t,e,r);return n=="#REF"?n:u6(n,r)}function lo(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,f,h=0,d=0,m,_="";if(!t[0]||!t[0][0])return"";for(var g=-1,w="",S=0,x=t[0].length;S<x;++S){var I=t[0][S];switch(I[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),g>=0){switch(t[0][g][1][0]){case 0:w=yt(" ",t[0][g][1][1]);break;case 1:w=yt("\r",t[0][g][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}c=c+w,g=-1}o.push(c+l6[I[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=xl(I[1][1],a,i),o.push(El(f,s));break;case"PtgRefN":f=r?xl(I[1][1],r,i):I[1][1],o.push(El(f,s));break;case"PtgRef3d":h=I[1][1],f=xl(I[1][2],a,i),_=Y_(n,h,i),o.push(_+"!"+El(f,s));break;case"PtgFunc":case"PtgFuncVar":var V=I[1][0],b=I[1][1];V||(V=0),V&=127;var H=V==0?[]:o.slice(-V);o.length-=V,b==="User"&&(b=H.shift()),o.push(b+"("+H.join(",")+")");break;case"PtgBool":o.push(I[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(I[1]);break;case"PtgNum":o.push(String(I[1]));break;case"PtgStr":o.push('"'+I[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(I[1]);break;case"PtgAreaN":m=L_(I[1][1],r?{s:r}:a,i),o.push(R0(m,i));break;case"PtgArea":m=L_(I[1][1],a,i),o.push(R0(m,i));break;case"PtgArea3d":h=I[1][1],m=I[1][2],_=Y_(n,h,i),o.push(_+"!"+R0(m,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=I[1][2];var E=(n.names||[])[d-1]||(n[0]||[])[d],y=E?E.Name:"SH33TJSNAME"+String(d);y&&y.slice(0,6)=="_xlfn."&&!i.xlfn&&(y=y.slice(6)),o.push(y);break;case"PtgNameX":var T=I[1][1];d=I[1][2];var C;if(i.biff<=5)T<0&&(T=-T),n[T]&&(C=n[T][d]);else{var N="";if(((n[T]||[])[0]||[])[0]==14849||(((n[T]||[])[0]||[])[0]==1025?n[T][d]&&n[T][d].itab>0&&(N=n.SheetNames[n[T][d].itab-1]+"!"):N=n.SheetNames[d-1]+"!"),n[T]&&n[T][d])N+=n[T][d].Name;else if(n[0]&&n[0][d])N+=n[0][d].Name;else{var L=(W2(n,T,i)||"").split(";;");L[d-1]?N=L[d-1]:N+="SH33TJSERRX"}o.push(N);break}C||(C={Name:"SH33TJSERRY"}),o.push(C.Name);break;case"PtgParen":var P="(",Ie=")";if(g>=0){switch(w="",t[0][g][1][0]){case 2:P=yt(" ",t[0][g][1][1])+P;break;case 3:P=yt("\r",t[0][g][1][1])+P;break;case 4:Ie=yt(" ",t[0][g][1][1])+Ie;break;case 5:Ie=yt("\r",t[0][g][1][1])+Ie;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}g=-1}o.push(P+o.pop()+Ie);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:I[1][1],r:I[1][0]};var Ae={c:r.c,r:r.r};if(n.sharedf[Ze(f)]){var ht=n.sharedf[Ze(f)];o.push(lo(ht,a,Ae,n,i))}else{var $e=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(lo(c[1],a,Ae,n,i)),$e=!0;break}$e||o.push(I[1])}break;case"PtgArray":o.push("{"+o6(I[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+I[1].idx+"[#"+I[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(I));default:throw new Error("Unrecognized Formula Token: "+String(I))}var ue=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&ue.indexOf(t[0][S][0])==-1){I=t[0][g];var ye=!0;switch(I[1][0]){case 4:ye=!1;case 0:w=yt(" ",I[1][1]);break;case 5:ye=!1;case 1:w=yt("\r",I[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+I[1][0])}o.push((ye?w:"")+o.pop()+(ye?"":w)),g=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function c6(t){if(t==null){var e=J(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Ks(t);return Ks(0)}function f6(t,e,r,n,i){var s=qs(e,r,i),a=c6(t.v),o=J(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=J(t.bf.length),f=0;f<t.bf.length;++f)c[f]=t.bf[f];var h=Qt([s,a,o,c]);return h}function Ph(t,e,r){var n=t.read_shift(4),i=a6(t,n,r),s=t.read_shift(4),a=s>0?s6(t,s,i,r):null;return[i,a]}var h6=Ph,Nh=Ph,d6=Ph,p6=Ph,m6={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},H2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},g6={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function v6(t){var e="of:="+t.replace(cg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function _6(t){return t.replace(/\./,"!")}var Tl=typeof Map<"u";function dg(t,e,r){var n=0,i=t.length;if(r){if(Tl?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Tl?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Tl?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Oh(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(oi=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=bf(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=sp(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function $2(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function hs(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){bw(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function y6(t,e,r){if(t&&t["!ref"]){var n=ut(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function x6(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Rt(t[r])+'"/>';return e+"</mergeCells>"}function E6(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=Jl(Qe(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),o=(o||"")+oe("outlinePr",null,c)}!s&&!o||(i[i.length]=oe("sheetPr",o,a))}var T6=["objects","scenarios","selectLockedCells","selectUnlockedCells"],w6=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function S6(t){var e={sheet:1};return T6.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),w6.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=R2(t.password).toString(16).toUpperCase()),oe("sheetProtection",null,e)}function A6(t){return $2(t),oe("pageMargins",null,t)}function I6(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=oe("col",null,Oh(i,n)));return r[r.length]="</cols>",r.join("")}function C6(t,e,r,n){var i=typeof t.ref=="string"?t.ref:Rt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=qr(i);a.s.r==a.e.r&&(a.e.r=qr(e["!ref"]).e.r,i=Rt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),oe("autoFilter",null,{ref:i})}function R6(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),oe("sheetViews",oe("sheetView",null,i),{})}function k6(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=Su[t.v];break;case"d":n&&n.cellDates?i=Tr(t.v,-1).toISOString():(t=Lr(t),t.t="n",i=""+(t.v=Fr(Tr(t.v)))),typeof t.z>"u"&&(t.z=xt[14]);break;default:i=t.v;break}var o=Yt("v",Qe(i)),l={r:e},c=hs(n.cellXfs,t,n);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Yt("v",""+dg(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var f=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=oe("f",Qe(t.f),f)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),oe("c",o,l)}function P6(t,e,r,n){var i=[],s=[],a=ut(t["!ref"]),o="",l,c="",f=[],h=0,d=0,m=t["!rows"],_=Array.isArray(t),g={r:c},w,S=-1;for(d=a.s.c;d<=a.e.c;++d)f[d]=dr(d);for(h=a.s.r;h<=a.e.r;++h){for(s=[],c=er(h),d=a.s.c;d<=a.e.c;++d){l=f[d]+c;var x=_?(t[h]||[])[d]:t[l];x!==void 0&&(o=k6(x,l,t,e))!=null&&s.push(o)}(s.length>0||m&&m[h])&&(g={r:c},m&&m[h]&&(w=m[h],w.hidden&&(g.hidden=1),S=-1,w.hpx?S=jf(w.hpx):w.hpt&&(S=w.hpt),S>-1&&(g.ht=S,g.customHeight=1),w.level&&(g.outlineLevel=w.level)),i[i.length]=oe("row",s.join(""),g))}if(m)for(;h<m.length;++h)m&&m[h]&&(g={r:h+1},w=m[h],w.hidden&&(g.hidden=1),S=-1,w.hpx?S=jf(w.hpx):w.hpt&&(S=w.hpt),S>-1&&(g.ht=S,g.customHeight=1),w.level&&(g.outlineLevel=w.level),i[i.length]=oe("row","",g));return i.join("")}function G2(t,e,r,n){var i=[kt,oe("worksheet",null,{xmlns:yo[0],"xmlns:r":Ut.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",f=ut(c);if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),c=Rt(f)}n||(n={}),l["!comments"]=[];var h=[];E6(l,r,t,e,i),i[i.length]=oe("dimension",null,{ref:c}),i[i.length]=R6(l,e,t,r),e.sheetFormat&&(i[i.length]=oe("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=I6(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=P6(l,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=S6(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=C6(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=x6(l["!merges"]));var d=-1,m,_=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(g){g[1].Target&&(m={ref:g[0]},g[1].Target.charAt(0)!="#"&&(_=Xe(n,-1,Qe(g[1].Target).replace(/#.*$/,""),We.HLINK),m["r:id"]="rId"+_),(d=g[1].Target.indexOf("#"))>-1&&(m.location=Qe(g[1].Target.slice(d+1))),g[1].Tooltip&&(m.tooltip=Qe(g[1].Tooltip)),i[i.length]=oe("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=A6(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Yt("ignoredErrors",oe("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(_=Xe(n,-1,"../drawings/drawing"+(t+1)+".xml",We.DRAW),i[i.length]=oe("drawing",null,{"r:id":"rId"+_}),l["!drawing"]=h),l["!comments"].length>0&&(_=Xe(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",We.VML),i[i.length]=oe("legacyDrawing",null,{"r:id":"rId"+_}),l["!legacy"]=_),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function N6(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function O6(t,e,r){var n=J(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=jf(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:t,c:0},f=0;f<16;++f)if(!(e.s.c>f+1<<10||e.e.c<f<<10)){for(var h=-1,d=-1,m=f<<10;m<f+1<<10;++m){c.c=m;var _=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Ze(c)];_&&(h<0&&(h=m),d=m)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,d))}var g=n.l;return n.l=l,n.write_shift(4,o),n.l=g,n.length>n.l?n.slice(0,n.l):n}function D6(t,e,r,n){var i=O6(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&te(t,0,i)}var F6=na,L6=Eo;function M6(){}function V6(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=K3(t),r}function B6(t,e,r){r==null&&(r=J(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Vf({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),o2(t,r),r.slice(0,r.l)}function U6(t){var e=ln(t);return[e]}function b6(t,e,r){return r==null&&(r=J(8)),ea(e,r)}function j6(t){var e=ta(t);return[e]}function z6(t,e,r){return r==null&&(r=J(4)),ra(e,r)}function W6(t){var e=ln(t),r=t.read_shift(1);return[e,r,"b"]}function H6(t,e,r){return r==null&&(r=J(9)),ea(e,r),r.write_shift(1,t.v?1:0),r}function $6(t){var e=ta(t),r=t.read_shift(1);return[e,r,"b"]}function G6(t,e,r){return r==null&&(r=J(5)),ra(e,r),r.write_shift(1,t.v?1:0),r}function K6(t){var e=ln(t),r=t.read_shift(1);return[e,r,"e"]}function q6(t,e,r){return r==null&&(r=J(9)),ea(e,r),r.write_shift(1,t.v),r}function X6(t){var e=ta(t),r=t.read_shift(1);return[e,r,"e"]}function Q6(t,e,r){return r==null&&(r=J(8)),ra(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function Y6(t){var e=ln(t),r=t.read_shift(4);return[e,r,"s"]}function J6(t,e,r){return r==null&&(r=J(12)),ea(e,r),r.write_shift(4,e.v),r}function Z6(t){var e=ta(t),r=t.read_shift(4);return[e,r,"s"]}function eM(t,e,r){return r==null&&(r=J(8)),ra(e,r),r.write_shift(4,e.v),r}function tM(t){var e=ln(t),r=To(t);return[e,r,"n"]}function rM(t,e,r){return r==null&&(r=J(16)),ea(e,r),Ks(t.v,r),r}function nM(t){var e=ta(t),r=To(t);return[e,r,"n"]}function iM(t,e,r){return r==null&&(r=J(12)),ra(e,r),Ks(t.v,r),r}function sM(t){var e=ln(t),r=l2(t);return[e,r,"n"]}function aM(t,e,r){return r==null&&(r=J(12)),ea(e,r),u2(t.v,r),r}function oM(t){var e=ta(t),r=l2(t);return[e,r,"n"]}function lM(t,e,r){return r==null&&(r=J(8)),ra(e,r),u2(t.v,r),r}function uM(t){var e=ln(t),r=sg(t);return[e,r,"is"]}function cM(t){var e=ln(t),r=pr(t);return[e,r,"str"]}function fM(t,e,r){return r==null&&(r=J(12+4*t.v.length)),ea(e,r),jt(t.v,r),r.length>r.l?r.slice(0,r.l):r}function hM(t){var e=ta(t),r=pr(t);return[e,r,"str"]}function dM(t,e,r){return r==null&&(r=J(8+4*t.v.length)),ra(e,r),jt(t.v,r),r.length>r.l?r.slice(0,r.l):r}function pM(t,e,r){var n=t.l+e,i=ln(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=Nh(t,n-t.l,r);a[3]=lo(o,null,i,r.supbooks,r)}else t.l=n;return a}function mM(t,e,r){var n=t.l+e,i=ln(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=Nh(t,n-t.l,r);a[3]=lo(o,null,i,r.supbooks,r)}else t.l=n;return a}function gM(t,e,r){var n=t.l+e,i=ln(t);i.r=r["!row"];var s=To(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=Nh(t,n-t.l,r);a[3]=lo(o,null,i,r.supbooks,r)}else t.l=n;return a}function vM(t,e,r){var n=t.l+e,i=ln(t);i.r=r["!row"];var s=pr(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=Nh(t,n-t.l,r);a[3]=lo(o,null,i,r.supbooks,r)}else t.l=n;return a}var _M=na,yM=Eo;function xM(t,e){return e==null&&(e=J(4)),e.write_shift(4,t),e}function EM(t,e){var r=t.l+e,n=na(t),i=ag(t),s=pr(t),a=pr(t),o=pr(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function TM(t,e){var r=J(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Eo({s:bt(t[0]),e:bt(t[0])},r),og("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return jt(i||"",r),jt(t[1].Tooltip||"",r),jt("",r),r.slice(0,r.l)}function wM(){}function SM(t,e,r){var n=t.l+e,i=c2(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=h6(t,n-t.l,r);a[1]=o}else t.l=n;return a}function AM(t,e,r){var n=t.l+e,i=na(t),s=[i];if(r.cellFormula){var a=p6(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function IM(t,e,r){r==null&&(r=J(18));var n=Oh(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var K2=["left","right","top","bottom","header","footer"];function CM(t){var e={};return K2.forEach(function(r){e[r]=To(t)}),e}function RM(t,e){return e==null&&(e=J(6*8)),$2(t),K2.forEach(function(r){Ks(t[r],e)}),e}function kM(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function PM(t,e,r){r==null&&(r=J(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function NM(t){var e=J(24);return e.write_shift(4,4),e.write_shift(4,1),Eo(t,e),e}function OM(t,e){return e==null&&(e=J(16*4+2)),e.write_shift(2,t.password?R2(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function DM(){}function FM(){}function LM(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Lr(e),e.z=e.z||xt[14],e.v=Fr(Tr(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=hs(i.cellXfs,e,i),e.l&&s["!links"].push([Ze(l),e.l]),e.c&&s["!comments"].push([Ze(l),e.c]),e.t){case"s":case"str":return i.bookSST?(o=dg(i.Strings,e.v,i.revStrings),l.t="s",l.v=o,a?te(t,18,eM(e,l)):te(t,7,J6(e,l))):(l.t="str",a?te(t,17,dM(e,l)):te(t,6,fM(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?te(t,13,lM(e,l)):te(t,2,aM(e,l)):a?te(t,16,iM(e,l)):te(t,5,rM(e,l)),!0;case"b":return l.t="b",a?te(t,15,G6(e,l)):te(t,4,H6(e,l)),!0;case"e":return l.t="e",a?te(t,14,Q6(e,l)):te(t,3,q6(e,l)),!0}return a?te(t,12,z6(e,l)):te(t,1,b6(e,l)),!0}function MM(t,e,r,n){var i=ut(e["!ref"]||"A1"),s,a="",o=[];te(t,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var f=i.s.r;f<=c;++f){a=er(f),D6(t,e,i,f);var h=!1;if(f<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){f===i.s.r&&(o[d]=dr(d)),s=o[d]+a;var m=l?(e[f]||[])[d]:e[s];if(!m){h=!1;continue}h=LM(t,m,f,d,n,e,h)}}te(t,146)}function VM(t,e){!e||!e["!merges"]||(te(t,177,xM(e["!merges"].length)),e["!merges"].forEach(function(r){te(t,176,yM(r))}),te(t,178))}function BM(t,e){!e||!e["!cols"]||(te(t,390),e["!cols"].forEach(function(r,n){r&&te(t,60,IM(n,r))}),te(t,391))}function UM(t,e){!e||!e["!ref"]||(te(t,648),te(t,649,NM(ut(e["!ref"]))),te(t,650))}function bM(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=Xe(r,-1,n[1].Target.replace(/#.*$/,""),We.HLINK);te(t,494,TM(n,i))}}),delete e["!links"]}function jM(t,e,r,n){if(e["!comments"].length>0){var i=Xe(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",We.VML);te(t,551,og("rId"+i)),e["!legacy"]=i}}function zM(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Rt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=qr(s);o.s.r==o.e.r&&(o.e.r=qr(e["!ref"]).e.r,s=Rt(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),te(t,161,Eo(ut(s))),te(t,162)}}function WM(t,e,r){te(t,133),te(t,137,PM(e,r)),te(t,138),te(t,134)}function HM(t,e){e["!protect"]&&te(t,535,OM(e["!protect"]))}function $M(t,e,r,n){var i=Dr(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=ut(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],te(i,129),(r.vbaraw||a["!outline"])&&te(i,147,B6(o,a["!outline"])),te(i,148,L6(l)),WM(i,a,r.Workbook),BM(i,a),MM(i,a,t,e),HM(i,a),zM(i,a,r,t),VM(i,a),bM(i,a,n),a["!margins"]&&te(i,476,RM(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&UM(i,a),jM(i,a,t,n),te(i,130),i.end()}function GM(t,e){t.l+=10;var r=pr(t);return{name:r}}var KM=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function qM(t){return!t.Workbook||!t.Workbook.WBProps?"false":A3(t.Workbook.WBProps.date1904)?"true":"false"}var XM="][*?/\\".split("");function q2(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return XM.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function QM(t,e,r){t.forEach(function(n,i){q2(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function YM(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];QM(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)y6(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}function X2(t){var e=[kt];e[e.length]=oe("workbook",null,{xmlns:yo[0],"xmlns:r":Ut.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(KM.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=oe("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:Qe(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=oe("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=oe("definedName",Qe(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function JM(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=ip(t),r.name=pr(t),r}function ZM(t,e){return e||(e=J(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),og(t.strRelID,e),jt(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function e8(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?pr(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function t8(t,e){e||(e=J(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),o2(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function r8(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=q3(t),a=d6(t,0,r),o=ag(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function n8(t,e){te(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};te(t,156,ZM(i))}te(t,144)}function i8(t,e){e||(e=J(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return jt("SheetJS",e),jt(kf.version,e),jt(kf.version,e),jt("7262",e),e.length>e.l?e.slice(0,e.l):e}function s8(t,e){e||(e=J(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function a8(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(te(t,135),te(t,158,s8(i)),te(t,136))}}function o8(t,e){var r=Dr();return te(r,131),te(r,128,i8()),te(r,153,t8(t.Workbook&&t.Workbook.WBProps||null)),a8(r,t),n8(r,t),te(r,132),r.end()}function l8(t,e,r){return(e.slice(-4)===".bin"?o8:X2)(t)}function u8(t,e,r,n,i){return(e.slice(-4)===".bin"?$M:G2)(t,r,n,i)}function c8(t,e,r){return(e.slice(-4)===".bin"?RF:N2)(t,r)}function f8(t,e,r){return(e.slice(-4)===".bin"?tF:C2)(t,r)}function h8(t,e,r){return(e.slice(-4)===".bin"?HF:M2)(t)}function d8(t){return(t.slice(-4)===".bin"?MF:F2)()}function p8(t,e){var r=[];return t.Props&&r.push(cD(t.Props,e)),t.Custprops&&r.push(fD(t.Props,t.Custprops)),r.join("")}function m8(){return""}function g8(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(oe("NumberFormat",null,{"ss:Format":Qe(xt[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(oe("Style",s.join(""),a))}),oe("Styles",r.join(""))}function Q2(t){return oe("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+fg(t.Ref,{r:0,c:0})})}function v8(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(Q2(i)))}return oe("Names",r.join(""))}function _8(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(Q2(o)))}return s.join("")}function y8(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(oe("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(oe("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(oe("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(oe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Yt("ProtectContents","True")),t["!protect"].objects&&i.push(Yt("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Yt("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Yt("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Yt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":oe("WorksheetOptions",i.join(""),{xmlns:zr.x})}function x8(t){return t.map(function(e){var r=S3(e.t||""),n=oe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return oe("Comment",n,{"ss:Author":e.a})}).join("")}function E8(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Qe(fg(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=bt(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Qe(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Qe(t.l.Tooltip))),r["!merges"])for(var c=r["!merges"],f=0;f!=c.length;++f)c[f].s.c!=a.c||c[f].s.r!=a.r||(c[f].e.c>c[f].s.c&&(o["ss:MergeAcross"]=c[f].e.c-c[f].s.c),c[f].e.r>c[f].s.r&&(o["ss:MergeDown"]=c[f].e.r-c[f].s.r));var h="",d="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",d=String(t.v);break;case"b":h="Boolean",d=t.v?"1":"0";break;case"e":h="Error",d=Su[t.v];break;case"d":h="DateTime",d=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||xt[14]);break;case"s":h="String",d=w3(t.v||"");break}var m=hs(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=a.c+1;var _=t.v!=null?d:"",g=t.t=="z"?"":'<Data ss:Type="'+h+'">'+_+"</Data>";return(t.c||[]).length>0&&(g+=x8(t.c)),oe("Cell",g,o)}function T8(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=P2(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function w8(t,e,r,n){if(!t["!ref"])return"";var i=ut(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(w,S){ug(w);var x=!!w.width,I=Oh(S,w),V={"ss:Index":S+1};x&&(V["ss:Width"]=Uf(I.width)),w.hidden&&(V["ss:Hidden"]="1"),o.push(oe("Column",null,V))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var f=[T8(c,(t["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var d=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>c)&&!(s[a].e.c<h)&&!(s[a].e.r<c)){(s[a].s.c!=h||s[a].s.r!=c)&&(d=!0);break}if(!d){var m={r:c,c:h},_=Ze(m),g=l?(t[c]||[])[h]:t[_];f.push(E8(g,_,t,e,r,n,m))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function S8(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?_8(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?w8(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(y8(s,e,t,r)),n.join("")}function A8(t,e){e||(e={}),t.SSF||(t.SSF=Lr(xt)),t.SSF&&(Ch(),Ih(t.SSF),e.revssf=Rh(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],hs(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(p8(t,e)),r.push(m8()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(oe("Worksheet",S8(n,e,t),{"ss:Name":Qe(t.SheetNames[n])}));return r[2]=g8(t,e),r[3]=v8(t),kt+oe("Workbook",r.join(""),{xmlns:zr.ss,"xmlns:o":zr.o,"xmlns:x":zr.x,"xmlns:ss":zr.ss,"xmlns:dt":zr.dt,"xmlns:html":zr.html})}var N0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function I8(t,e){var r=[],n=[],i=[],s=0,a,o=S_(V_,"n"),l=S_(B_,"n");if(t.Props)for(a=ir(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=ir(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)x2.indexOf(i[s][0])>-1||v2.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&et.utils.cfb_add(e,"/SummaryInformation",W_(n,N0.SI,l,B_)),(r.length||c.length)&&et.utils.cfb_add(e,"/DocumentSummaryInformation",W_(r,N0.DSI,o,V_,c.length?c:null,N0.UDI))}function C8(t,e){var r=e||{},n=et.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return et.utils.cfb_add(n,i,Y2(t,r)),r.biff==8&&(t.Props||t.Custprops)&&I8(t,n),r.biff==8&&t.vbaraw&&$F(n,et.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var R8={0:{f:N6},1:{f:U6},2:{f:sM},3:{f:K6},4:{f:W6},5:{f:tM},6:{f:cM},7:{f:Y6},8:{f:vM},9:{f:gM},10:{f:pM},11:{f:mM},12:{f:j6},13:{f:oM},14:{f:X6},15:{f:$6},16:{f:nM},17:{f:hM},18:{f:Z6},19:{f:sg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:r8},40:{},42:{},43:{f:cF},44:{f:lF},45:{f:dF},46:{f:mF},47:{f:pF},48:{},49:{f:j3},50:{},51:{f:NF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zD},62:{f:uM},63:{f:VF},64:{f:DM},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:bn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:kM},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:V6},148:{f:F6,p:16},151:{f:wM},152:{},153:{f:e8},154:{},155:{},156:{f:JM},157:{},158:{},159:{T:1,f:JD},160:{T:-1},161:{T:1,f:na},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:_M},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:kF},336:{T:-1},337:{f:FF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ip},357:{},358:{},359:{},360:{T:1},361:{},362:{f:MD},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:SM},427:{f:AM},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:CM},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:M6},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:EM},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ip},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:zF},633:{T:1},634:{T:-1},635:{T:1,f:bF},636:{T:-1},637:{f:$3},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:GM},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:FM},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function le(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&rg(r)&&t.push(r)}}function k8(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return le(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var f=t.next(4);for(f.write_shift(2,s),f.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c;l<i;){for(f=t.next(4),f.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;f.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c}}}function Iu(t,e,r){return t||(t=J(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function P8(t,e,r,n){var i=J(9);return Iu(i,t,e),T2(r,n||"b",i),i}function N8(t,e,r){var n=J(8+2*r.length);return Iu(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function O8(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Fr(Tr(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?le(t,2,GD(r,n,i)):le(t,3,$D(r,n,i));return;case"b":case"e":le(t,5,P8(r,n,e.v,e.t));return;case"s":case"str":le(t,4,N8(r,n,(e.v||"").slice(0,255)));return}le(t,1,Iu(null,r,n))}function D8(t,e,r,n){var i=Array.isArray(e),s=ut(e["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Rt(s)}for(var c=s.s.r;c<=s.e.r;++c){o=er(c);for(var f=s.s.c;f<=s.e.c;++f){c===s.s.r&&(l[f]=dr(f)),a=l[f]+o;var h=i?(e[c]||[])[f]:e[a];h&&O8(t,h,c,f)}}}function F8(t,e){for(var r=e||{},n=Dr(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return le(n,r.biff==4?1033:r.biff==3?521:9,lg(t,16,r)),D8(n,t.Sheets[t.SheetNames[i]],i,r),le(n,10),n.end()}function L8(t,e,r){le(t,49,RD({sz:12,name:"Arial"},r))}function M8(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&le(t,1054,ND(i,e[i],r))})}function V8(t,e){var r=J(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),le(t,2151,r),r=J(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),A2(ut(e["!ref"]||"A1"),r),r.write_shift(4,4),le(t,2152,r)}function B8(t,e){for(var r=0;r<16;++r)le(t,224,$_({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){le(t,224,$_(n,0,e))})}function U8(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];le(t,440,UD(n)),n[1].Tooltip&&le(t,2048,bD(n))}delete e["!links"]}function b8(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&le(t,125,WD(Oh(i,n),i))})}}function j8(t,e,r,n,i){var s=16+hs(i.cellXfs,e,i);if(e.v==null&&!e.bf){le(t,513,qs(r,n,s));return}if(e.bf)le(t,6,f6(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Fr(Tr(e.v)):e.v;le(t,515,LD(r,n,a,s));break;case"b":case"e":le(t,517,FD(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=dg(i.Strings,e.v,i.revStrings);le(t,253,kD(r,n,o,s))}else le(t,516,PD(r,n,(e.v||"").slice(0,255),s,i));break;default:le(t,513,qs(r,n,s))}}function z8(t,e,r){var n=Dr(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(s),c=e.biff==8,f,h="",d=[],m=ut(s["!ref"]||"A1"),_=c?65536:16384;if(m.e.c>255||m.e.r>=_){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,_-1)}le(n,2057,lg(r,16,e)),le(n,13,en(1)),le(n,12,en(100)),le(n,15,yr(!0)),le(n,17,yr(!1)),le(n,16,Ks(.001)),le(n,95,yr(!0)),le(n,42,yr(!1)),le(n,43,yr(!1)),le(n,130,en(1)),le(n,128,DD()),le(n,131,yr(!1)),le(n,132,yr(!1)),c&&b8(n,s["!cols"]),le(n,512,OD(m,e)),c&&(s["!links"]=[]);for(var g=m.s.r;g<=m.e.r;++g){h=er(g);for(var w=m.s.c;w<=m.e.c;++w){g===m.s.r&&(d[w]=dr(w)),f=d[w]+h;var S=l?(s[g]||[])[w]:s[f];S&&(j8(n,S,g,w,e),c&&S.l&&s["!links"].push([f,S.l]))}}var x=o.CodeName||o.name||i;return c&&le(n,574,CD((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&le(n,229,BD(s["!merges"])),c&&U8(n,s),le(n,442,S2(x)),c&&V8(n,s),le(n,10),n.end()}function W8(t,e,r){var n=Dr(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(le(n,2057,lg(t,5,r)),r.bookType=="xla"&&le(n,135),le(n,225,o?en(1200):null),le(n,193,pD(2)),l&&le(n,191),l&&le(n,192),le(n,226),le(n,92,wD("SheetJS",r)),le(n,66,en(o?1200:1252)),o&&le(n,353,en(0)),o&&le(n,448),le(n,317,HD(t.SheetNames.length)),o&&t.vbaraw&&le(n,211),o&&t.vbaraw){var c=a.CodeName||"ThisWorkbook";le(n,442,S2(c))}le(n,156,en(17)),le(n,25,yr(!1)),le(n,18,yr(!1)),le(n,19,en(0)),o&&le(n,431,yr(!1)),o&&le(n,444,en(0)),le(n,61,ID()),le(n,64,yr(!1)),le(n,141,en(0)),le(n,34,yr(qM(t)=="true")),le(n,14,yr(!0)),o&&le(n,439,yr(!1)),le(n,218,en(0)),L8(n,t,r),M8(n,t.SSF,r),B8(n,r),o&&le(n,352,yr(!1));var f=n.end(),h=Dr();o&&le(h,140,jD()),o&&r.Strings&&k8(h,252,AD(r.Strings)),le(h,10);var d=h.end(),m=Dr(),_=0,g=0;for(g=0;g<t.SheetNames.length;++g)_+=(o?12:11)+(o?2:1)*t.SheetNames[g].length;var w=f.length+_+d.length;for(g=0;g<t.SheetNames.length;++g){var S=s[g]||{};le(m,133,SD({pos:w,hs:S.Hidden||0,dt:0,name:t.SheetNames[g]},r)),w+=e[g].length}var x=m.end();if(_!=x.length)throw new Error("BS8 "+_+" != "+x.length);var I=[];return f.length&&I.push(f),x.length&&I.push(x),d.length&&I.push(d),Qt(I)}function H8(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Lr(xt)),t&&t.SSF&&(Ch(),Ih(t.SSF),r.revssf=Rh(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,pg(r),r.cellXfs=[],hs(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=z8(i,r,t);return n.unshift(W8(t,n,r)),Qt(n)}function Y2(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=qr(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return H8(t,e);case 4:case 3:case 2:return F8(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function $8(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var f=Ze({r,c:a}),h=n.dense?(t[r]||[])[a]:t[f],d=h&&h.v!=null&&(h.h||T3(h.w||(_i(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),m.id=(n.id||"sjs")+"-"+f,s.push(oe("td",d,m))}}var _="<tr>";return _+s.join("")+"</tr>"}var G8='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',K8="</body></html>";function q8(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function J2(t,e){var r=e||{},n=r.header!=null?r.header:G8,i=r.footer!=null?r.footer:K8,s=[n],a=qr(t["!ref"]);r.dense=Array.isArray(t),s.push(q8(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push($8(t,a,o,r));return s.push("</table>"+i),s.join("")}function Z2(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?bt(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var f=qr(t["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),i==-1&&(c.e.r=i=f.e.r+1)}var h=[],d=0,m=t["!rows"]||(t["!rows"]=[]),_=0,g=0,w=0,S=0,x=0,I=0;for(t["!cols"]||(t["!cols"]=[]);_<o.length&&g<l;++_){var V=o[_];if(J_(V)){if(n.display)continue;m[g]={hidden:!0}}var b=V.children;for(w=S=0;w<b.length;++w){var H=b[w];if(!(n.display&&J_(H))){var E=H.hasAttribute("data-v")?H.getAttribute("data-v"):H.hasAttribute("v")?H.getAttribute("v"):I3(H.innerHTML),y=H.getAttribute("data-z")||H.getAttribute("z");for(d=0;d<h.length;++d){var T=h[d];T.s.c==S+s&&T.s.r<g+i&&g+i<=T.e.r&&(S=T.e.c+1-s,d=-1)}I=+H.getAttribute("colspan")||1,((x=+H.getAttribute("rowspan")||1)>1||I>1)&&h.push({s:{r:g+i,c:S+s},e:{r:g+i+(x||1)-1,c:S+s+(I||1)-1}});var C={t:"s",v:E},N=H.getAttribute("data-t")||H.getAttribute("t")||"";E!=null&&(E.length==0?C.t=N||"z":n.raw||E.trim().length==0||N=="s"||(E==="TRUE"?C={t:"b",v:!0}:E==="FALSE"?C={t:"b",v:!1}:isNaN(ai(E))?isNaN(Yl(E).getDate())||(C={t:"d",v:Tr(E)},n.cellDates||(C={t:"n",v:Fr(C.v)}),C.z=n.dateNF||xt[14]):C={t:"n",v:ai(E)})),C.z===void 0&&y!=null&&(C.z=y);var L="",P=H.getElementsByTagName("A");if(P&&P.length)for(var Ie=0;Ie<P.length&&!(P[Ie].hasAttribute("href")&&(L=P[Ie].getAttribute("href"),L.charAt(0)!="#"));++Ie);L&&L.charAt(0)!="#"&&(C.l={Target:L}),n.dense?(t[g+i]||(t[g+i]=[]),t[g+i][S+s]=C):t[Ze({c:S+s,r:g+i})]=C,c.e.c<S+s&&(c.e.c=S+s),S+=I}}++g}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,g-1+i),t["!ref"]=Rt(c),g>=l&&(t["!fullref"]=Rt((c.e.r=o.length-_+g-1+i,c))),t}function eS(t,e){var r=e||{},n=r.dense?[]:{};return Z2(n,t,e)}function X8(t,e){return Zs(eS(t,e),e)}function J_(t){var e="",r=Q8(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Q8(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Y8=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Zl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return kt+e}}(),Z_=function(){var t=function(s){return Qe(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Qe(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,f=0,h=qr(s["!ref"]||"A1"),d=s["!merges"]||[],m=0,_=Array.isArray(s);if(s["!cols"])for(f=0;f<=h.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var g="",w=s["!rows"]||[];for(c=0;c<h.s.r;++c)g=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+g+`></table:table-row>
`);for(;c<=h.e.r;++c){for(g=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+g+`>
`),f=0;f<h.s.c;++f)l.push(e);for(;f<=h.e.c;++f){var S=!1,x={},I="";for(m=0;m!=d.length;++m)if(!(d[m].s.c>f)&&!(d[m].s.r>c)&&!(d[m].e.c<f)&&!(d[m].e.r<c)){(d[m].s.c!=f||d[m].s.r!=c)&&(S=!0),x["table:number-columns-spanned"]=d[m].e.c-d[m].s.c+1,x["table:number-rows-spanned"]=d[m].e.r-d[m].s.r+1;break}if(S){l.push(r);continue}var V=Ze({r:c,c:f}),b=_?(s[c]||[])[f]:s[V];if(b&&b.f&&(x["table:formula"]=Qe(v6(b.f)),b.F&&b.F.slice(0,V.length)==V)){var H=qr(b.F);x["table:number-matrix-columns-spanned"]=H.e.c-H.s.c+1,x["table:number-matrix-rows-spanned"]=H.e.r-H.s.r+1}if(!b){l.push(e);continue}switch(b.t){case"b":I=b.v?"TRUE":"FALSE",x["office:value-type"]="boolean",x["office:boolean-value"]=b.v?"true":"false";break;case"n":I=b.w||String(b.v||0),x["office:value-type"]="float",x["office:value"]=b.v||0;break;case"s":case"str":I=b.v==null?"":b.v,x["office:value-type"]="string";break;case"d":I=b.w||Tr(b.v).toISOString(),x["office:value-type"]="date",x["office:date-value"]=Tr(b.v).toISOString(),x["table:style-name"]="ce1";break;default:l.push(e);continue}var E=t(I);if(b.l&&b.l.Target){var y=b.l.Target;y=y.charAt(0)=="#"?"#"+_6(y.slice(1)):y,y.charAt(0)!="#"&&!y.match(/^\w+:/)&&(y="../"+y),E=oe("text:a",E,{"xlink:href":y.replace(/&/g,"&amp;")})}l.push("          "+oe("table:table-cell",oe("text:p",E,{}),x)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var f=0;f<c["!cols"].length;++f)if(c["!cols"][f]){var h=c["!cols"][f];if(h.width==null&&h.wpx==null&&h.wch==null)continue;ug(h),h.ods=o;var d=c["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var f=0;f<c["!rows"].length;++f)if(c["!rows"][f]){c["!rows"][f].ods=l;var h=c["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[kt],c=Zl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Zl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+f+`>
`),l.push(m2().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(n(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function tS(t,e){if(e.bookType=="fods")return Z_(t,e);var r=Jm(),n="",i=[],s=[];return n="mimetype",Oe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Oe(r,n,Z_(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Oe(r,n,Y8(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Oe(r,n,kt+m2()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Oe(r,n,uD(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Oe(r,n,oD(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function zf(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function J8(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):vn(Jl(t))}function Z8(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function os(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function e5(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function eu(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function qe(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function $a(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Ot(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=eu(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=eu(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function $t(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(qe(n*8+i.type)),i.type==2&&e.push(qe(i.data.length)),e.push(i.data))})}),os(e)}function hn(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=eu(t,n),s=Ot(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:$a(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Ot(o.data),c=$a(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=$a(s[3][0].data)>>>0>0),r.push(a)}return r}function da(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:qe(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:qe(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:qe(a.data.length)}],n[2].push({data:$t(a.meta),type:2})});var s=$t(n);e.push(qe(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),os(e)}function t5(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=eu(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[os(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var f=os(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function dn(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(t5(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return os(e)}function pa(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=qe(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return os(e)}function O0(t,e){var r=new Uint8Array(32),n=zf(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,e5(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function D0(t,e){var r=new Uint8Array(32),n=zf(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function ki(t){var e=Ot(t);return eu(e[1][0].data)}function r5(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&$a(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=zf(t[7][0].data),f=0,h=[],d=zf(t[4][0].data),m=0,_=[],g=0;g<e.length;++g){if(e[g]==null){c.setUint16(g*2,65535,!0),d.setUint16(g*2,65535);continue}c.setUint16(g*2,f,!0),d.setUint16(g*2,m,!0);var w,S;switch(typeof e[g]){case"string":w=O0({t:"s",v:e[g]},r),S=D0({t:"s",v:e[g]},r);break;case"number":w=O0({t:"n",v:e[g]},r),S=D0({t:"n",v:e[g]},r);break;case"boolean":w=O0({t:"b",v:e[g]},r),S=D0({t:"b",v:e[g]},r);break;default:throw new Error("Unsupported value "+e[g])}h.push(w),f+=w.length,_.push(S),m+=S.length,++l}for(t[2][0].data=qe(l);g<t[7][0].data.length/2;++g)c.setUint16(g*2,65535,!0),d.setUint16(g*2,65535,!0);return t[6][0].data=os(h),t[3][0].data=os(_),l}function n5(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=qr(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Rt(n)));var s=Wf(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(W){return W.forEach(function(j){typeof j=="string"&&a.push(j)})});var o={},l=[],c=et.read(e.numbers,{type:"base64"});c.FileIndex.map(function(W,j){return[W,c.FullPaths[j]]}).forEach(function(W){var j=W[0],U=W[1];if(j.type==2&&j.name.match(/\.iwa/)){var Z=j.content,me=dn(Z),Te=hn(me);Te.forEach(function(xe){l.push(xe.id),o[xe.id]={deps:[],location:U,type:$a(xe.messages[0].meta[1][0].data)}})}}),l.sort(function(W,j){return W-j});var f=l.filter(function(W){return W>1}).map(function(W){return[W,qe(W)]});c.FileIndex.map(function(W,j){return[W,c.FullPaths[j]]}).forEach(function(W){var j=W[0];if(W[1],!!j.name.match(/\.iwa/)){var U=hn(dn(j.content));U.forEach(function(Z){Z.messages.forEach(function(me){f.forEach(function(Te){Z.messages.some(function(xe){return $a(xe.meta[1][0].data)!=11006&&Z8(xe.data,Te[1])})&&o[Te[0]].deps.push(Z.id)})})})}});for(var h=et.find(c,o[1].location),d=hn(dn(h.content)),m,_=0;_<d.length;++_){var g=d[_];g.id==1&&(m=g)}var w=ki(Ot(m.messages[0].data)[1][0].data);for(h=et.find(c,o[w].location),d=hn(dn(h.content)),_=0;_<d.length;++_)g=d[_],g.id==w&&(m=g);for(w=ki(Ot(m.messages[0].data)[2][0].data),h=et.find(c,o[w].location),d=hn(dn(h.content)),_=0;_<d.length;++_)g=d[_],g.id==w&&(m=g);for(w=ki(Ot(m.messages[0].data)[2][0].data),h=et.find(c,o[w].location),d=hn(dn(h.content)),_=0;_<d.length;++_)g=d[_],g.id==w&&(m=g);var S=Ot(m.messages[0].data);{S[6][0].data=qe(n.e.r+1),S[7][0].data=qe(n.e.c+1);var x=ki(S[46][0].data),I=et.find(c,o[x].location),V=hn(dn(I.content));{for(var b=0;b<V.length&&V[b].id!=x;++b);if(V[b].id!=x)throw"Bad ColumnRowUIDMapArchive";var H=Ot(V[b].messages[0].data);H[1]=[],H[2]=[],H[3]=[];for(var E=0;E<=n.e.c;++E){var y=[];y[1]=y[2]=[{type:0,data:qe(E+420690)}],H[1].push({type:2,data:$t(y)}),H[2].push({type:0,data:qe(E)}),H[3].push({type:0,data:qe(E)})}H[4]=[],H[5]=[],H[6]=[];for(var T=0;T<=n.e.r;++T)y=[],y[1]=y[2]=[{type:0,data:qe(T+726270)}],H[4].push({type:2,data:$t(y)}),H[5].push({type:0,data:qe(T)}),H[6].push({type:0,data:qe(T)});V[b].messages[0].data=$t(H)}I.content=pa(da(V)),I.size=I.content.length,delete S[46];var C=Ot(S[4][0].data);{C[7][0].data=qe(n.e.r+1);var N=Ot(C[1][0].data),L=ki(N[2][0].data);I=et.find(c,o[L].location),V=hn(dn(I.content));{if(V[0].id!=L)throw"Bad HeaderStorageBucket";var P=Ot(V[0].messages[0].data);for(T=0;T<s.length;++T){var Ie=Ot(P[2][0].data);Ie[1][0].data=qe(T),Ie[4][0].data=qe(s[T].length),P[2][T]={type:P[2][0].type,data:$t(Ie)}}V[0].messages[0].data=$t(P)}I.content=pa(da(V)),I.size=I.content.length;var Ae=ki(C[2][0].data);I=et.find(c,o[Ae].location),V=hn(dn(I.content));{if(V[0].id!=Ae)throw"Bad HeaderStorageBucket";for(P=Ot(V[0].messages[0].data),E=0;E<=n.e.c;++E)Ie=Ot(P[2][0].data),Ie[1][0].data=qe(E),Ie[4][0].data=qe(n.e.r+1),P[2][E]={type:P[2][0].type,data:$t(Ie)};V[0].messages[0].data=$t(P)}I.content=pa(da(V)),I.size=I.content.length;var ht=ki(C[4][0].data);(function(){for(var W=et.find(c,o[ht].location),j=hn(dn(W.content)),U,Z=0;Z<j.length;++Z){var me=j[Z];me.id==ht&&(U=me)}var Te=Ot(U.messages[0].data);{Te[3]=[];var xe=[];a.forEach(function(Fe,Pt){xe[1]=[{type:0,data:qe(Pt)}],xe[2]=[{type:0,data:qe(1)}],xe[3]=[{type:2,data:J8(Fe)}],Te[3].push({type:2,data:$t(xe)})})}U.messages[0].data=$t(Te);var he=da(j),je=pa(he);W.content=je,W.size=W.content.length})();var $e=Ot(C[3][0].data);{var ue=$e[1][0];delete $e[2];var ye=Ot(ue.data);{var we=ki(ye[2][0].data);(function(){for(var W=et.find(c,o[we].location),j=hn(dn(W.content)),U,Z=0;Z<j.length;++Z){var me=j[Z];me.id==we&&(U=me)}var Te=Ot(U.messages[0].data);{delete Te[6],delete $e[7];var xe=new Uint8Array(Te[5][0].data);Te[5]=[];for(var he=0,je=0;je<=n.e.r;++je){var Fe=Ot(xe);he+=r5(Fe,s[je],a),Fe[1][0].data=qe(je),Te[5].push({data:$t(Fe),type:2})}Te[1]=[{type:0,data:qe(n.e.c+1)}],Te[2]=[{type:0,data:qe(n.e.r+1)}],Te[3]=[{type:0,data:qe(he)}],Te[4]=[{type:0,data:qe(n.e.r+1)}]}U.messages[0].data=$t(Te);var Pt=da(j),Be=pa(Pt);W.content=Be,W.size=W.content.length})()}ue.data=$t(ye)}C[3][0].data=$t($e)}S[4][0].data=$t(C)}m.messages[0].data=$t(S);var De=da(d),B=pa(De);return h.content=B,h.size=h.content.length,c}function i5(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function pg(t){i5([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function s5(t,e){return e.bookType=="ods"?tS(t,e):e.bookType=="numbers"?n5(t,e):e.bookType=="xlsb"?a5(t,e):o5(t,e)}function a5(t,e){Na=1024,t&&!t.SSF&&(t.SSF=Lr(xt)),t&&t.SSF&&(Ch(),Ih(t.SSF),e.revssf=Rh(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Tl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=V2.indexOf(e.bookType)>-1,i=h2();pg(e=e||{});var s=Jm(),a="",o=0;if(e.cellXfs=[],hs(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Oe(s,a,g2(t.Props,e)),i.coreprops.push(a),Xe(e.rels,2,a,We.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,Oe(s,a,_2(t.Props)),i.extprops.push(a),Xe(e.rels,3,a,We.EXT_PROPS),t.Custprops!==t.Props&&ir(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Oe(s,a,y2(t.Custprops)),i.custprops.push(a),Xe(e.rels,4,a,We.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Oe(s,a,u8(o-1,a,e,t,f)),i.sheets.push(a),Xe(e.wbrels,-1,"worksheets/sheet"+o+"."+r,We.WS[0])}if(h){var m=h["!comments"],_=!1,g="";m&&m.length>0&&(g="xl/comments"+o+"."+r,Oe(s,g,h8(m,g)),i.comments.push(g),Xe(f,-1,"../comments"+o+"."+r,We.CMNT),_=!0),h["!legacy"]&&_&&Oe(s,"xl/drawings/vmlDrawing"+o+".vml",L2(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Oe(s,p2(a),Wa(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Oe(s,a,f8(e.Strings,a,e)),i.strs.push(a),Xe(e.wbrels,-1,"sharedStrings."+r,We.SST)),a="xl/workbook."+r,Oe(s,a,l8(t,a)),i.workbooks.push(a),Xe(e.rels,1,a,We.WB),a="xl/theme/theme1.xml",Oe(s,a,D2(t.Themes,e)),i.themes.push(a),Xe(e.wbrels,-1,"theme/theme1.xml",We.THEME),a="xl/styles."+r,Oe(s,a,c8(t,a,e)),i.styles.push(a),Xe(e.wbrels,-1,"styles."+r,We.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Oe(s,a,t.vbaraw),i.vba.push(a),Xe(e.wbrels,-1,"vbaProject.bin",We.VBA)),a="xl/metadata."+r,Oe(s,a,d8(a)),i.metadata.push(a),Xe(e.wbrels,-1,"metadata."+r,We.XLMETA),Oe(s,"[Content_Types].xml",d2(i,e)),Oe(s,"_rels/.rels",Wa(e.rels)),Oe(s,"xl/_rels/workbook."+r+".rels",Wa(e.wbrels)),delete e.revssf,delete e.ssf,s}function o5(t,e){Na=1024,t&&!t.SSF&&(t.SSF=Lr(xt)),t&&t.SSF&&(Ch(),Ih(t.SSF),e.revssf=Rh(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Tl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=V2.indexOf(e.bookType)>-1,i=h2();pg(e=e||{});var s=Jm(),a="",o=0;if(e.cellXfs=[],hs(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Oe(s,a,g2(t.Props,e)),i.coreprops.push(a),Xe(e.rels,2,a,We.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,Oe(s,a,_2(t.Props)),i.extprops.push(a),Xe(e.rels,3,a,We.EXT_PROPS),t.Custprops!==t.Props&&ir(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Oe(s,a,y2(t.Custprops)),i.custprops.push(a),Xe(e.rels,4,a,We.CUST_PROPS));var f=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},d=t.Sheets[t.SheetNames[o-1]],m=(d||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Oe(s,a,G2(o-1,e,t,h)),i.sheets.push(a),Xe(e.wbrels,-1,"worksheets/sheet"+o+"."+r,We.WS[0])}if(d){var _=d["!comments"],g=!1,w="";if(_&&_.length>0){var S=!1;_.forEach(function(x){x[1].forEach(function(I){I.T==!0&&(S=!0)})}),S&&(w="xl/threadedComments/threadedComment"+o+"."+r,Oe(s,w,BF(_,f,e)),i.threadedcomments.push(w),Xe(h,-1,"../threadedComments/threadedComment"+o+"."+r,We.TCMNT)),w="xl/comments"+o+"."+r,Oe(s,w,M2(_)),i.comments.push(w),Xe(h,-1,"../comments"+o+"."+r,We.CMNT),g=!0}d["!legacy"]&&g&&Oe(s,"xl/drawings/vmlDrawing"+o+".vml",L2(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&Oe(s,p2(a),Wa(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Oe(s,a,C2(e.Strings,e)),i.strs.push(a),Xe(e.wbrels,-1,"sharedStrings."+r,We.SST)),a="xl/workbook."+r,Oe(s,a,X2(t)),i.workbooks.push(a),Xe(e.rels,1,a,We.WB),a="xl/theme/theme1.xml",Oe(s,a,D2(t.Themes,e)),i.themes.push(a),Xe(e.wbrels,-1,"theme/theme1.xml",We.THEME),a="xl/styles."+r,Oe(s,a,N2(t,e)),i.styles.push(a),Xe(e.wbrels,-1,"styles."+r,We.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Oe(s,a,t.vbaraw),i.vba.push(a),Xe(e.wbrels,-1,"vbaProject.bin",We.VBA)),a="xl/metadata."+r,Oe(s,a,F2()),i.metadata.push(a),Xe(e.wbrels,-1,"metadata."+r,We.XLMETA),f.length>1&&(a="xl/persons/person.xml",Oe(s,a,UF(f)),i.people.push(a),Xe(e.wbrels,-1,"persons/person.xml",We.PEOPLE)),Oe(s,"[Content_Types].xml",d2(i,e)),Oe(s,"_rels/.rels",Wa(e.rels)),Oe(s,"xl/_rels/workbook."+r+".rels",Wa(e.wbrels)),delete e.revssf,delete e.ssf,s}function l5(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=vi(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function rS(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Tu(e.file,et.write(t,{type:Ge?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return et.write(t,e)}function u5(t,e){var r=Lr(e||{}),n=s5(t,r);return c5(n,r)}function c5(t,e){var r={},n=Ge?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?et.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Ah(i))}return e.password&&typeof encrypt_agile<"u"?rS(encrypt_agile(i,e.password),e):e.type==="file"?Tu(e.file,i):e.type=="string"?_l(i):i}function f5(t,e){var r=e||{},n=C8(t,r);return rS(n,r)}function Rn(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Ql(Jl(n));case"binary":return Jl(n);case"string":return t;case"file":return Tu(e.file,n,"utf8");case"buffer":return Ge?Ei(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Rn(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function h5(t,e){switch(e.type){case"base64":return Ql(t);case"binary":return t;case"string":return t;case"file":return Tu(e.file,t,"binary");case"buffer":return Ge?Ei(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function xc(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Ql(r):e.type=="string"?_l(r):r;case"file":return Tu(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function nS(t,e){bO(),YM(t);var r=Lr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=nS(t,r);return r.type="array",Ah(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Rn(A8(t,r),r);case"slk":case"sylk":return Rn(qD.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return Rn(J2(t.Sheets[t.SheetNames[i]],r),r);case"txt":return h5(iS(t.Sheets[t.SheetNames[i]],r),r);case"csv":return Rn(mg(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return Rn(XD.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return xc(KD.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return Rn(QD.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return Rn(nF.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return Rn(I2.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return Rn(tS(t,r),r);case"wk1":return xc(G_.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return xc(G_.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),xc(Y2(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),f5(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return u5(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function d5(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function p5(t,e,r){var n={};return n.type="file",n.file=e,d5(n),nS(t,n)}function m5(t,e,r,n,i,s,a,o){var l=er(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!a||t[r])for(var m=e.s.c;m<=e.e.c;++m){var _=a?t[r][m]:t[n[m]+l];if(_===void 0||_.t===void 0){if(c===void 0)continue;s[m]!=null&&(d[s[m]]=c);continue}var g=_.v;switch(_.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+_.t)}if(s[m]!=null){if(g==null)if(_.t=="e"&&g===null)d[s[m]]=null;else if(c!==void 0)d[s[m]]=c;else if(f&&g===null)d[s[m]]=null;else continue;else d[s[m]]=f&&(_.t!=="n"||_.t==="n"&&o.rawNumbers!==!1)?g:_i(_,g,o);g!=null&&(h=!1)}}return{row:d,isempty:h}}function Wf(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},f=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":l=ut(f);break;case"number":l=ut(t["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var h=er(l.s.r),d=[],m=[],_=0,g=0,w=Array.isArray(t),S=l.s.r,x=0,I={};w&&!t[S]&&(t[S]=[]);var V=c.skipHidden&&t["!cols"]||[],b=c.skipHidden&&t["!rows"]||[];for(x=l.s.c;x<=l.e.c;++x)if(!(V[x]||{}).hidden)switch(d[x]=dr(x),r=w?t[S][x]:t[d[x]+h],n){case 1:s[x]=x-l.s.c;break;case 2:s[x]=d[x];break;case 3:s[x]=c.header[x-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=_i(r,null,c),g=I[a]||0,!g)I[a]=1;else{do o=a+"_"+g++;while(I[o]);I[a]=g,I[o]=1}s[x]=o}for(S=l.s.r+i;S<=l.e.r;++S)if(!(b[S]||{}).hidden){var H=m5(t,l,S,d,n,s,w,c);(H.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(m[_++]=H.row)}return m.length=_,m}var ey=/"/g;function g5(t,e,r,n,i,s,a,o){for(var l=!0,c=[],f="",h=er(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var m=o.dense?(t[r]||[])[d]:t[n[d]+h];if(m==null)f="";else if(m.v!=null){l=!1,f=""+(o.rawNumbers&&m.t=="n"?m.v:_i(m,null,o));for(var _=0,g=0;_!==f.length;++_)if((g=f.charCodeAt(_))===i||g===s||g===34||o.forceQuotes){f='"'+f.replace(ey,'""')+'"';break}f=="ID"&&(f='"ID"')}else m.f!=null&&!m.F?(l=!1,f="="+m.f,f.indexOf(",")>=0&&(f='"'+f.replace(ey,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(a)}function mg(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=ut(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),f="",h=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],_=i.s.c;_<=i.e.c;++_)(d[_]||{}).hidden||(h[_]=dr(_));for(var g=0,w=i.s.r;w<=i.e.r;++w)(m[w]||{}).hidden||(f=g5(t,i,w,h,a,l,s,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((g++?o:"")+f)));return delete n.dense,r.join("")}function iS(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=mg(t,e);return r}function v5(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=ut(t["!ref"]),s="",a=[],o,l=[],c=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=dr(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=er(f),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=c?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function sS(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?bt(n.origin):n.origin;a=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=ut(s["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),a==-1&&(a=h.e.r+1,f.e.r=a+e.length-1+i)}else a==-1&&(a=0,f.e.r=e.length-1+i);var d=n.header||[],m=0;e.forEach(function(g,w){ir(g).forEach(function(S){(m=d.indexOf(S))==-1&&(d[m=d.length]=S);var x=g[S],I="z",V="",b=Ze({c:o+m,r:a+w+i});c=tu(s,b),x&&typeof x=="object"&&!(x instanceof Date)?s[b]=x:(typeof x=="number"?I="n":typeof x=="boolean"?I="b":typeof x=="string"?I="s":x instanceof Date?(I="d",n.cellDates||(I="n",x=Fr(x)),V=n.dateNF||xt[14]):x===null&&n.nullError&&(I="e",x=0),c?(c.t=I,c.v=x,delete c.w,delete c.R,V&&(c.z=V)):s[b]=c={t:I,v:x},V&&(c.z=V))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var _=er(a);if(i)for(m=0;m<d.length;++m)s[dr(m+o)+_]={t:"s",v:d[m]};return s["!ref"]=Rt(f),s}function _5(t,e){return sS(null,t,e)}function tu(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=bt(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?tu(t,Ze(e)):tu(t,Ze({r:e,c:r||0}))}function y5(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function x5(){return{SheetNames:[],Sheets:{}}}function E5(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(q2(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function T5(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=y5(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function w5(t,e){return t.z=e,t}function aS(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function S5(t,e,r){return aS(t,"#"+e,r)}function A5(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function I5(t,e,r,n){for(var i=typeof e!="string"?e:ut(e),s=typeof e=="string"?e:Rt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=tu(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var F0={encode_col:dr,encode_row:er,encode_cell:Ze,encode_range:Rt,decode_col:ig,decode_row:ng,split_cell:b3,decode_cell:bt,decode_range:qr,format_cell:_i,sheet_add_aoa:a2,sheet_add_json:sS,sheet_add_dom:Z2,aoa_to_sheet:xo,json_to_sheet:_5,table_to_sheet:eS,table_to_book:X8,sheet_to_csv:mg,sheet_to_txt:iS,sheet_to_json:Wf,sheet_to_html:J2,sheet_to_formulae:v5,sheet_to_row_object_array:Wf,sheet_get_cell:tu,book_new:x5,book_append_sheet:E5,book_set_sheet_visibility:T5,cell_set_number_format:w5,cell_set_hyperlink:aS,cell_set_internal_link:S5,cell_add_comment:A5,sheet_set_array_formula:I5,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const C5={apiKey:"AIzaSyBPxY5M-DD3LzXSUdCU1BcmQHxpmtFFHBU",authDomain:"lkssb-79543.firebaseapp.com",projectId:"lkssb-79543",storageBucket:"lkssb-79543.firebasestorage.app",messagingSenderId:"786304193427",appId:"1:786304193427:web:78b167ea29a9a99bcd8e66"},oS=["scottchue.sk@gmail.com"],lS=TE(C5),ap=Dk(lS),Pn=xO(lS),R5=new Xn,ty=()=>new Date().toISOString().split("T")[0],Qn=t=>t?(t.toDate?t.toDate():new Date(t)).toLocaleTimeString("en-MY",{hour:"2-digit",minute:"2-digit"}):"-",k5=(t,e="")=>{if(!(e||"").toLowerCase().includes("ampang"))return t;const n=t.getHours(),i=t.getMinutes();return n<7||n>=8?t:n===7?i<=5?new Date(t.getFullYear(),t.getMonth(),t.getDate(),7,0,0):i<=15?new Date(t.getFullYear(),t.getMonth(),t.getDate(),7,15,0):i<=30?new Date(t.getFullYear(),t.getMonth(),t.getDate(),7,30,0):new Date(t.getFullYear(),t.getMonth(),t.getDate(),8,0,0):t},P5=async t=>{const{latitude:e,longitude:r}=t.coords;try{const s=(await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${e}&lon=${r}&zoom=14&addressdetails=1`)).json()).address||{},a=s.city||s.town||s.village||s.county||"Unknown",l=s.suburb||s.neighbourhood||s.hamlet||""||"";return{lat:e,lng:r,city:a,area:l}}catch(n){return console.error("Geocoding error:",n),{lat:e,lng:r,city:"Unknown",area:""}}},N5=()=>new Promise((t,e)=>{if(!navigator.geolocation){e(new Error("Geolocation not supported"));return}navigator.geolocation.getCurrentPosition(t,e)});function O5({onLogin:t}){const e=async()=>{try{const n=(await zR(ap,R5)).user,i=await Sw(Ps(Pn,"users",n.uid)),s=oS.includes(n.email);i.exists()||await ep(Ps(Pn,"users",n.uid),{email:n.email,name:n.displayName,photoURL:n.photoURL,role:s?"admin":"staff",createdAt:tp()}),t({...n,role:s?"admin":"staff"})}catch(r){console.error("Login error:",r),alert("Login failed. Please try again.")}};return se.jsx("div",{className:"login-container",children:se.jsxs("div",{className:"login-card",children:[se.jsx("h1",{children:"StaffClock"}),se.jsx("p",{children:"Time & Location Tracker"}),se.jsxs("button",{className:"google-btn",onClick:e,children:[se.jsx("img",{src:"https://www.google.com/favicon.ico",alt:"Google"}),"Sign in with Google"]})]})})}function D5({user:t}){const[e,r]=Bt.useState(null),[n,i]=Bt.useState([]),[s,a]=Bt.useState(!0),[o,l]=Bt.useState(!1),[c,f]=Bt.useState(null);Bt.useEffect(()=>{h()},[t]);const h=async()=>{a(!0);try{const g=ty(),w=Jd(Zo(Pn,"attendance"),gl("userId","==",t.uid),gl("date","==",g)),S=await Zd(w);if(S.empty)r(null);else{const b=S.docs.find(H=>!H.data().timeOut);r(b?{id:b.id,...b.data()}:{id:S.docs[0].id,...S.docs[0].data()})}const x=Jd(Zo(Pn,"attendance"),gl("userId","==",t.uid));let V=(await Zd(x)).docs.map(b=>({id:b.id,...b.data()}));V.sort((b,H)=>{var T,C,N,L,P,Ie;if(b.date!==H.date)return H.date.localeCompare(b.date);const E=((N=(C=(T=b.timeIn)==null?void 0:T.toDate)==null?void 0:C.call(T))==null?void 0:N.getTime())||0;return(((Ie=(P=(L=H.timeIn)==null?void 0:L.toDate)==null?void 0:P.call(L))==null?void 0:Ie.getTime())||0)-E}),i(V)}catch(g){console.error("Error loading data:",g)}a(!1)},d=async g=>{l(!0);try{const w=await N5(),S=await P5(w);f(S);const x=new Date,I=ty(),V=x.getHours(),b=k5(x,S.area),H=b.getHours(),E=b.getMinutes(),y=b;if(V>=12&&V<13){alert("Clock in/out is not allowed during lunch hour (12:00 PM - 1:00 PM)."),l(!1);return}if(g==="clockIn"){if(e!=null&&e.timeOut){const N=e.timeOut.toDate?e.timeOut.toDate():new Date(e.timeOut);if((x-N)/(1e3*60*60)<=1){alert("You must wait 1 hour after clocking out before starting a new session."),l(!1);return}}const T={userId:t.uid,email:t.email,name:t.displayName,date:I,timeIn:y,timeOut:null,locationIn:S,locationOut:null,originalTimeIn:x,createdAt:tp()},C=Ps(Zo(Pn,"attendance"));await ep(C,T),r({id:C.id,...T})}else{const C=(e.timeIn.toDate?e.timeIn.toDate():new Date(e.timeIn)).toISOString().split("T")[0];if(C!==I){const N=new Date(C);N.setHours(23,59,59,999),await p_(Ps(Pn,"attendance",e.id),{timeOut:N,locationOut:S});const L=new Date(I);L.setHours(0,0,0,0);const P={userId:t.uid,email:t.email,name:t.displayName,date:I,timeIn:L,timeOut:y,locationIn:S,locationOut:S,originalTimeOut:x,createdAt:tp()},Ie=Ps(Zo(Pn,"attendance"));await ep(Ie,P)}else await p_(Ps(Pn,"attendance",e.id),{timeOut:y,locationOut:S,originalTimeOut:x});r(N=>({...N,timeOut:y,locationOut:S}))}await h()}catch(w){console.error("Clock error:",w),alert("Failed to record. Please enable location access.")}l(!1)};if(s)return se.jsx("div",{className:"loading",children:"Loading..."});const m=e&&!e.timeOut,_=(e==null?void 0:e.timeOut)&&new Date-new Date(e.timeOut.toDate?e.timeOut.toDate():e.timeOut)>60*60*1e3;return se.jsxs("div",{className:"container",children:[se.jsxs("div",{className:"card",children:[se.jsx("h2",{children:"Current Status"}),e?m?se.jsxs(se.Fragment,{children:[se.jsx("p",{className:"status-text",children:" Clocked In"}),se.jsxs("p",{className:"status-text",children:["In: ",Qn(e.timeIn)]}),e.locationIn&&se.jsxs("p",{className:"location-info",children:[" ",e.locationIn.city," ",e.locationIn.area&&` - ${e.locationIn.area}`]})]}):se.jsxs(se.Fragment,{children:[se.jsx("p",{className:"status-text",children:" Completed for Today"}),se.jsxs("p",{children:["In: ",Qn(e.timeIn)," | Out: ",Qn(e.timeOut)]})]}):se.jsx("p",{className:"status-text",children:"Not clocked in yet"})]}),se.jsx("div",{className:"card",children:!m&&!e?se.jsx("button",{className:"clock-btn clock-in",onClick:()=>d("clockIn"),disabled:o,children:o?"Getting Location...":" Clock In"}):m?se.jsx("button",{className:"clock-btn clock-out",onClick:()=>d("clockOut"),disabled:o,children:o?"Getting Location...":" Clock Out"}):_?se.jsx("button",{className:"clock-btn clock-in",onClick:()=>d("clockIn"),disabled:o,children:o?"Getting Location...":" Clock In (New Session)"}):se.jsx("p",{className:"status-text",children:" Today's attendance complete"})}),se.jsxs("div",{className:"card",children:[se.jsx("h2",{children:"Recent History"}),n.length>0?se.jsx("div",{className:"table-container",children:se.jsxs("table",{children:[se.jsx("thead",{children:se.jsxs("tr",{children:[se.jsx("th",{children:"Date"}),se.jsx("th",{children:"In"}),se.jsx("th",{children:"Out"}),se.jsx("th",{children:"Location In"}),se.jsx("th",{children:"Location Out"})]})}),se.jsx("tbody",{children:n.slice(0,7).map(g=>{var w,S;return se.jsxs("tr",{children:[se.jsx("td",{children:g.date}),se.jsx("td",{children:Qn(g.timeIn)}),se.jsx("td",{children:Qn(g.timeOut)}),se.jsx("td",{children:((w=g.locationIn)==null?void 0:w.city)||"-"}),se.jsx("td",{children:((S=g.locationOut)==null?void 0:S.city)||"-"})]},g.id)})})]})}):se.jsx("p",{className:"status-text",children:"No records yet"})]})]})}function F5({user:t}){const[e,r]=Bt.useState([]),[n,i]=Bt.useState(!0),[s,a]=Bt.useState(""),[o,l]=Bt.useState("");Bt.useEffect(()=>{const h=new Date,d=new Date(h);d.setDate(h.getDate()-30),l(h.toISOString().split("T")[0]),a(d.toISOString().split("T")[0])},[]),Bt.useEffect(()=>{s&&o&&c()},[s,o]);const c=async()=>{i(!0);try{const h=Jd(Zo(Pn,"attendance"),gl("date",">=",s),gl("date","<=",o));let m=(await Zd(h)).docs.map(_=>({id:_.id,..._.data()}));m.sort((_,g)=>{var x,I,V,b,H,E;if(_.date!==g.date)return g.date.localeCompare(_.date);const w=((V=(I=(x=_.timeIn)==null?void 0:x.toDate)==null?void 0:I.call(x))==null?void 0:V.getTime())||0;return(((E=(H=(b=g.timeIn)==null?void 0:b.toDate)==null?void 0:H.call(b))==null?void 0:E.getTime())||0)-w}),r(m)}catch(h){console.error("Error loading records:",h),alert("Error loading records: "+h.message)}i(!1)},f=()=>{const h=e.map(g=>({Date:g.date,STAFF:g.name,IN:g.timeIn?Qn(g.timeIn):"",OUT:g.timeOut?Qn(g.timeOut):"","Location In":g.locationIn?`${g.locationIn.city}${g.locationIn.area?`, ${g.locationIn.area}`:""}`:"","Location Out":g.locationOut?`${g.locationOut.city}${g.locationOut.area?`, ${g.locationOut.area}`:""}`:""})),d=F0.json_to_sheet(h),m=F0.book_new();F0.book_append_sheet(m,d,"Timesheet"),d["!cols"]=[{wch:12},{wch:20},{wch:10},{wch:10},{wch:25},{wch:25}];const _=s?new Date(s).toLocaleString("en-MY",{month:"long",year:"numeric"}):"attendance";p5(m,`Timesheet_${_}.xlsx`)};return n?se.jsx("div",{className:"loading",children:"Loading..."}):se.jsxs("div",{className:"container",children:[se.jsxs("div",{className:"card",children:[se.jsx("h2",{children:"Admin Controls"}),se.jsxs("div",{className:"admin-controls",children:[se.jsx("input",{type:"date",className:"date-input",value:s,onChange:h=>a(h.target.value)}),se.jsx("span",{children:"to"}),se.jsx("input",{type:"date",className:"date-input",value:o,onChange:h=>l(h.target.value)}),se.jsx("button",{className:"export-btn",onClick:f,children:" Export to Excel"})]}),se.jsxs("p",{children:[e.length," records found"]})]}),se.jsxs("div",{className:"card",children:[se.jsx("h2",{children:"All Attendance Records"}),e.length>0?se.jsx("div",{className:"table-container",children:se.jsxs("table",{children:[se.jsx("thead",{children:se.jsxs("tr",{children:[se.jsx("th",{children:"Name"}),se.jsx("th",{children:"Email"}),se.jsx("th",{children:"Date"}),se.jsx("th",{children:"In"}),se.jsx("th",{children:"Out"}),se.jsx("th",{children:"Location In"}),se.jsx("th",{children:"Location Out"})]})}),se.jsx("tbody",{children:e.map(h=>{var d,m,_,g;return se.jsxs("tr",{children:[se.jsx("td",{children:h.name}),se.jsx("td",{children:h.email}),se.jsx("td",{children:h.date}),se.jsx("td",{children:Qn(h.timeIn)}),se.jsx("td",{children:Qn(h.timeOut)}),se.jsxs("td",{children:[((d=h.locationIn)==null?void 0:d.city)||"-",((m=h.locationIn)==null?void 0:m.area)&&`, ${h.locationIn.area}`]}),se.jsxs("td",{children:[((_=h.locationOut)==null?void 0:_.city)||"-",((g=h.locationOut)==null?void 0:g.area)&&`, ${h.locationOut.area}`]})]},h.id)})})]})}):se.jsx("p",{className:"status-text",children:"No records found"})]})]})}function L5(){const[t,e]=Bt.useState(null),[r,n]=Bt.useState(!0);Bt.useEffect(()=>ER(ap,async o=>{if(o){const l=await Sw(Ps(Pn,"users",o.uid)),c=oS.includes(o.email);e({...o,role:l.exists()?l.data().role:c?"admin":"staff"})}else e(null);n(!1)}),[]);const i=async()=>{await TR(ap),e(null)};if(r)return se.jsx("div",{className:"loading",children:"Loading..."});if(!t)return se.jsx(O5,{onLogin:e});const s=t.role==="admin";return se.jsxs(se.Fragment,{children:[se.jsxs("header",{className:"header",children:[se.jsx("h1",{children:"StaffClock"}),se.jsxs("div",{className:"header-user",children:[t.photoURL&&se.jsx("img",{src:t.photoURL,alt:t.displayName}),se.jsx("span",{children:t.displayName}),s&&se.jsx("span",{className:"badge badge-admin",children:"Admin"}),se.jsx("button",{className:"logout-btn",onClick:i,children:"Logout"})]})]}),s?se.jsx(F5,{user:t}):se.jsx(D5,{user:t})]})}L0.createRoot(document.getElementById("root")).render(se.jsx(zS.StrictMode,{children:se.jsx(L5,{})}));
